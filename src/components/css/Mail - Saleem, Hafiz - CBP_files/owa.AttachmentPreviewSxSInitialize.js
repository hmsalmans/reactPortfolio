self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[135,4,15,23,40,44,69],{1018:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"n",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return h})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return m})),n.d(t,"q",(function(){return O})),n.d(t,"a",(function(){return g}));var r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange",u="Box",s="Dropbox",l="Facebook",d="GDrive",f="Mailbox",p="MailMessage",b="OneDriveConsumer",h="OneDrivePro",v="WopiBox",m="WopiDropbox",O="WopiEgnyte",g={providers:{BOX:u,DROPBOX:s,FACEBOOK:l,GDRIVE:d,MAILBOX:f,ONE_DRIVE_CONSUMER:b,ONE_DRIVE_PRO:h,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:v,WOPI_EGNYTE:O},attachmentTypes:{FILE_ATTACHMENT_TYPE:r,ITEM_ATTACHMENT_TYPE:i,ITEM_ID_ATTACHMENT_TYPE:o,REFERENCE_ATTACHMENT_TYPE:a,LINK_ATTACHMENT_TYPE:c}}},1020:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"TargetFolderId:#Exchange"},e)}},1036:function(e,t,n){"use strict";n.d(t,"f",(function(){return l})),n.d(t,"n",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"i",(function(){return m})),n.d(t,"g",(function(){return O})),n.d(t,"o",(function(){return g}));var r=n(108),i=n(1589);n.d(t,"p",(function(){return i.a}));var o=n(1123);n.d(t,"b",(function(){return o.a}));var a=n(1232);n.d(t,"c",(function(){return a.a}));var c=n(1325);n.d(t,"e",(function(){return c.a})),n.d(t,"d",(function(){return c.b}));var u=n(1018);n.d(t,"a",(function(){return u.a}));var s=new r.c((function(){return Promise.all([n.e(4),n.e(15),n.e(40),n.e(132)]).then(n.bind(null,3005))})),l=new r.a(s,(function(e){return e.addAndInitializeAttachments})),d=new r.a(s,(function(e){return e.setPreviewImageUrl})),f=new r.a(s,(function(e){return e.refreshDownloadUrl})),p=new r.a(s,(function(e){return e.createAttachmentInfo})),b=new r.a(s,(function(e){return e.setAttachmentInfo})),h=new r.a(s,(function(e){return e.refreshThumbnailImageUrl})),v=new r.a(s,(function(e){return e.refreshPreviewImageUrl})),m=new r.b(s,(function(e){return e.getAttachment})),O=new r.b(s,(function(e){return e.checkPendingAttachmentOperation})),g=new r.b(s,(function(e){return e.shouldShowImageView}))},1052:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},1055:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},1061:function(e,t,n){"use strict";var r=n(108),i=n(1119),o={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return o}));var a=new r.c((function(){return Promise.all([n.e(713),n.e(423)]).then(n.bind(null,14598))})),c=new r.a(a,(function(e){return e.subscribe})),u=new r.a(a,(function(e){return e.unsubscribe})),s=new r.b(a,(function(e){return e.getChannelId})),l=(new r.b(a,(function(e){return e.getChannelReady})),new r.a(a,(function(e){return e.setup}))),d=new r.a(a,(function(e){return e.initializeNotificationManager})),f=new r.b(a,(function(e){return e.getNotificationEmitter}));i.a},1065:function(e,t,n){"use strict";var r=n(1282),i=n(1052),o=n(1036),a=n(76);function c(e,t,n,c){if(Object(o.e)(n))return function(e){return 2===Object(o.c)(e)?l():u()}(n);if(3===Object(o.c)(n)&&!c)return s();var d;switch(t){case 2:d={allowEdit:!1,previewMethod:i.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:d={allowEdit:!1,previewMethod:i.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:d={allowEdit:!1,previewMethod:i.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:d={allowEdit:e.wacEdit,previewMethod:i.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:d={allowEdit:!1,previewMethod:i.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:d={allowEdit:!1,previewMethod:i.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:d=l();break;case 11:d={allowEdit:!1,previewMethod:i.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:d={allowEdit:!1,previewMethod:i.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:d={allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]};break;case 13:d=Object(a.h)("cal-ics-preview")?{allowEdit:!1,previewMethod:i.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]}:u();break;default:d=function(e){return e.__type===o.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||e.__type===o.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(n)?s():u()}return d}function u(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.Download]}}function s(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function l(){return{allowEdit:!1,previewMethod:i.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var d=n(283),f=(Object(d.action)("setPreviewLoaded")((function(e,t){e.previewLoaded=t})),Object(d.action)("setIsPlaceholderAttachment")((function(e,t){e.isPlaceholderAttachment=t}))),p=Object(d.action)("setThumbnailLoadState")((function(e,t){e.thumbnailLoadState=t}));function b(e,t,n,r,o,a){return void 0===a&&(a=null),{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]},parentItemId:a,fileType:o}}var h=n(26);function v(){return Object(h.a)().SessionSettings.CompanyName}function m(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return r.a}))},1071:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},1078:function(e,t,n){"use strict";var r=n(984),i=n(967);function o(e){return e.map((function(e){return{fileType:r.a.Uri,name:e.name,type:Object(i.b)(e.url)||"",size:0,uri:e.url}}))}var a=n(79);function c(e,t,n){if(e.length!=t.length)return a.d("The sizes of subjects and latestItemIds are different"),null;for(var i=[],o=0;o<e.length;o++){var c={fileType:r.a.MailItem,name:e[o],size:(null==n?void 0:n[o])||0,itemId:t[o]};i.push(c)}return i}function u(e,t,n){var i=[],o={fileType:r.a.MailItem,name:e,size:n||0,mimeContent:t};return i.push(o),i}function s(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var i=e[n],o={fileType:r.a.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(o)}return t}function l(e){if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function d(e){var t,n;return null===e?null:{fileType:r.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function f(e){return null===e?null:{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p={BOX:"Box",DROPBOX:"Dropbox",FACEBOOK:"Facebook",GDRIVE:"GDrive",MAILBOX:"Mailbox",ONE_DRIVE_CONSUMER:"OneDriveConsumer",ONE_DRIVE_PRO:"OneDrivePro",RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:"WopiBox",WOPI_EGNYTE:"WopiEgnyte"};function b(e){switch(e?e.toLowerCase():null){case p.ONE_DRIVE_PRO.toLowerCase():return 0;case p.GDRIVE.toLowerCase():return 5;case p.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.DROPBOX.toLowerCase():return 2;case p.BOX.toLowerCase():return 3;case p.WOPI_BOX.toLowerCase():return 7;case p.WOPI_EGNYTE.toLowerCase():return 8;case p.MAILBOX.toLowerCase():return 4;case p.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return r.a}))},1103:function(e,t,n){"use strict";var r,i=n(108),o=n(1226),a=n(1227),c=n(2137);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.NewFluidFile="NewFluidFile",e.Unknown="Unknown"}(r||(r={}));var u=n(1399),s=(n(1940),n(1270)),l=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function d(e){var t=Object(s.a)(e);return t&&-1!==l.indexOf(t.source)}var f=n(1990);function p(e){var t=Object(s.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:d(e)?"newLink":"oldLink"}:null}var b=n(2065);function h(){return Object(b.a)().sharingLinks.size}var v=n(2138);n.d(t,"p",(function(){return O})),n.d(t,"u",(function(){return g})),n.d(t,"y",(function(){return _})),n.d(t,"w",(function(){return w})),n.d(t,"v",(function(){return j})),n.d(t,"s",(function(){return I})),n.d(t,"x",(function(){return y})),n.d(t,"t",(function(){return k})),n.d(t,"r",(function(){return S})),n.d(t,"q",(function(){return C})),n.d(t,"A",(function(){return m})),n.d(t,"c",(function(){return o.a})),n.d(t,"d",(function(){return o.b})),n.d(t,"e",(function(){return o.c})),n.d(t,"g",(function(){return o.d})),n.d(t,"D",(function(){return o.f})),n.d(t,"z",(function(){return o.e})),n.d(t,"E",(function(){return a.e})),n.d(t,"F",(function(){return a.f})),n.d(t,"G",(function(){return a.g})),n.d(t,"C",(function(){return a.c})),n.d(t,"f",(function(){return a.b})),n.d(t,"B",(function(){return c.b})),n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"o",(function(){return u.c})),n.d(t,"n",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"k",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"m",(function(){return v.a}));var m=new i.c((function(){return Promise.all([n.e(4),n.e(15),n.e(44),n.e(360)]).then(n.bind(null,14579))})),O=new i.b(m,(function(e){return e.addRecipientsIntoLink})),g=new i.b(m,(function(e){return e.removeRecipientsFromLink})),_=new i.b(m,(function(e){return e.updateRecipientPermissionInfos})),w=new i.b(m,(function(e){return e.setGetPermissionInfoFailure})),j=new i.b(m,(function(e){return e.resetSharingRecipientsInfo})),I=new i.b(m,(function(e){return e.ignoreSharingTip})),y=new i.b(m,(function(e){return e.setLinkActionStatus})),k=new i.b(m,(function(e){return e.onFluidLinkCreated})),S=new i.b(m,(function(e){return e.getSharingTipRecipientInfo})),C=new i.b(m,(function(e){return e.createCloudFileFromSharingLink}))},1109:function(e,t,n){"use strict";var r=n(2365),i=n(1737),o=n(2479),a=n(283);t.a=Object(a.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(o.a)(e)?Object(i.a)(e,!0):Object(i.a)(e,!1)}))},1120:function(e,t,n){"use strict";var r,i=n(967),o=n(1490);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));var a=function(){function e(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}return e.prototype.getPolicyInfo=function(e,t,n,i){e&&(e=e.toLowerCase());var o=this.getFileAccessLevel(e,t),a=!1,c=!1,u=!1,s="ReferenceAttachment:#Exchange"===i;return o!==r.Block&&n&&(this.isWacViewingEnabled(e)&&(a=!0),!this.directFileAccessEnabled&&s&&(a=!1),c=this.isForceBrowserViewingFirst(a),a&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(u="FileAttachment:#Exchange"===i?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),a||this.directFileAccessEnabled||(o=r.AccessDisabled)),{directFileAccessEnabled:this.directFileAccessEnabled,level:o,useWac:a,forceBrowserViewingFirst:c,wacEdit:u}},e.prototype.isPdfPreviewEnabled=function(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled},e.prototype.getFileAccessLevel=function(e,t){var n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;var i=this.mimeTypeToPolicyMap[t];return i===r.Block?r.Block:n===r.ForceSave||i===r.ForceSave?r.ForceSave:n===r.Allow||i===r.Allow?r.Allow:this.policyForUnknownTypes},e.prototype.isWacViewingEnabled=function(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0},e.prototype.isForceBrowserViewingFirst=function(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)},e.prototype.addPolicyIntoMap=function(e,t,n){t&&t.forEach((function(t){e[t]=n}))},e.prototype.createPolicyMap=function(e,t,n){var i={};return this.addPolicyIntoMap(i,n,r.Allow),this.addPolicyIntoMap(i,t,r.ForceSave),this.addPolicyIntoMap(i,e,r.Block),i},e}(),c=null,u=null;function s(){if(!c){var e=Object(o.f)(),t=e.AttachmentPolicy,n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;c=new a(t,n),n&&(u=c)}return c}function l(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return s().getPolicyInfo(n,r,t,e.__type)}function d(e,t){var n=Object(i.b)(e.Name),r=e.ContentType;return function(){if(!u){var e=Object(o.f)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return s();u=new a(e.AttachmentPolicy,!0)}return u}().getPolicyInfo(n,r,t,e.__type)}function f(e,t,n,i){if(i)return!1;var o=l(e,!0),a=s();return o.level!==r.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return s}))},1123:function(e,t,n){"use strict";var r=n(23),i=n(4),o={attachments:new r.ObservableMap({})},a=Object(i.createStore)("attachment",o);t.a=a},1128:function(e,t,n){"use strict";var r=n(1986),i=n(108),o=n(1151),a=n(1209),c=(n(1065),n(1087)),u=n(76);function s(e){return Object(u.h)("doc-SxS-multipleViews")?e==window?Object(a.b)().mainWindowSxSId:Object(c.e)(e):null}var l=n(1294),d=n(0),f=n(1420);function p(){var e,t;if(Object(u.h)("doc-SxS-multipleViews")){try{for(var n=Object(d.__values)(Object(a.b)().sxsStoreMapping.keys()),r=n.next();!r.done;r=n.next()){var i=r.value,o=Object(a.b)().sxsStoreMapping.get(i);if(o.shouldShow&&1==o.displayMode)return!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1}return Object(l.a)(f.a)}var b=n(2098),h=n(1691),v=n(1705),m=n(2133);n.d(t,"E",(function(){return g})),n.d(t,"p",(function(){return _})),n.d(t,"q",(function(){return w})),n.d(t,"r",(function(){return j})),n.d(t,"s",(function(){return I})),n.d(t,"t",(function(){return y})),n.d(t,"u",(function(){return k})),n.d(t,"v",(function(){return S})),n.d(t,"w",(function(){return C})),n.d(t,"x",(function(){return T})),n.d(t,"y",(function(){return A})),n.d(t,"z",(function(){return P})),n.d(t,"A",(function(){return x})),n.d(t,"B",(function(){return E})),n.d(t,"C",(function(){return L})),n.d(t,"D",(function(){return R})),n.d(t,"F",(function(){return N})),n.d(t,"J",(function(){return o.e})),n.d(t,"H",(function(){return o.c})),n.d(t,"K",(function(){return o.f})),n.d(t,"h",(function(){return o.a})),n.d(t,"I",(function(){return o.d})),n.d(t,"G",(function(){return o.b})),n.d(t,"i",(function(){return a.a})),n.d(t,"f",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"l",(function(){return l.a})),n.d(t,"m",(function(){return l.b})),n.d(t,"n",(function(){return l.c})),n.d(t,"o",(function(){return l.d})),n.d(t,"k",(function(){return p})),n.d(t,"e",(function(){return f.b})),n.d(t,"d",(function(){return f.a})),n.d(t,"g",(function(){return b.a})),n.d(t,"b",(function(){return h.a})),n.d(t,"c",(function(){return v.a})),n.d(t,"a",(function(){return m.a}));var O=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(554)]).then(n.bind(null,14568))})),g=new i.b(O,(function(e){return e})),_=new i.b(O,(function(e){return e.canCloseSxS})),w=new i.b(O,(function(e){return e.closeComposeInSxS})),j=new i.b(O,(function(e){return e.createImageGalleryFromAttachmentViewStateIds})),I=new i.b(O,(function(e){return e.editAndReply})),y=new i.b(O,(function(e){return e.editInDraft})),k=new i.b(O,(function(e){return e.forceCloseSxS})),S=new i.a(O,(function(e){return e.logUsageWithSxSCustomData})),C=new i.b(O,(function(e){return e.onBeforeImageGalleryItemSelected})),T=new i.b(O,(function(e){return e.onChangeByImageGallery})),A=new i.b(O,(function(e){return e.onPendingNavigation})),P=new i.b(O,(function(e){return e.onPreviewOperationFinished})),x=new i.b(O,(function(e){return e.onPreviewOperationStart})),E=new i.b(O,(function(e){return e.openComposeInSxS})),L=new i.b(O,(function(e){return e.reloadTextPreview})),R=new i.b(O,(function(e){return e.showSxS})),N=new i.a(O,(function(e){return e.tryCloseSxS}));new i.b(O,(function(e){return e.tryExitSxSEditMode}))},1147:function(e,t,n){"use strict";var r="POST",i=n(0),o=n(255),a=n(1257),c=n(280),u=n(1286),s=n(1595),l=n(79);function d(e,t,n,r,c){return Object(i.__awaiter)(this,void 0,void 0,(function(){var u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Object(a.d)(e,!1,n)];case 1:return u=i.sent(),[3,3];case 2:return i.sent(),[3,3];case 3:return u&&u.split(a.a)[1]?(Object(o.o)("fetchServiceViaDataProvider",[e]),l.g.info("fetchServiceViaDataProvider"),[4,f(t,u,r,c)]):[3,5];case 4:return[2,i.sent()];case 5:Object(o.o)("fetchServiceFailedToGetToken",[e]),i.label=6;case 6:return 0!==e?[3,8]:(Object(o.o)("fetchServiceViaOWAServer"),l.g.info("fetchServiceViaOWAServer"),[4,p(e,t,r,c)]);case 7:return[2,i.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function f(e,t,n,r){return Object(i.__awaiter)(this,void 0,void 0,(function(){var a,u,s;return Object(i.__generator)(this,(function(i){return a=n.datapointNamePrefix+"DataProvider",u=new o.a(a),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},r&&Object.keys(r).forEach((function(e){s[e]=r[e]})),[2,fetch(e,{method:n.method,mode:n.mode,headers:s,body:n.body}).then((function(e){if(Object(c.a)(e.status))return u.end(),e.json();var t=new Error(a+" : Response status = "+e.status+", body = "+e.body);u.endWithError("ServerError",t);var n={datapointName:a,responseStatus:e.status,responseBody:e.body};throw JSON.stringify(n)})).then((function(e){return JSON.stringify(e)}))]}))}))}function p(e,t,n,a){return Object(i.__awaiter)(this,void 0,void 0,(function(){var l,d,f,p,b,h;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return l=n.datapointNamePrefix+"OWA",d=new o.a(l),f=Object(u.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(a),IsJsonPost:n.method===r}),[4,Object(s.a)(f)];case 1:if(p=i.sent(),Object(c.a)(p.Status))return d.end(),[2,p.Body];throw b=new Error(l+" : Response status = "+p.Status+", ServerTraceLog = "+p.ServerTraceLog),d.endWithError("ServerError",b),h={datapointName:l,responseStatus:p.Status,responseServerTraceLog:p.ServerTraceLog},JSON.stringify(h)}}))}))}function b(e){var t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return"cors"})),n.d(t,"b",(function(){return"GET"})),n.d(t,"e",(function(){return"PUT"})),n.d(t,"c",(function(){return"PATCH"})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return b}))},1151:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(4),i=Object(r.action)("reloadReadingPaneAfterClosingSxS"),o=Object(r.action)("onSxSReadingPaneChange",(function(e,t){return{readingPaneState:e,sxsId:t}})),a=Object(r.action)("onBeforeSxSReadingPaneChange",(function(e){return{id:e}})),c=Object(r.action)("onSxSChangeOrClose",(function(e,t){return{selectedLinkId:e,isSelectedLinkReadOnly:t}})),u=Object(r.action)("showSxS",(function(e,t,n,r,i,o,a){return{customization:e,extendedViewState:t,editState:n,selectedLinkId:r,sigsInfo:i,sxsId:o,displayMode:a}})),s=Object(r.action)("closeSxS")},1155:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return f}));var r,i=n(1483),o=n(1283),a=n(967),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(o.a)(e+"_16x16"),small:Object(o.a)(e+"_20x20"),medium:Object(o.a)(e+"_32x32"),large:Object(o.a)(e+"_64x64"),cdn:Object(i.a)(e+"_16x16")},c[e])}var s="generic",l=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".apk":"exe",".application":"exe",".app":"exe",".appref-ms":"exe",".appx":"exe",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".ipa":"exe",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":s,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".msi":"exe",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xap":"exe",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"});function f(e,t,n){if(void 0===t&&(t=!1),t)return r=r||{extraSmall:null,small:Object(o.a)("folder_20x20"),medium:Object(o.a)("folder_32x32"),large:Object(o.a)("folder_64x64"),cdn:Object(i.a)("folder_16x16")};var c=null,f=Object(a.b)(e);return f&&(c=l[f.toLowerCase()]),!c&&n&&n in d&&(c=d[n]),u(c||s)}},1203:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1),i={};function o(e){var t;null===(t=i[e.type])||void 0===t||t.forEach((function(t){return t(e)}))}function a(e){var t;return i[e]=null!==(t=i[e])&&void 0!==t?t:new Map}function c(e,t,n){var i=r.useRef();r.useEffect((function(){return function(e,t,n){var r=a(e);0===r.size&&window.addEventListener(e,o),r.set(t,n)}(e,i,t),function(){return function(e,t){var n=a(e);n.delete(t),0===n.size&&window.removeEventListener(e,o)}(e,i)}}),n)}},1209:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return v}));var r=n(1065),i=n(1119),o=n(2611),a=n(4),c=n(1705),u=n(1691),s=n(76),l=n(1420),d=n(23);function f(){var e={shouldShow:!1,displayMode:0,viewState:Object(o.a)(),extendedViewState:{previewMode:r.b.Unsupported,attachmentId:null,selectionSource:c.a.MailList,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},editState:{mode:u.a.View,editAllowed:!1,itemId:null,isDraft:!1},customPreviewState:null,eventManager:new i.a,pendingPreviewOperation:null,pendingNavigation:null,readingPaneState:null,composeId:null,customization:null,isInvisible:!1,shouldUseFakeRightHandSide:!1,isUsingFakeRightHandSide:!1,shouldHideReadingPaneOutsideSxS:!1,attachmentViewStateIdFromListView:null,sessionPreviewCount:0,sessionStartTime:0,meetingMessageAddToCalendarStatus:1,sigsInfo:null};return e.viewState.previewPane=null,e}var p=Object(a.createStore)("sxsstore",f()),b={mainWindowSxSId:null,sxsStoreMapping:new d.ObservableMap({})},h=Object(a.createStore)("sxsStore",b);function v(e){if(Object(s.h)("doc-SxS-multipleViews")){if(e=e||l.a,!h().sxsStoreMapping.has(e)){var t=f();h().sxsStoreMapping.set(e,t)}return h().sxsStoreMapping.get(e)}return p()}},1226:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(4),i=Object(r.action)("ADD_SHARING_LINK",(function(e,t,n,r,i,o,a){return{linkId:e,url:t,sharingLinkIds:n,response:r,source:i,providerType:o,unwrappedUrl:a}})),o=Object(r.action)("SHARING_LINK_REMOVED",(function(e,t){return{linkId:e,sharingLinkIds:t}})),a=Object(r.action)("DELETE_LINK",(function(e,t){return{linkId:e,targetWindow:t}})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(function(e,t,n,r){return{linkId:e,providerId:t,isTryAgain:n,targetWindow:r}})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(function(e,t,n,r){return{linkId:e,recipientInfos:t,composeId:n,isCalendar:r}})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(function(e,t){return{linkId:e,linkIdContainer:t}}))},1227:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(4),i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(function(e,t){return{linkId:e,sharingDialogResponse:t}})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(function(e,t){return{linkId:e,newPermission:t}})),a=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(function(e,t,n,r){return{linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r}})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(function(e,t){return{linkId:e,actionStatus:t}})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(function(e,t,n,r,i,o,a,c,u){return{linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:i,providerType:o,composeId:a,recipientInfos:c,isCalendar:u}})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(function(e,t){return{linkId:e,linkModel:t}})),l=Object(r.action)("TOKEN_UNAVAILABLE",(function(e){return{linkId:e}}))},1228:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1147),i=n(1489);function o(e){switch(e){case 3:return a;case 2:return c;case 0:return u;case 1:return s;case 5:return l;default:throw new Error("File provider "+e+" is not supported.")}}var a={providerType:3,create_shared_link_request:{requestUrlFormat:i.a+"/{0}/{1}",method:r.e,body:{shared_link:{access:"open",permissions:{can_download:!0,can_preview:!0}}},dataPointName:"BoxCreateLink"},get_file_info_request:{requestUrlFormat:i.a+"/shared_items",method:r.b,additional_headers:{BoxApi:"shared_link={0}"},dataPointName:"GetBoxFileInfo"}},c={providerType:2,get_shared_link_request:{requestUrlFormat:i.b+"/list_shared_links",method:r.d,body:{path:null,direct_only:!0},dataPointName:"DropboxCreateLink"},create_shared_link_request:{requestUrlFormat:i.b+"/create_shared_link_with_settings",method:r.d,body:{path:null,settings:{requested_visibility:"public"}},dataPointName:"DropboxCreateNewLink"},get_file_info_request:{requestUrlFormat:i.b+"/get_shared_link_metadata",method:r.d,body:{url:null},dataPointName:"GetDropboxFileInfo"}},u={providerType:0,create_shared_link_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/driveItem/invite",method:r.d,additional_headers:{prefer:"getDefaultLink"},dataPointName:"OneDriveProCreateLink"},get_file_info_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/?expand=sharepointIds,permission,driveItem(select=webDavUrl,name,folder,package)",method:r.b,dataPointName:"GetODBFileInfo"},get_shared_item_request:{requestUrlFormat:"https://{0}/"+Object(i.q)(0)+"/{1}/",method:r.b,dataPointName:"GetODBSharedItem",additional_headers:{prefer:"redeemSharingLinkIfNecessary"}}},s={providerType:1,create_shared_link_request:{requestUrlFormat:i.e+"/"+Object(i.i)(1)+"/items/{0}/action.createLink",method:r.d,body:{type:null},dataPointName:"OneDriveConsumerCreateLink"},change_link_permission_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/root/action.createLink",method:r.d,body:{type:null},dataPointName:"OneDriveConsumerChangeLinkPermission"},get_drive_item_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/driveItem",method:r.b,dataPointName:"GetODCDriveItem"},get_file_permission_request:{requestUrlFormat:i.e+"/"+Object(i.q)(1)+"/{0}/driveItem/permissions",method:r.b,dataPointName:"GetODCFilePermission"}},l={providerType:5,get_file_info_request:{requestUrlFormat:i.d+"/{0}?fields=id,name,webViewLink,mimeType,capabilities,permissions,permissionIds",method:r.b,dataPointName:"GetGDriveFileInfo"},create_shared_link_request:{requestUrlFormat:i.d+"/{0}/permissions",method:r.d,body:{role:null,type:"anyone"},dataPointName:"GDriveCreateLink"},change_link_permission_request:{requestUrlFormat:i.d+"/{0}/permissions/{1}",method:r.c,body:{role:null},dataPointName:"GDriveChangeLinkPermission"}}},1229:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(1147);function o(e,t,n,o,a,c,u){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return s={method:o,mode:i.a,body:a,datapointNamePrefix:u},[4,Object(i.f)(e,t,c,s,n)];case 1:return[2,r.sent()]}}))}))}},1232:function(e,t,n){"use strict";var r=function(e){return e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e)},i=n(9),o=n(1018);function a(e){switch(e.__type){case o.e:return 0;case o.n:return e.IsLink?3:1;case o.i:return 3;case o.g:return 2;case o.h:var t=e;return r(e.EmbeddedItemClass)||Object(i.f)(t.AttachmentIdToAttach)?2:0;default:throw new Error("Invalid type of attachment "+e.__type)}}n.d(t,"a",(function(){return a}))},1245:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1232);function i(e){return a(e.type)}function o(e){return a(Object(r.a)(e))}function a(e){return 1===e||3===e}},1257:function(e,t,n){"use strict";var r=n(0),i=n(1736),o=n.n(i),a=n(9),c=n(295),u=n(699),s=n(288),l=n(24);function d(e){return Object(r.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=d(e)),Object(l.a)("GetAccessTokenforDataProvider",e,t)}function p(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=d({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),o=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider",(a=new Headers).append("X-OWA-ActionName",o),[4,f(i,{headers:a,datapoint:{customData:{actionSource:n},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(c=r.sent()).json()];case 2:return[2,{token:r.sent(),response:c}]}}))}))}var b="onedrive_implicit.access",h="Bearer ",v=n(76),m=function(e,t,n){return Object(r.__assign)({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e)},O=function(e){return"TokenRetrievalError"===e._typeSpec},g=[],_={},w=1,j=30,I="",y="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function k(e){_[e]=null}function S(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(e,t,n)];case 1:return i=r.sent(),function(e,t,n){g=g.filter((function(e){return e!==t}));var r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){var i="Access token request failed for token key "+e+" with response code "+r.TokenResultCode,o=n.response.headers.get("x-tokenresult"),a=null!=o&&o.indexOf(y)>0;throw m(new Error(i),r.TokenResultCode,a)}var c=_[e]||{};c[t]=r,_[e]=c}(e,t,i),[2,i.token]}}))}))}function C(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){return i=I,0===e&&n&&(o=Object(s.parse)(n),i=Object(a.c)("{0}//{1}/",o.protocol,o.hostname)),Object(v.h)("doc-attachment-testAuthFallback")?[2,""]:[2,A(e,i,t,null)]}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return[2,A(0,e,t,n)]}))}))}function A(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n||!function(e,t){var n=_[e];if(!n)return!1;var r=n[t];if(!r||!r.AccessTokenExpiry)return!1;var i=new Date(r.AccessTokenExpiry),a=o()(new Date(Date.now()),w);return null!=i&&a<i}(e,t)?[3,1]:(a=_[e],c=a[t],o()(new Date(Date.now()),j)>new Date(c.AccessTokenExpiry)&&-1===g.indexOf(t)&&(g.push(t),S(e,t,i)),[2,c.AccessToken]);case 1:return[4,S(e,t,i)];case 2:return[2,(c=r.sent()).AccessToken]}}))}))}function P(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(b)]:[3,2];case 1:return i=r.sent(),[3,4];case 2:return[4,C(e,t,n)];case 3:i=r.sent(),r.label=4;case 4:return[2,h+i]}}))}))}n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return T})),n.d(t,"b",(function(){return k})),n.d(t,"f",(function(){return O})),n.d(t,"a",(function(){return h}))},1260:function(e,t,n){"use strict";function r(e){var t=e.AttachmentPolicy;return t.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||t.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?t.ConditionalAccessWacViewingOnPrivateComputersBlocked||t.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}n.d(t,"a",(function(){return r}))},1261:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(314);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1268:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u}));var r=n(108),i=new r.c((function(){return Promise.all([n.e(14),n.e(19),n.e(697),n.e(324)]).then(n.bind(null,2747))})),ReactEditor=Object(r.d)(i,(function(e){return e.ReactEditor})),o=new r.b(i,(function(e){return e.setTableHeaderRow})),a=new r.b(i,(function(e){return e.operateContent})),c=new r.b(i,(function(e){return e.focusToEditor}));function u(e){c.import().then((function(t){return t(e)}))}},1270:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2065),i=n(1399);function o(e){var t=Object(r.a)(),n=Object(i.b)(e);return t.sharingLinks.get(n)}},1282:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},1283:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2505),i="fileType-icon";function o(e){return r[function(e){return i+"-"+e}(e)]}},1286:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},1288:function(e,t,n){"use strict";var r=n(0),i=n(1882),o=n(1771),a=n(1109),c={},u=function(){function e(e,t,n){var r=this;this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=function(){r.currentTimePercent+=r.updateIntervalInPercent;var e=r.getActionCompletePercent();e<=r.maxPercent?(r.updatePropertyHandler(e),r.nextUpdateTimer=setTimeout(r.start,r.estimatedTimeToCompleteInMS*r.updateIntervalInPercent)):r.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}return e.prototype.complete=function(){var e=this;this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout((function(){return e.updatePropertyHandler(1.1)}),500)},e.prototype.abort=function(){this.clearUpdateTimer(),this.updatePropertyHandler(0)},e.prototype.clearUpdateTimer=function(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)},e.prototype.getActionCompletePercent=function(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)},e}();function s(e,t){var n=c[e.Id];n&&(t?n.complete():n.abort(),delete c[e.Id])}function l(e,t,n,r){var i=new u(e,t,n);c[r.Id]=i,i.start()}var d=n(2639),f=n(4);Object(f.orchestrator)(i.a,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=e.attachment,Object(a.a)(i,7,13),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(d.a)(null,null,e.attachment.attachmentId.Id)];case 2:return t=r.sent(),[3,4];case 3:return r.sent(),[3,4];case 4:return n=t&&"Success"===t.ResponseClass?14:15,function(e,t,n,r,i){s(e,!0),Object(o.a)(n,i),Object(a.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7),[2]}var i}))}))}));var p=n(1071),b=n(2148);function h(e){return Object(r.__assign)({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var v=n(24);function m(e,t,n,r,i){var o,a,c=function(e,t,n,r,i){return h({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:i})}(e,t,n,r,i);return void 0===(o={requestObject:c}).requestObject||o.requestObject.__type||(o.requestObject=h(o.requestObject)),Object(v.a)("ConvertLocalToRefAttachment",o,a)}var O=n(255),g=n(992),_=n(1634),w=n(1061),j=n(283),I={},y=Object(j.action)("convertClassicToCloudy")((function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=new O.a("AttachmentConvertClassicToCloudy"),function(e){Object(a.a)(e,5,8)}(e),o=function(t){if(S(e,t.ResultCode),C(i,e.attachmentId,t.ResultCode,t.Exception),0===t.ResultCode&&t.Response&&t.Response.ResponseMessages&&t.Response.ResponseMessages.Items&&t.Response.ResponseMessages.Items.length>0&&"NoError"===t.Response.ResponseMessages.Items[0].ResponseCode){var r=t.Response.ResponseMessages.Items[0];n(!0,r.Attachments[0])}else n(!1,null);return!0},c=function(t){S(e,1),n(!1,null),C(i,e.attachmentId,1,t)},[4,k(e.attachmentId,t,o,c)];case 1:return r.sent(),[2]}}))}))}));function k(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,c,u,s,l;return Object(r.__generator)(this,(function(d){switch(d.label){case 0:return[4,Object(_.a)(n)];case 1:o=r.__read.apply(void 0,[d.sent(),4]),a=o[0],c=o[1],u=o[2],s=o[3],I[e.Id]=a,d.label=2;case 2:return d.trys.push([2,4,,5]),[4,m(e.Id,t,a,s,a)];case 3:return d.sent(),[3,5];case 4:return l=d.sent(),i(l.message),w.g.importAndExecute(c,u),[3,5];case 5:return[2]}}))}))}function S(e,t){switch(t){case 0:break;case 11:Object(a.a)(e,0,0);break;default:Object(a.a)(e,0,9)}delete I[e.attachmentId.Id]}function C(e,t,n,r){var i=Object(g.a)(t);e.addCosmosOnlyData(JSON.stringify({size:i.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}var T={name:"CancelConvertClassicToCloudy"},A={name:"CancelConvertCloudyToClassic"};function P(e){return Object(r.__assign)({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function x(e){var t,n,r=function(e){return P({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=P(t)),Object(v.a)("CancelConvertLocalToRefAttachment",t,n)}var E=n(123),L=Object(E.d)("cancelConvertClassicToCloudy",T)((function(e){var t,n=(t=e.attachmentId.Id,I[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(a.a)(e,5,10),x(n)})),R=n(1454),N=Object(j.action)("setActionCompletePercent")((function(e,t){e.actionCompletePercent=t})),D=n(2146),F=n(1772),M=(n(1737),n(1395)),U=n(1814),q=n(1065),W=n(2074),B=n(2478),V=n(2818),z=n(1245),G=Object(j.action)("updateAttachment")((function(e,t,n,i,o){Object(B.a)(e.attachmentId);var c=Object(r.__assign)(Object(r.__assign)({},i.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=c,i.Name&&(n.Name=i.Name),i.Size&&(n.Size=i.Size),i.ContentType&&(n.ContentType=i.ContentType),i.__type&&(n.__type=i.__type),n.IsInline&&(n.ContentId=i.ContentId),Object(z.b)(i)){var u=n;u.AttachLongPathName=i.AttachLongPathName,u.PermissionType=i.PermissionType,u.ProviderType=i.ProviderType,u.AttachmentThumbnailUrl=i.AttachmentThumbnailUrl,u.AttachmentPreviewUrl=i.AttachmentPreviewUrl}if(Object(W.a)([{attachmentId:c,attachment:n,permissionInfo:o}],!1),e.attachmentId=c,Object(U.a)(e))Object(F.a)(e,1);else{Object(q.g)(e,!1),setTimeout((function(){N(e,1.1)}),500),Object(a.a)(e,0,0);var s=Object(g.a)(c);Object(M.a)(e,s,!1,e.strategy.supportedMenuActions),s.download.url||Object(V.a)(c,e.isReadOnly,!0)}}));function H(e){return Object(r.__assign)({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function J(e,t,n,r,i,o,a,c){var u,s,l=function(e,t,n,r,i,o,a,c){return H({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:i,fullPathLocation:o,attachmentDataProviderId:c,PermissionLevel:a})}(e,t,n,r,i,o,a,c);return void 0===(u={requestObject:l}).requestObject||u.requestObject.__type||(u.requestObject=H(u.requestObject)),Object(v.a)("ConvertRefToLocalAttachment",u,s)}function Y(e){return $(Object(g.a)(e).model.Size)}function K(e){return 2856+.00145*e}function X(e){return 4*$(e)}function Q(e){return 4*$(e)}function Z(e){return 2*$(e)}function $(e){return Math.round(e/256)}var ee=n(2514),te={},ne=Object(f.action)("convertCloudyToClassic",(function(e,t,n,r,i,o){return{attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:i,source:o}})),re=ne;function ie(e,t,n,i,o,a){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c,u,s,l,d,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return[4,Object(_.a)(o)];case 1:c=r.__read.apply(void 0,[p.sent(),4]),u=c[0],s=c[1],l=c[2],d=c[3],te[e.Id]=u,p.label=2;case 2:return p.trys.push([2,4,,5]),[4,J(e.Id,t,u,d,u,n,i)];case 3:return p.sent(),[3,5];case 4:return f=p.sent(),a(f.message),w.g.importAndExecute(s,l),[3,5];case 5:return[2]}}))}))}function oe(e,t){switch(t){case 0:break;case 11:Object(a.a)(e,0,0);break;default:Object(a.a)(e,0,12)}delete te[e.attachmentId.Id]}function ae(e,t,n,r,i){var o,a=Object(g.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size,attachmentId:null===(o=a.model.AttachmentId)||void 0===o?void 0:o.Id})),e.addCustomData([n,i]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function ce(e){return Object(r.__assign)({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function ue(e){var t,n,r=function(e){return ce({cancellationId:e})}(e);return void 0===(t=r)||t.__type||(t=ce(t)),Object(v.a)("CancelConvertRefToLocalAttachment",t,n)}Object(f.orchestrator)(ne,(function(e){var t=e.attachment;!function(e,t,n,i,o,c){Object(r.__awaiter)(this,void 0,void 0,(function(){var u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=new O.a("AttachmentConvertCloudyToClassic"),function(e){Object(a.a)(e,6,11)}(e),s=function(t){if(oe(e,t.ResultCode),ae(u,e.attachmentId,t.ResultCode,t.Exception,c),0===t.ResultCode){var n=Object(ee.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});o(!0,n)}else o(!1,null);return!0},l=function(t){oe(e,1),o(!1,null),ae(u,e.attachmentId,1,t,c)},[4,ie(e.attachmentId,t,n,i,s,l)];case 1:return r.sent(),[2]}}))}))}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(function(n,r){n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)}),e.source),l(Y(t.attachmentId),.1,(function(e){N(t,e)}),t.attachmentId)}));var se=Object(f.action)("cancel_ConvertCloudyToClassic",(function(e){return Object(E.c)(A,{attachmentViewState:e})})),le=se;Object(f.orchestrator)(se,(function(e){var t,n=(t=e.attachmentViewState.attachmentId.Id,te[t]);if(!n)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(a.a)(e.attachmentViewState,6,10),ue(n)}));var de=n(1036),fe=n(1120),pe=n(2014),be=n(1407);function he(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,be.h.import()];case 1:return n.sent()(e.model.AttachLongPathName,pe.a.OneDrivePro).then((function(n){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n&&0===n.ResultCode?[2]:(t=Object(fe.b)(e.model,!0),[4,de.h.importAndExecute(t,e.attachmentClass,e.model,!0,e.model.ProviderType,n)]);case 1:return i=r.sent(),de.m.importAndExecute(e.id,i),Object(de.p)(e.id),[2]}}))}))})),[2]}}))}))}var ve=n(76),me=n(967);function Oe(e,t,n){if(e&&t===de.a.providers.ONE_DRIVE_PRO&&(Object(ve.h)("doc-SxS-jsApi-ODB-Base")||Object(ve.h)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(ve.h)("doc-SxS-jsApi-ODB-Readonly"))){var r=n&&n.substring(n.lastIndexOf("."));switch(Object(me.f)(r)){case me.a.Word:return Object(ve.h)("doc-SxS-jsApi-ODB-Word");case me.a.Excel:return Object(ve.h)("doc-SxS-jsApi-ODB-Excel");case me.a.PowerPoint:return!Object(ve.h)("doc-SxS-jsApi-ODB-Readonly")&&Object(ve.h)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var ge=n(1815),_e=n(1078);function we(e,t,n,r,i){return void 0===n&&(n=!1),void 0===r&&(r=0),void 0===i&&(i=!1),{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:_e.a.Inline,skipProcessInlineImage:i}}function je(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var Ie=n(1770);n(1921);n.d(t,"a",(function(){return p.a})),n.d(t,"h",(function(){return b.a})),n.d(t,"c",(function(){return L})),n.d(t,"e",(function(){return y})),n.d(t,"u",(function(){return R.a})),n.d(t,"w",(function(){return R.c})),n.d(t,"v",(function(){return R.b})),n.d(t,"D",(function(){return R.d})),n.d(t,"x",(function(){return N})),n.d(t,"y",(function(){return D.a})),n.d(t,"z",(function(){return F.a})),n.d(t,"A",(function(){return a.a})),n.d(t,"E",(function(){return G})),n.d(t,"r",(function(){return M.a})),n.d(t,"o",(function(){return M.b})),n.d(t,"d",(function(){return le})),n.d(t,"f",(function(){return re})),n.d(t,"m",(function(){return he})),n.d(t,"b",(function(){return Oe})),n.d(t,"B",(function(){return l})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return K})),n.d(t,"l",(function(){return Q})),n.d(t,"q",(function(){return X})),n.d(t,"j",(function(){return Z})),n.d(t,"g",(function(){return ge.a})),n.d(t,"i",(function(){return we})),n.d(t,"p",(function(){return Y})),n.d(t,"t",(function(){return je})),n.d(t,"s",(function(){return U.a})),n.d(t,"n",(function(){return Ie.a}))},1294:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(1209),i=n(114);function o(e){return Object(r.a)(e).shouldShow}function a(e){return Object(r.a)(e).shouldShow&&Object(r.a)(e).shouldHideReadingPaneOutsideSxS}function c(e,t){return o(t)&&Object(i.f)(e,Object(r.a)(t).extendedViewState.attachmentId)}function u(e,t){return o(t)&&(e&&e.composeId===Object(r.a)(t).composeId||!e&&Object(r.a)(t).composeId)}},1307:function(e,t,n){"use strict";var r=n(0),i=n(24);function o(e){return Object(r.__assign)({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function a(e){var t,n,r=o({ProviderType:e});return void 0===(t=r)||t.__type||(t=o(t)),Object(i.a)("GetNewAttachmentDataProviderCreationInfo",t,n)}function c(e){return Object(r.__assign)({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function u(e){var t,n,r=c({ProviderType:e});return void 0===(t=r)||t.__type||(t=c(t)),Object(i.a)("GetAttachmentDataProviderCreator",t,n)}var s=n(2492),l=n(1661);n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return w}));var d="code",f="token",p=3e3,b=3;function h(e){return{state:e}}function v(e){return e.state}function m(e){return e.code}function O(e,t,n,i,o){var c={providerType:e,getAuthUrlInfo:null,getCSRFToken:v,getOAuthCode:m};return function e(t,n,i,o,c,l,d){return Object(r.__awaiter)(this,void 0,void 0,(function(){var f,b;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),f=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,u(t)];case 1:return b=r.sent(),f=b.AttachmentDataProviderCreator.ProviderAppKey,i=b.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,a(t)];case 3:b=r.sent(),f=b.ProviderAppKey,r.label=4;case 4:return n.getAuthUrlInfo=Object(s.d)(t,i,o,f,c,l),[3,6];case 5:return r.sent(),d>0&&setTimeout((function(){return e(t,n,i,o,c,l,--d)}),p),[3,6];case 6:return[2]}}))}))}(e,c,t,n,i,o,b),c}var g=null;function _(){if(!g){if(g={},Object(l.a)(3)&&(g[3]=O(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),d,h)),Object(l.a)(2)&&(g[2]=O(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),d,h)),Object(l.a)(6)){var e=O(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),f,(function(e){return{state:e,scope:"user_photos,email"}}));e.getCSRFToken=v,e.getOAuthCode=function(e){return e.access_token},g[6]=e}if(Object(l.a)(5)){var t=O(5,"https://accounts.google.com/o/oauth2/auth",s.a+"/ADPRedirect.aspx",d,(function(e){var t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}}));t.getCSRFToken=function(e){return JSON.parse(e.state).state},g[5]=t}Object(l.a)(1)&&(g[1]=O(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),d,(function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}))),Object(l.a)(7)&&(g[7]=O(7,"",Object(s.c)(7),d,h)),Object(l.a)(8)&&(g[8]=O(8,"",Object(s.c)(8),d,h)),Object(l.a)(9)&&(g[9]=O(9,"",Object(s.c)(9),d,h))}return g}function w(e){var t=_();return e in t?t[e]:null}},1325:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},1328:function(e,t,n){"use strict";var r=n(240),i=n(0),o={};function a(e){return o[e]}function c(e,t){var n=o[e];o[e]=Object(i.__assign)(Object(i.__assign)({},n),t)}var u=n(103),s=n(24);var l=n(255),d=n(79),f=n(515),p=n(419),b=n(352);function h(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return(t={}).headers=new Headers,[4,Object(p.a)(e)];case 1:return n=r.sent(),Object(b.b)(t.headers,n),[2,t]}}))}))}var v=Object(f.b)({timeBetweenRetryInMS:function(){return 3e4}});function m(e,t){t=t<1?1:t,setInterval((function(){!function(e){Object(i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,u,f,p,b=this;return Object(i.__generator)(this,(function(m){switch(m.label){case 0:if(t=function(){return Object(i.__awaiter)(b,void 0,void 0,(function(){var t,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t={},Object(r.n)(e.userIdentity)?[4,h(e.userIdentity)]:[3,2];case 1:t=i.sent(),i.label=2;case 2:return[2,(o=t,Object(s.a)("GetAttachmentDownloadToken",{},o))];case 3:throw n=i.sent(),d.g.warn("Unable to get the download token "+n),n.networkError=!0,n;case 4:return[2]}var o}))}))},null==(n=a(e.userIdentity))?void 0:n.isRefreshingDownloadToken)return[3,4];c(e.userIdentity,{isRefreshingDownloadToken:!0}),o=0,u=v((function(){return Object(i.__awaiter)(b,void 0,void 0,(function(){var n;return Object(i.__generator)(this,(function(r){switch(r.label){case 0:return o++,[4,t()];case 1:return n=r.sent(),d.g.info("update new token"),c(e.userIdentity,{downloadToken:n,isRefreshingDownloadToken:!1}),[2]}}))}))})).retriableFunc,f=new l.b("AttachmentRefreshDownloadToken"),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,u()];case 2:return m.sent(),f.addCustomData([o]),f.end(),[3,4];case 3:return p=m.sent(),d.g.warn("Retry to refresh token failed: "+p),f.addCustomData([o]),f.endWithError("ServerError",p),c(e.userIdentity,{isRefreshingDownloadToken:!1}),[3,4];case 4:return[2]}}))}))}(e)}),6e4*t)}var O=n(314);function g(e){var t=Object(r.e)(e.userIdentity),n=a(e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Outlook":!function(e){var t=Object(r.n)(e.userIdentity)?Object(u.j)(e.userIdentity):Object(u.i)(),n=null==t?void 0:t.ApplicationSettings;if(n){var i=n.DownloadUrlBase;c(e.userIdentity,{downloadUrlBase:i,downloadToken:n.FirstDownloadToken}),i&&m(e,n.DownloadTokenRefreshMinutes)}}(e);break;case"Google":case"ICloud":break;default:Object(O.a)(t)}var i=a(e.userIdentity);return i||(Object(l.o)("FilesUrlDataNotFound",{accountProviderType:t}),d.g.warn("Unable to get the url data")),i}function _(e){var t=g(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return _}))},1339:function(e,t,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},1358:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(0),i=n(1392),o=function(){return Object(r.__spread)(Object(i.a)().providers.values())},a=function(e){return Object(i.a)().providers.get(e)||null}},1366:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c}));var r="originalsrc",i="shash",o="data-auth",a="&reserved=0",c="Verified"},1375:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"n",(function(){return h})),n.d(t,"k",(function(){return v})),n.d(t,"p",(function(){return m})),n.d(t,"h",(function(){return O}));var r=100,i=1,o="PublicDL",a="PrivateDL",c="GroupMailbox",u="RecommendedGroup",s="InternalMailbox",l="ExternalMailbox",d="Mailbox",f="OneOff",p="Contact",b="ImplicitContact",h="PublicFolder",v="Other",m="Room",O="LinkedIn"},1384:function(e){e.exports=JSON.parse('{"b":"J_b","d":"K_b","c":"L_b","a":"M_b"}')},1385:function(e,t,n){"use strict";function r(e){var t=null;return(t=e.AttachLongPathName)||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},1392:function(e,t,n){"use strict";var r=n(4),i=n(23),o=n(1643),a={providers:new i.ObservableMap,loadState:o.a.NotLoaded,removalPending:new i.ObservableMap},c=Object(r.createStore)("fileProviderStore",a);t.a=c},1395:function(e,t,n){"use strict";var r=n(2075),i=n(9),o=n(1771),a=n(1109);var c=n(1071),u=n(1245),s=n(1120),l=n(1036),d=n(283);n.d(t,"b",(function(){return p}));var f=null;function p(){return f||(f=Object.keys(c.a).reduce((function(e,t){var n=c.a[t];return Number.isInteger(n)&&e.push(n),e}),[])),f}t.a=Object(d.action)("initializeAttachmentFullViewState")((function(e,t,n,d,f){var b;d&&0!==d.length||(b=t.model,d=Object(l.e)(b)?function(e){return 2===Object(l.c)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(b):p());var h=Object(s.b)(t.model,!0),v=Object(s.e)(),m=Object(u.a)(t),O=Object(r.a)(v,h,t.attachmentClass,t.model,m?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,d,e.isReadOnly,n,f);e.strategy=O,function(e,t,n){n&&!Object(i.f)(t.model.AttachmentOriginalUrl)&&(Object(o.a)(e,2),Object(a.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1399:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(76),i="_ODSPPSL";function o(e){return Object(r.h)("doc-link-savePermission")&&e&&-1!==e.indexOf(i)?e.substring(0,e.length-i.length):e}function a(e){return!!Object(r.h)("doc-link-savePermission")&&e.lastIndexOf(i)===e.length-i.length}function c(e,t){return!Object(r.h)("doc-link-savePermission")||2!==t&&1!==t?e:e+i}},1407:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"l",(function(){return m}));var r=n(108),i=n(1684);n.d(t,"n",(function(){return i.a}));var o=n(1642);n.d(t,"a",(function(){return o.a}));n(1375);var a=n(1339);n.d(t,"d",(function(){return a.b})),n.d(t,"c",(function(){return a.a}));var c=n(1685);n.d(t,"b",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(15),n.e(44),n.e(536)]).then(n.bind(null,3220))})),s=new r.b(u,(function(e){return e.getSharingInformation})),l=new r.b(u,(function(e){return e.getSharingIssuesForSharingData})),d=new r.b(u,(function(e){return e.getInfoBarCreator})),f=new r.b(u,(function(e){return e.hasLargeDLRecipient})),p=new r.b(u,(function(e){return e.hasRecipientExpansionFailure})),b=new r.b(u,(function(e){return e.getGroupsAndSmallDLs})),h=new r.b(u,(function(e){return e.getInvididualRecipients})),v=new r.b(u,(function(e){return e.hasGetRecipientPermissionFailed})),m=new r.b(u,(function(e){return e.logSharingTipChangesForLinkRemoval}))},1408:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(4),i=Object(r.action)("FILE_PROVIDER_ADDED",(function(e){return{providerViewState:e}})),o=Object(r.action)("FILE_PROVIDER_REMOVED",(function(e){return{providerType:e}})),a=Object(r.action)("PROVIDERS_LOADED",(function(e){return{providers:e}}))},1420:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var r,i="sxsIdMainWindow";!function(e){e[e.Mail=0]="Mail",e[e.FilesHub=1]="FilesHub",e[e.DeepLink=2]="DeepLink",e[e.GroupFilesHub=3]="GroupFilesHub"}(r||(r={}))},1428:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1703),i=n(1260),o=n(26),a=n(1261);function c(){var e=Object(o.a)();return Object(i.a)(e)}function u(e){var t=Object(o.a)();return(e&&e.length>0&&function(e){return e.some((function(e){return!((t=e).IsInline&&!function(e){return e.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(t));var t}))}(e)?Object(i.a)(t):[]).map(a.a)}},1454:function(e,t,n){"use strict";var r=n(0),i=n(255),o=n(2876),a=n(992),c=n(2301),u=n(2590),s=n(76),l=n(2408),d=n(283),f=n(1921),p=n(1771),b=n(2075),h=n(1109),v=Object(d.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return w}));t.a=Object(d.action)("saveToCloud")((function(e,t,n,i,o){var a=Object(r.__read)(O(e,t,n,i,!1,o),2),c=a[0],s=a[1];Object(u.b)(e.attachmentId,null,c,s)}));function m(e,t,n,i,o,a){var c=Object(r.__read)(O(e,t,n,i,!0,a),2),s=c[0],l=c[1];Object(u.c)(e.attachmentId,s,l,o)}function O(e,t,n,r,o,a,c){var u=new i.a("AttachmentSaveToCloud");f.a.run(2,e.attachmentId,c),_(e,o);return[function(i){var o=0===i.ResultCode;return w(e,o,o?i.Item.Location:null,c),t(o),g(u,e.attachmentId,i.ResultCode,"ServerError",i.Exception,n,r,a),!0},function(i,o,c,s){w(e,!1,null,s),t(!1),g(u,e.attachmentId,o,c,i,n,r,a)}]}function g(e,t,n,r,o,u,d,f){var p=Object(a.a)(t);e.addCustomData({entryPoint:u,result:n});var b=Object(c.a)(p);e.addCosmosOnlyData(JSON.stringify({size:p.model.Size,fileType:b})),0===n?e.end():e.endWithError(r,new Error(o)),Object(s.h)("doc-attachment-sigs")&&Object(l.a)(null==d?void 0:d.Id).then((function(e){i.l.importAndExecute("SavedAttachment",{itemId:e,customProperties:{FileId:t.Id,FileType:b,Destination:"Cloud",Sender:f}})}))}function _(e,t){void 0===t&&(t=!1);var n=t?18:1;Object(h.a)(e,2,n)}function w(e,t,n,r){if(t){Object(p.a)(e,2),Object(o.a)(e.attachmentId,n),f.a.run(3,e.attachmentId,r);var i=Object(b.b)(!1,!1,n);v(e,i)}else f.a.run(4,e.attachmentId,r);Object(h.a)(e,0,t?3:4)}},1467:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r,i=n(1155),o=n(1483);function a(e,t,n,a,c){if(n)return r=r||{extraSmall:Object(i.b)("generic").extraSmall,small:Object(i.b)("generic").small,medium:Object(i.b)("blockedfile").medium,large:Object(i.b)("generic").large,cdn:Object(o.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":case"IPM.Schedule.Meeting.Request":case"IPM.Schedule.Meeting.Canceled":return Object(i.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(i.b)("calendar")}return a?Object(i.b)("sharedfolder"):Object(i.a)(e,!1,t)||Object(i.b)("generic")}},1483:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=1;function i(e){return"https://r"+(r++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1484:function(e,t,n){"use strict";var r=n(0),i=n(1906),o=n(2059),a=n(314);var c=Object(i.a)((function(e){switch(e){case 0:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:function(e,t){return t},supportedPermissionLevels:[2,1]});case 3:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 2:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:function(e,t){return!1}});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e){return Object(o.a)(e)},supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object(r.__assign)(Object(r.__assign)({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:function(e,t){return!0},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:function(e,t){return!1}});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:function(e,t){return!1},supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(a.a)(e)}})),u=c.getDataProviderInfo;c.getDefaultDataProviderInfo;t.a=u},1489:function(e,t,n){"use strict";var r=n(0),i="https://www.googleapis.com/drive/v3/files",o=n(1257);function a(e,t,n){return void 0===n&&(n={forceTokenRefresh:!1,requestInit:{}}),Object(r.__awaiter)(this,void 0,void 0,(function(){var i,a,c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return i=n.forceTokenRefresh,a=n.requestInit||{},[4,Object(o.d)(t,i,e)];case 1:return c=r.sent(),a.headers||(a.headers=new Headers),a.headers.set("Authorization",c),[4,fetch(e,a)];case 2:return[2,r.sent()]}}))}))}function c(e,t){return void 0===t&&(t=!1),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(i+"?"+e,5,{forceTokenRefresh:t})];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o)}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}function u(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(i+"/"+e+"?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension",5)];case 1:return(t=r.sent()).ok?[4,t.text()]:[3,3];case 2:return n=r.sent(),[2,{errorResponse:null,result:JSON.parse(n)}];case 3:return[2,{errorResponse:t,result:null}]}}))}))}var s=n(314),l=n(1147),d=n(76),f=n(288),p=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function b(){return Object.keys(p).map((function(e){return p[e]})).join(",")}var h,v="_api/v2.0",m="/v1.0",O="root";function g(e){switch(e){case 1:return m;case 0:return v;default:return Object(s.a)(e)}}function _(e){return g(e)+"/drive"}function w(e){return g(e)+"/shares"}function j(e){return _(e)+"/items"}function I(e,t,n,i,o,c,u){return void 0===c&&(c=h.None),Object(r.__awaiter)(this,void 0,void 0,(function(){var f,v,m,g,_,w,I,k,S,C;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=o||O,f=function(e){switch(e){case 0:return p.name;case 1:return p.size;default:return p.lastModifiedDateTime}}(n),v=function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(s.a)(e)}}(i),m=function(e,t,n){switch(e){case 0:return"folder,"+t+" "+n;case 1:return t+" "+n;default:return Object(s.a)(e)}}(t,f,v),g="expand=thumbnails(select=medium)&orderby="+m+"&select="+b(),c!==h.None&&(g=g+"&filter="+function(e){switch(e){case h.None:return"";case h.Folder:return"("+p.folder+" ne null)";default:return Object(s.a)(e)}}(c)),u&&(g=g+"&$top="+u.maxEntries,u.skipToken&&(g=g+"&$skiptoken="+u.skipToken)),_=e+"/"+j(t)+"/"+o+"/children?"+g,w={Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"},Object(d.h)("doc-attachment-uploadAndShareFallback")?[4,Object(l.f)(t,encodeURI(_),_,{method:l.b,mode:l.a,datapointNamePrefix:"getOneDriveItems"},w)]:[3,2];case 1:return k=r.sent(),S=JSON.parse(k),C=S["@odata.nextLink"]?y(decodeURI(S["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:S.value,skipToken:C}}];case 2:return[4,a(_,t,{requestInit:{headers:new Headers(w)}})];case 3:return(I=r.sent()).ok?[4,I.text()]:[3,5];case 4:return k=r.sent(),S=JSON.parse(k),C=S["@odata.nextLink"]?y(decodeURI(S["@odata.nextLink"])):null,[2,{errorResponse:null,result:{items:S.value,skipToken:C}}];case 5:return[2,{errorResponse:I,result:null}]}}))}))}function y(e){var t=Object(f.parse)(e,!0);return t.query?t.query.$skiptoken:null}function k(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o,a,c,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:i=i||O,o="expand=thumbnails(select=medium)&select="+b(),a=t+"/"+j(e)+"/"+i+"/children?"+o,c={name:n,folder:{}},(u=new Headers).append("Content-Type","application/json"),u.append("Accept","application/json"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l.f)(e,encodeURI(a),a,{method:l.d,mode:l.a,body:JSON.stringify(c),datapointNamePrefix:"createNewFolder"},null)];case 2:return s=r.sent(),[2,{errorResponse:null,result:JSON.parse(s)}];case 3:return[2,{errorResponse:r.sent(),result:null}];case 4:return[2]}}))}))}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(h||(h={}));var S=n(2830),C=n(280);var T=Object.freeze({folderInfo:{type:0,identifier:O},sliceSize:10485760,conflictBehavior:"rename",onProgress:function(){}});function A(e,t,n){var i=this,o=function(){return Promise.resolve({errorResponse:null,result:null})};return{uploadPromise:Object(r.__awaiter)(i,void 0,void 0,(function(){var i,c,u,f,p,b,h,v,m,O,g,w,I,y,k,S,C,A,x,E;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(function(e){Object.keys(T).forEach((function(t){e[t]=e[t]||T[t]}))}(n),i=n.fileToUpload,c=i.fileName,u=i.fileBlob,f=n.folderInfo,p=f.type,b=f.identifier,h=n.conflictBehavior,v=n.sliceSize,m=n.onProgress,p){case 0:O=t+"/"+j(e)+"/"+b+":/"+encodeURI(c)+":/createUploadSession";break;case 1:O=t+"/"+_(e)+"/"+b+":/"+encodeURI(c)+":/createUploadSession";break;default:Object(s.a)(p)}return g={item:{"@name.conflictBehavior":h}},w=new Headers({"Content-Type":"application/json",Accept:"application/json"}),Object(d.h)("doc-attachment-uploadAndShareFallback")?[4,Object(l.f)(e,O,O,{method:l.d,mode:l.a,body:JSON.stringify(g),datapointNamePrefix:"createUploadSession"},null)]:[3,3];case 1:return I=r.sent(),y=P(JSON.parse(I),u,v,m),x=y.uploadPromise,E=y.cancel,o=E,[4,x];case 2:return[2,r.sent()];case 3:return[4,a(O,e,{requestInit:{method:l.d,body:JSON.stringify(g),headers:w}})];case 4:return(k=r.sent()).ok?[4,k.text()]:[3,7];case 5:return S=r.sent(),C=JSON.parse(S),A=P(C,u,v,m),x=A.uploadPromise,E=A.cancel,o=E,[4,x];case 6:return[2,r.sent()];case 7:return[2,{errorResponse:k,result:null}]}}))})),cancel:function(){return Object(r.__awaiter)(i,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:return[4,o()];case 1:return[2,e.sent()]}}))}))}}}function P(e,t,n,i){var o=this,a=e.uploadUrl,c=t.size,u=null,l=null,d=function(e,t,n,i,o,a){var c=this;return function(u,s){return Object(r.__awaiter)(c,void 0,void 0,(function(){var c,l,d,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return c=function(e,t,n){var r=x(e,t,n),i=r.rangeStart,o=r.rangeEnd;return new Headers({"Content-Range":"bytes "+i+"-"+o+"/"+n,Accept:"application/json"})}(s,t,n),l=function(e){var r=x(e,t,n).rangeStart;return function(e){var t=e.loaded;i({loaded:r+t,total:n})}}(s),[4,(b=e,h=l,v={method:"PUT",body:u,headers:c},void 0===v&&(v={method:"POST"}),new Promise((function(e,t){var n=v.method,r=v.body,i=v.headers,o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&e({status:o.status,text:function(){return Promise.resolve(o.responseText)}})},o.ontimeout=function(){t(new Error("Request timed out"))},o.onerror=function(){t(new Error("Request failed"))},o.onabort=function(){t(new Error("Request aborted"))},h&&(o.upload.onprogress=h),o.open(n,b,!0),new Headers(i).forEach((function(e,t){o.setRequestHeader(t,e)})),r?o.send(r):o.send()})))];case 1:return 201!==(d=r.sent()).status&&200!==d.status?[3,3]:[4,d.text()];case 2:f=r.sent(),p=JSON.parse(f),o(p),r.label=3;case 3:if(!Object(C.a)(d.status))throw a(d),new Error("Unable to upload file");return[2]}var b,h,v}))}))}}(a,n,c,i,(function(e){u=e}),(function(e){l=e})),f=Object(S.a)(t,d,{sliceSize:n,numberOfSlicesToParallelize:1}),p=f.onCompletePromise,b=f.cancel,h=Object(r.__awaiter)(o,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,p];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{errorResponse:l,result:null}];case 4:switch(e){case 0:return u?[2,{errorResponse:null,result:u}]:[2,{errorResponse:l,result:null}];case 1:throw new Error("Upload was cancelled");default:return[2,Object(s.a)(e)]}return[2]}}))}));return{uploadPromise:h,cancel:function(){return Object(r.__awaiter)(o,void 0,void 0,(function(){return Object(r.__generator)(this,(function(e){switch(e.label){case 0:b(),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,h];case 2:return e.sent(),[3,5];case 3:return[4,E(a)];case 4:return[2,e.sent()];case 5:return[2]}}))}))}}}function x(e,t,n){var r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,fetch(e,{method:"DELETE"})];case 1:return t=n.sent(),Object(C.a)(t.status)?[2,{errorResponse:null,result:null}]:[2,{errorResponse:t,result:null}]}}))}))}var L="https://api.dropboxapi.com/2/files";function R(e,t){switch(e){case 0:return t;case 1:return null;default:Object(s.a)(e)}return null}function N(e){return"file"===e[".tag"]}function D(e){return"folder"===e[".tag"]}function F(e){return"deleted"===e[".tag"]}function M(e){return"folder"===e.type}function U(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return e.path=e.path||"",t=L+"/list_folder",n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},[4,a(t,2,{requestInit:n})];case 1:return(i=r.sent()).ok?[4,i.text()]:[3,3];case 2:return o=r.sent(),[2,{errorResponse:null,result:JSON.parse(o).entries}];case 3:return[2,{errorResponse:i,result:null}]}}))}))}var q,W="https://api.box.com/2.0",B=2e3;function V(e,t){return void 0===t&&(t=B),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(W+"/folders/"+(e=e||"0")+"/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit="+t+"&offset=0",3)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).entries}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}!function(e){e.Uploaded="uploaded",e.Tagged="tagged"}(q||(q={}));var z=q,G="https://graph.facebook.com/v2.7",H=200;function J(e,t){return void 0===t&&(t=H),Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,a(G+"/me/photos/?fields=id,name,images,from,link,album,place,created_time&type="+e.toString()+"&limit="+t,6)];case 1:return(n=r.sent()).ok?[4,n.text()]:[3,3];case 2:return i=r.sent(),[2,{errorResponse:null,result:JSON.parse(i).data}];case 3:return[2,{errorResponse:n,result:null}]}}))}))}var Y=n(626),K=n(627),X=n(431),Q=n(950),Z=n(1031),$=n(484),ee=n(245),te=n(79);function ne(e,t){var n=function(e,t){return Object(K.a)({ParentFolderIds:[Object(X.a)({Id:e})],ItemShape:Object($.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(Y.a)({Header:Object(ee.a)(),Body:n})}function re(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(Z.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),[4,ne(e=e||Object(Q.a)("inbox"),n)];case 1:return i=r.sent(),(o=i.Body.ResponseMessages.Items[0])&&"Success"===o.ResponseClass&&o.RootFolder.Items?[2,{errorResponse:null,result:o.RootFolder.Items}]:(te.g.warn("Find Item Response of get mail messages failed with "+o),[2,{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},result:null}])}}))}))}n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return I})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return k})),n.d(t,"v",(function(){return A})),n.d(t,"i",(function(){return _})),n.d(t,"q",(function(){return w})),n.d(t,"e",(function(){return"https://api.onedrive.com"})),n.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"d",(function(){return i})),n.d(t,"p",(function(){return R})),n.d(t,"t",(function(){return N})),n.d(t,"u",(function(){return D})),n.d(t,"s",(function(){return F})),n.d(t,"j",(function(){return U})),n.d(t,"r",(function(){return M})),n.d(t,"h",(function(){return V})),n.d(t,"a",(function(){return W})),n.d(t,"c",(function(){return z})),n.d(t,"k",(function(){return J})),n.d(t,"n",(function(){return re}))},1490:function(e,t,n){"use strict";var r=n(108),i=[0,1],o=n(1872),a=n(1833),c=n(9),u=n(314),s=n(1055);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(a.a),messageParts:[Object(c.b)(a.a),d()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(o.b),messageParts:[Object(c.b)(o.b),d()],color:s.a.Red};default:return Object(u.a)(e)}}function d(){return{text:Object(c.b)(o.a),action:function(){window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(1428),p=n(1261),b=(n(1260),n(0)),h=n(76),v=n(26);function m(){var e=Object(v.a)();if(Object(h.h)("fwk-devTools")){if(Object(h.h)("doc-attachment-CA-readOnlyAccessIssues"))return Object(b.__assign)(Object(b.__assign)({},e),{AttachmentPolicy:Object(b.__assign)(Object(b.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0})});if(Object(h.h)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object(b.__assign)(Object(b.__assign)({},e),{AttachmentPolicy:Object(b.__assign)(Object(b.__assign)({},e.AttachmentPolicy),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})})}return e}function O(){var e=m().AttachmentPolicy;return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return _})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return f.a})),n.d(t,"d",(function(){return p.a})),n.d(t,"c",(function(){return O})),n.d(t,"f",(function(){return m}));var g=new r.c((function(){return n.e(1176).then(n.bind(null,14450))})),_=new r.b(g,(function(e){return e.getAccessIssuesForAttachments}))},1513:function(e,t,n){"use strict";var r=n(314),i=n(9),o=n(35),a="/owa/",c="service.svc/s/GetFileAttachment?id={0}",u="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",s="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",p="pdfprint.aspx?id={0}&location={1}",b=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var h=n(295),v=n(49),m=n(2),O=n(18),g=n(1328),_=n(114),w=n(240);function j(e,t,n,c,s,d,f,h,v){var m;switch(void 0===s&&(s=0),void 0===d&&(d=0),void 0===f&&(f=!0),void 0===h&&(h=null),void 0===v&&(v=null),n){case 0:m=u;break;case 3:m=p;break;case 1:if(!function(e){if(!e)return!1;var t=null,n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&b.indexOf(t.toLowerCase())>=0}(h))return null;m=l;break;default:Object(r.a)(n)}var g=c?d:s;!g&&s&&(g=s);var _=Object(i.c)("{0}{1}{2}&permissionLevel={3}",a,v,Object(i.c)(m,encodeURIComponent(e.Id),encodeURIComponent(t)),g);f&&(_=_+"&X-OWA-CANARY="+Object(o.a)());return Object(O.a)(_)}function I(e,t,n,u,l){var p;switch(void 0===u&&(u=!1),void 0===l&&(l=!0),n){case 0:p=c;break;case 1:p=s;break;case 2:p=d;break;case 3:p=f;break;default:return Object(r.a)(n)}if(!Object(i.f)(p)){var b=function(e,t,n,r,c){if(void 0===c&&(c=!1),!t||!t.Id)return null;var u=t.mailboxInfo.userIdentity,s=Object(w.n)(u),l=t.mailboxInfo.type===_.a.GroupMailbox,d=s&&!l?Object(_.c)(t.mailboxInfo.mailboxSmtpAddress)+u:e,f=Object(g.b)(t.mailboxInfo),p=null==f?void 0:f.downloadUrlBase,b=Object(i.c)(n,encodeURIComponent(t.Id));if(!p||c&&"Firefox"===Object(v.a)().browser){var j=a+b+"&X-OWA-CANARY="+Object(o.a)();return Object(O.a)(j)}var I="{0}{1}/{2}&owa={3}&scriptVer={4}";Object(h.a)()&&(I+="&isc=1");var y=Object(i.c)(I,p,d,b,window.location.hostname,Object(m.j)()||"unofficial");return r&&(y+="&X-OWA-CANARY="+Object(o.a)(),y+="&token="+(null==f?void 0:f.downloadToken)),y}(e,t,p,l,3===n);return Object(i.c)("{0}{1}{2}",b,u?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return I}))},1514:function(e,t,n){"use strict";var r=n(108),i=n(1915),o=n(1841),a=(n(1392),n(1408)),c=n(1549),u=(n(2466),n(2402),n(1358));var s=n(1811),l=n(1643),d=n(1307);n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return b})),n.d(t,"k",(function(){return h})),n.d(t,"m",(function(){return v})),n.d(t,"b",(function(){return i.a})),n.d(t,"i",(function(){return o.a})),n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b})),n.d(t,"o",(function(){return a.c})),n.d(t,"a",(function(){return c.b})),n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b})),n.d(t,"j",(function(){return s.a})),n.d(t,"c",(function(){return l.a})),n.d(t,"f",(function(){return d.b}));var f=new r.c((function(){return Promise.all([n.e(1),n.e(691),n.e(15),n.e(34),n.e(269)]).then(n.bind(null,14619))})),p=new r.b(f,(function(e){return e.loadProviders})),b=new r.b(f,(function(e){return e.removeFileProvider})),h=new r.b(f,(function(e){return e.addFileProvider})),v=new r.b(f,(function(e){return e.removeAndAddFileProvider}))},1549:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c}));var r,i=n(0);!function(e){e[e.Groups=1e4]="Groups",e[e.Outlook=10001]="Outlook"}(r||(r={}));var o=Object.freeze([1,3,2,6,5,7,8,9]),a=Object.freeze(Object(i.__spread)(o,[0,4,10])),c="Outlook"},1550:function(e,t,n){"use strict";var r=n(1513);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(1328);n.d(t,"c",(function(){return i.a}))},1589:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",(function(e){return{attachmentId:e}}))},1595:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(24),i=n(1286);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},1596:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d}));var r=n(108),i=new r.c((function(){return Promise.all([n.e(1),n.e(5),n.e(19),n.e(698),n.e(325)]).then(n.bind(null,4026))})),o=Object(r.d)(i,(function(e){return e.TextColorPicker})),a=Object(r.d)(i,(function(e){return e.BackColorPicker})),c=Object(r.d)(i,(function(e){return e.FontNamePicker})),u=Object(r.d)(i,(function(e){return e.FontSizePicker})),s=Object(r.d)(i,(function(e){return e.InsertTableCallout})),l=new r.b(i,(function(e){return e.displayInsertLinkDialog})),d=new r.b(i,(function(e){return e.showImageAltTextDialog}))},1628:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r={};function i(e,t){r[e]=t}function o(e){return e in r?r[e]:null}function a(e){r[e]=null}},1629:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(24);function i(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},1634:function(e,t,n){"use strict";var r=n(0),i=n(428),o=n(1061);function a(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,c,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=t||Object(i.a)(),a={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},c=function(t){e(t)&&o.g.importAndExecute(a,c)},[4,o.f.import()];case 1:return r.sent()(a,c),[4,o.b.import()];case 2:return u=r.sent()(),[2,[n,a,c,u]]}}))}))}n.d(t,"a",(function(){return a}))},1639:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(108),i=n(1155);n.d(t,"e",(function(){return i.a})),n.d(t,"b",(function(){return i.b}));var o=n(1467);n.d(t,"d",(function(){return o.a}));var a=n(1283);n.d(t,"c",(function(){return a.a}));var c=new r.c((function(){return n.e(265).then(n.bind(null,2888))})),u=Object(r.d)(c,(function(e){return e.CloudIconWithOverlay}))},1642:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},1643:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(r||(r={}))},1646:function(e,t,n){"use strict";var r=n(314),i=n(114),o=n(1550),a=n(35),c=n(1385);function u(e,t,n,a,u){var s;void 0===u&&(u=!0);var l=t,d=l.AttachmentId,f=l.Name,p=l.OriginalPermissionType,b=l.PermissionType,h=Object(c.a)(t),v=(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)===i.a.GroupMailbox?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return o.b(d,h,n,a,b,p,u,f,v);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:o.b(d,h,1,a,b,p,u,f,v);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n,r){var i;return void 0===n&&(n=!1),void 0===r&&(r=!0),o.a(null===(i=e.mailboxInfo)||void 0===i?void 0:i.routingKey,e,t,n,r)}function l(e,t,n,r,i){void 0===i&&(i=!1);var c=n?u(e,t,1,r,!1):s(e,1,i,!1);if(n)return{url:c,init:{credentials:"include"}};var l=Object(o.c)(e.mailboxInfo),d=new Headers;return d.set("X-Token",l),d.set("X-OWA-CANARY",Object(a.a)()),{url:c,init:{headers:d}}}function d(e,t,n,r,i,o){return void 0===o&&(o=!1),r?u(e,t,n,i):s(e,n,o)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}))},1661:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(26),i=n(295),o=n(314),a=n(76);function c(e){var t=Object(r.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-facebook");case 1:return!!Object(i.a)()||t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(a.h)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(a.h)("doc-fileProvider-wopiClient");default:return Object(o.a)(e)}}},1684:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("REFRESH_EXPIRATION_DATE",(function(e){return{id:e}}))},1685:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},1690:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},1691:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.View=0]="View",e[e.EnteringEdit=1]="EnteringEdit",e[e.Edit=2]="Edit",e[e.Saving=3]="Saving"}(r||(r={}))},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={attachmentTypes:{FILE_ATTACHMENT_TYPE:"FileAttachment:#Exchange",ITEM_ATTACHMENT_TYPE:"ItemAttachment:#Exchange",ITEM_ID_ATTACHMENT_TYPE:"ItemIdAttachment:#Exchange",REFERENCE_ATTACHMENT_TYPE:"ReferenceAttachment:#Exchange"}}},1704:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},1705:function(e,t,n){"use strict";var r;!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(r||(r={})),t.a=r},1737:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},1770:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(0),i=n(314),o=n(1906),a=n(295);var c=Object(o.a)((function(e){switch(e){case 0:return t={supportViewInProvider:!1,supportConvertCloudyToClassic:!1},Object(r.__assign)(Object(r.__assign)({},t),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0});case 1:return function(){var e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object(r.__assign)(Object(r.__assign)({},e),{supportConvertCloudyToClassic:Object(a.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(i.a)(e)}var t})),u=c.getDataProviderInfo,s=c.getDefaultDataProviderInfo;t.a=u},1771:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},1772:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},1782:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(4),i=Object(r.action)("tryProcessSharePointLink",(function(e,t){return{element:e,itemId:t}})),o=Object(r.action)("tryUndoProcessSharePointLink",(function(e){return{elements:e}})),a=Object(r.action)("previewLinkInSxS",(function(e,t){return{wacUrlGetter:e,itemId:t}}))},1785:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a}));var r={};function i(e,t,n){r[e.editorId]={htmlEditor:t,plainTextEditor:n}}function o(e,t,n){var i=r[e.editorId];i&&(i.htmlEditor==t&&(i.htmlEditor=null),i.plainTextEditor==n&&(i.plainTextEditor=null),i.htmlEditor||i.plainTextEditor||delete r[e.editorId])}function a(e,t,n,i){if(e){var o=e.bodyType,a=void 0===o||"HTML"===o,c="Text"===o,u=r[e.editorId]||{},s=u.htmlEditor,l=u.plainTextEditor;a&&t&&(s&&!s.isDisposed()||i)?t(s):c&&n&&(l||i)&&n(l)}}},1811:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1392);function i(){return Object(r.a)().loadState}},1814:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},1815:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(1065),o=n(1078);function a(e,t,n,a,c,u,s){void 0===c&&(c=o.a.Unknown),void 0===u&&(u=!1),void 0===s&&(s=null);var l=Object(i.c)(e,t,a,u,c,s),d=l.strategy;return Object(r.__assign)(Object(r.__assign)({},l),{attachmentType:0,strategy:Object(r.__assign)(Object(r.__assign)({},d),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},1833:function(e){e.exports=JSON.parse('{"a":"Lba"}')},1841:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2572),i=n(2401),o=n(2509),a=n(9),c=n(314);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(a.b)(o.b);case 1:return Object(a.b)(o.a);case 2:case 9:return Object(a.b)(r.b);case 3:case 7:return Object(a.b)(r.a);case 5:return Object(a.b)(r.e);case 6:return Object(a.b)(r.d);case 4:return Object(a.b)(r.f);case 10:return Object(a.b)(i.b);case 8:return Object(a.b)(r.c);default:return Object(c.a)(e)}}},1872:function(e){e.exports=JSON.parse('{"a":"Jba","b":"Kba"}')},1880:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(108),i=new r.c((function(){return n.e(532).then(n.bind(null,2937))})),o=new r.b(i,(function(e){return e.extractFileUrlFromOfficeSharePointLink})),a=new r.b(i,(function(e){return e.isLinkPrefixedWithBaseUrl})),c=new r.b(i,(function(e){return e.isSharePointLink})),u=new r.b(i,(function(e){return e.isSharePointServiceGeneratedLink})),s=new r.b(i,(function(e){return e.isOfficeSharePointLink})),l=new r.b(i,(function(e){return e.getParsedQueryStringFromUrl}))},1882:function(e,t,n){"use strict";var r=n(4),i=n(123),o=Object(r.action)("addCalendarEventsAttachment",(function(e,t){return Object(i.c)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e})}));t.a=o},1906:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1018),o=n(1078),a=[0,1,3,2,6,5,7,8,4];function c(e){var t=null,n=function(n){var i=Object(o.b)(n);return null===i?null:function(){var n,i;if(!t){t={};try{for(var o=Object(r.__values)(a),c=o.next();!c.done;c=o.next()){var u=c.value;t[u]=e(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}return t}()[i]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?i.l:i.m)}}}},1915:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},1921:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=null,i={register:function(e){r=e},run:function(e,t,n){r&&r(e,t,n)}}},1939:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];var n=[];if(0===t){var r=e;r.CanShareInternally&&(n.push(2),n.push(1)),r.CanCreateOrganizationEditLink&&n.push(6),r.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function i(e){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;default:return 0}}function o(e,t,n){var r=i(e);if(0===r)switch(t){case 2:return n?4:3;case 1:return n?6:5;case 5:return n?2:1;default:return 0}return r}var a=n(3138),c=n(9),u="OneDrivePro",s=n(314),l=n(26);function d(e,t){switch(e){case 3:return Object(c.b)(a.b);case 4:return Object(c.b)(a.a);case 6:return Object(c.b)(a.d);case 5:return Object(c.b)(a.e);case 1:return t===u?Object(c.b)(a.g):Object(c.b)(a.b);case 2:return t===u?Object(c.b)(a.f):Object(c.b)(a.a);case 0:return Object(c.b)(a.c);default:return Object(s.a)(e)}}function f(e,t){return 0===t?function(e){var t,n=null===(t=Object(l.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(c.b)(a.i);case 4:return Object(c.b)(a.h);case 6:return Object(c.c)(Object(c.b)(a.j),n);case 5:return Object(c.c)(Object(c.b)(a.k),n);case 1:return Object(c.b)(a.g);case 2:return Object(c.b)(a.f);case 0:return Object(c.b)(a.c);default:return Object(s.a)(e)}}(e):d(e,null)}function p(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return p}))},1940:function(e,t,n){"use strict";var r=n(1270),i=n(977);var o=n(76);function a(e){var t=[];return null==e||e.forEach((function(e){var n,a,c=Object(r.a)(e),u=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(c.permissionLevel),s=Object(o.h)("cmp-fluidPreredeem")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(u)&&(n=c.fileName,a=(Object(i.a)(n)||"").toLowerCase(),!!n&&".fluid"===a);if(1===u||2===u||s){var l={ProviderType:"OneDrivePro",Url:c.url,PermissionType:u};t.push(l)}})),t}n.d(t,"a",(function(){return a}))},1967:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},1986:function(e,t,n){"use strict";n.r(t),n.d(t,"EnteredEditModeEvent",(function(){return r})),n.d(t,"ExitedEditModeEvent",(function(){return i})),n.d(t,"PreviewLoadEvent",(function(){return o})),n.d(t,"PreviewErrorEvent",(function(){return a})),n.d(t,"PreviewLoadOrErrorEvent",(function(){return c})),n.d(t,"CloseEvent",(function(){return u})),n.d(t,"AnimationEndEvent",(function(){return s}));var r="EnteredEditMode",i="ExitedEditMode",o="PreviewLoad",a="PreviewError",c="PreviewLoadOrError",u="Close",s="AnimationEnd"},1990:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2014:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n(108),i=n(1967);n.d(t,"a",(function(){return i.a}));var o=new r.c((function(){return Promise.all([n.e(44),n.e(268)]).then(n.bind(null,3907))})),a=new r.b(o,(function(e){return e.createGetSharingInfoResponse})),c=new r.b(o,(function(e){return e.checkSharingLinkUrlDomain})),u=new r.b(o,(function(e){return e.getLinkProviderType})),s=new r.b(o,(function(e){return e.isOneDriveProRelatedLink})),l=new r.b(o,(function(e){return e.convertToAttachmentDataProviderType})),d=new r.b(o,(function(e){return e.convertToLinkProviderType}))},2059:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function i(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},2063:function(e,t,n){"use strict";var r=n(1),i=r.createContext(window);t.a=i},2065:function(e,t,n){"use strict";var r=n(23),i=n(4),o={sharingLinks:new r.ObservableMap({})},a=Object(i.createStore)("sharingLinkStore",o);t.a=a},2074:function(e,t,n){"use strict";var r=n(0),i=n(76),o=n(9),a=n(2940),c=n(3221),u=n(1484),s=n(3139),l=n(2477);function d(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,l.f.import()];case 1:return(n=r.sent())?[4,n(e.AttachLongPathName)]:[3,3];case 2:t=r.sent(),r.label=3;case 3:return[2,t]}}))}))}var f=n(2628),p=n(3001),b=n(1245),h=n(2678),v=n(1120),m=n(26),O=n(79),g=n(283),_=n(1123);var w=n(1232);t.a=Object(g.action)("addAndInitializeAttachments")((function(e,t,n,l){void 0===n&&(n=!1),void 0===l&&(l=!1);var j=Object(_.a)();n||(e=e.filter((function(e){return!j.attachments.has(e.attachment.AttachmentId.Id)}))),e.map((function(e){var n=e.attachmentId,j=e.attachment,I=e.permissionInfo,y=e.modelInitializationValues,k=function(e,t){var n={id:e,type:Object(w.a)(t),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:t};return 1===n.type?Object(r.__assign)(Object(r.__assign)({},n),{type:1,openUrl:null,originalUrl:null,isFolder:t.AttachmentIsFolder,requiresFetchingSharingInformation:!1}):n}(n,j);return l||function(e,t,n){Object(r.__awaiter)(this,void 0,void 0,(function(){var l,w,j,I,y,k,S;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return l=Object(b.a)(e),w=Object(v.b)(e.model,!0),j=Object(c.a)(w,e.model),e.attachmentClass=j,e.info=Object(a.a)(w,j,e.model,l,l?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(f.a)(e.id,e.model,!0,!0)),l?(e.openUrl=Object(p.a)(e.model,Object(m.a)()),Object(i.h)("doc-unwrap-safelinks")?(I=e,[4,d(e.model)]):[3,2]):[3,3];case 1:I.originalUrl=r.sent(),r.label=2;case 2:n||(y=e.model,(null==(k=Object(u.a)(y.ProviderType))?void 0:k.requiresFetchingSharingInformation)&&!Object(o.f)(y.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)),r.label=3;case 3:return Object(h.a)(e.model)&&(S=e.id.Id,Object(s.a)(e.id,e.model,l).then(Object(g.action)("updateAttachmentThumbnailUrl")((function(e){Object(_.a)().attachments.has(S)&&(Object(_.a)().attachments.get(S).thumbnailImage.url=e)})),(function(e){O.g.warn(e)}))),[2]}}))}))}(k,I,t),function(e,t){t=t||{},Object.keys(t).forEach((function(n){t[n]&&(e[n]=t[n])}))}(k,y||{}),k})).forEach((function(e){j.attachments.set(e.id.Id,e)}))}))},2075:function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(1120),a=n(1071),c=n(314),u=n(1065);function s(e){switch(e){case a.a.Download:return u.a.Download;case a.a.OpenInNewTab:return u.a.OpenInNewTab;case a.a.Preview:return u.a.Preview;case a.a.ImportCalendarEventAttachment:case a.a.ChangePermissions:case a.a.CopyLink:case a.a.SaveToCloud:case a.a.ViewInProvider:case a.a.ConvertClassicToCloudy:case a.a.ConvertCloudyToClassic:case a.a.MoveAttachmentToInline:case a.a.RefreshLink:case a.a.IgnoreExpiration:return null;default:return Object(c.a)(e)}}function l(e){switch(e){case u.a.Download:return a.a.Download;case u.a.OpenInNewTab:return a.a.OpenInNewTab;case u.a.Preview:return a.a.Preview;case u.a.NoAction:return null;default:return Object(c.a)(e)}}var d=n(1770);var f=n(1036),p=n(295),b=n(1490);function h(e,t,n,i,a,c,p,h,m,O,g){var _=Object(u.d)(t,n,i,O);!function(e,t){var n=Object(b.c)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download})):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter((function(e){return e!==u.a.Download&&e!==u.a.Preview})));var r=function(e,t,n){void 0===n&&(n=!1);var r=e.filter((function(e){return-1!==t.indexOf(e)}));return n&&(r=r.filter((function(e,t,n){return n.indexOf(e)===t}))),r}(e.supportedOpenActions.map(l).filter((function(e){return!!e})),t);e.supportedOpenActions=r.map(s)}(_,h);var w,j=function(e){return e.__type===f.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE}(i),I=O&&function(e){return e.__type===f.a.attachmentTypes.LINK_ATTACHMENT_TYPE}(i),y=Object(o.d)(i,j||I,m,g),k=j,S=v(j,I,c),C=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,j||I,m),T=function(e,t,n,r,i){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){var o=Object(d.a)(i);return(null==o?void 0:o.supportConvertCloudyToClassic)||!1}return!1}(e,j,m,p,a),A=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,j,I,m);switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:w=function(e,t,n,i,o,a,c,u){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:i,isViewingInProviderSupported:o,isConvertClassicToCloudySupported:a,isConvertCloudyToClassicSupported:c,isMoveAttachmentToInlineSupported:u,showActionsMenu:!0,supportedMenuActions:[]})}(_,y,j||I,k,S,C,T,A);break;case 1:w=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(_);break;default:w=j?function(e,t,n,i){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:i,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(_,k,S,T):function(e,t,n,i){return Object(r.__assign)(Object(r.__assign)({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(_,y,S,C)}return w.supportedMenuActions=h,w}function v(e,t,n){if(e||t)return!1;var r=Object(p.a)(),o=Object(d.b)(r);return!Object(i.f)(n)&&(r||(null==o?void 0:o.supportViewInProvider))}n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return v}))},2098:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ConversationReadingPane=0]="ConversationReadingPane",e[e.ItemReadingPane=1]="ItemReadingPane"}(r||(r={}))},2133:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected",e[e.SelectedAndPending=3]="SelectedAndPending",e[e.SelectedAndSaving=4]="SelectedAndSaving",e[e.NotSelectedAndSaving=5]="NotSelectedAndSaving",e[e.OtherSaving=6]="OtherSaving",e[e.PendingNavigation=7]="PendingNavigation"}(r||(r={})),t.a=r},2137:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function i(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},2138:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1880),o=n(147),a=n(57);function c(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,i.b.import()];case 1:return t=n.sent(),[2,u(t(e))]}}))}))}function u(e){var t=null;if(!Object(o.b)(null==e?void 0:e.fluid_hint)){var n={fluid_hint:e.fluid_hint};t=Object(a.stringify)(n)}if(!Object(o.b)(null==e?void 0:e.nav)){var r={nav:e.nav};t?t+="&"+Object(a.stringify)(r):t=Object(a.stringify)(r)}return t}},2146:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2148:function(e,t,n){"use strict";var r=n(1395),i=n(0),o=n(1282),a=n(1052);var c=n(2677);function u(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(n){switch(n.label){case 0:return e.strategy.previewMethod!==a.a.Wac?[3,2]:[4,Object(c.a)(e.attachmentId,!1)];case 1:9!==(t=n.sent()).Status&&6!==t.Status||(r=e.strategy).previewMethod===a.a.Wac&&(r.previewMethod=a.a.Unsupported,r.supportedOpenActions=r.supportedOpenActions.filter((function(e){return e!==o.a.Preview}))),n.label=2;case 2:return[2]}var r}))}))}var s=n(1815),l=n(1078),d=n(1288),f=n(2074),p=n(992);function b(e,t,n,i,o,a,c,b,h){void 0===c&&(c=null),void 0===h&&(h=!1),Object(f.a)([{attachmentId:e,attachment:t}],n,o);var v=Object(p.a)(e),m=Object(s.a)(e,n,i,1===v.type,l.a.Unknown,!1,c);if(Object(r.a)(m,v,!1,b,a),h){var O=v.model.ProviderType;Object(d.b)(m.isCloudy,O,v.model.Name)||u(m)}return m}n.d(t,"a",(function(){return b}))},2227:function(e,t,n){"use strict";function r(e,t,n){var r,i=e||((null===(r=null===window||void 0===window?void 0:window.navigator)||void 0===r?void 0:r.userAgent)?window.navigator.userAgent:""),o=-1!==i.indexOf("MSIE")||-1!==i.indexOf("rv:")&&-1!==i.indexOf("Trident"),a=-1===i.indexOf("Edge")&&-1!==i.indexOf("Chrome"),c=-1!==i.indexOf("Firefox"),u=-1!==i.indexOf("Edge");return a?function(e){e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins);try{return e&&"function"==typeof e.namedItem&&(null!==e.namedItem("Chrome PDF Viewer")||null!==e.namedItem("Microsoft Edge PDF Viewer"))}catch(e){return!1}}(n):o?function(e){try{return null!==e("AcroPDF.PDF")}catch(e){return!1}}(t||function(e){return new ActiveXObject(e)}):!c&&!u}n.d(t,"a",(function(){return r}))},2228:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1018),i=n(1484),o=n(1120),a=n(49),c=n(76);function u(e,t,n){var u=e.level!==o.a.Block&&e.directFileAccessEnabled;return u&&t.__type===r.n&&(u=function(e,t){if(e.AttachLongPathName){var n=document.createElement("a");if(n.href=e.AttachLongPathName,(!Object(c.h)("doc-unwrap-safelinks")||Object(a.i)())&&n.host.indexOf(s,0)>0||n.search.indexOf(l,0)>0)return!1}if(r=e.ProviderType,o=Object(i.a)(r),(null==o?void 0:o.supportDownload)&&!e.AttachmentIsFolder)return".fluid"!==t&&!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);var r,o;return!1}(t,n)),u}var s="safelinks.protection.outlook.com",l="b7780972f918485c8cfc32b1ba7438eb"},2235:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function o(e,t){e.addCustomProperty("ErrorInformation",t)}function a(e,t){o(e,t?"Empty response from server":"Null response from server")}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a}))},2248:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n(108),i=n(1782);n.d(t,"f",(function(){return i.a}));var o=new r.c((function(){return n.e(531).then(n.bind(null,3741))})),a=new r.b(o,(function(e){return e.tryProcessSharePointLink})),c=new r.b(o,(function(e){return e.tryUndoProcessSharePointLink})),u=new r.b(o,(function(e){return e.docLinkHadPreviewInfo})),s=new r.b(o,(function(e){return e.forceGetWacInfoOperation})),l=new r.b(o,(function(e){return e.getValidDocLinkPreviewInfo}))},2267:function(e,t,n){"use strict";var r="color",i="bgcolor",o="data-ogsc",a="data-ogac",c="data-ogsb",u="data-ogab";function s(e){return{attrColor:e.getAttribute(r)||null,attrBgColor:e.getAttribute(i)||null,styleColor:e.style.getPropertyValue("color"),styleBgColor:e.style.getPropertyValue("background-color")}}function l(e,t){return e.hasAttribute(t)?e.getAttribute(t)||null:void 0}function d(e){return{attrColor:l(e,a),attrBgColor:l(e,u),styleColor:l(e,o),styleBgColor:l(e,c)}}function f(e,t){void 0!==t.attrColor&&!e.hasAttribute(a)&&e.setAttribute(a,t.attrColor||""),void 0!==t.attrBgColor&&!e.hasAttribute(u)&&e.setAttribute(u,t.attrBgColor||""),void 0!==t.styleColor&&!e.hasAttribute(o)&&e.setAttribute(o,t.styleColor||""),void 0!==t.styleBgColor&&!e.hasAttribute(c)&&e.setAttribute(c,t.styleBgColor||"")}function p(e,t){void 0!==t.attrColor&&(null===t.attrColor?e.removeAttribute(r):e.setAttribute(r,t.attrColor||"")),void 0!==t.attrBgColor&&(null===t.attrBgColor?e.removeAttribute(i):e.setAttribute(i,t.attrBgColor||"")),void 0!==t.styleColor&&e.style.setProperty("color",t.styleColor||""),void 0!==t.styleBgColor&&e.style.setProperty("background-color",t.styleBgColor||"")}var b=n(246);function h(e){var t=e.currentTarget,n=t.getElementsByTagName("*"),r=Object(b.c)();r&&(t.style.backgroundColor="white",t.style.color="black");for(var i=[],o=0;o<n.length;o++){var a=n[o],c=d(a);i.push(s(a)),p(a,c)}window.requestAnimationFrame((function(){r&&(t.style.backgroundColor="",t.style.color="");for(var e=0;e<n.length;e++)p(n[e],i[e])}))}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return h}))},2301:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(967);function i(e){var t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}},2362:function(e,t,n){"use strict";var r=n(108),i=n(1628);n.d(t,"a",(function(){return i.a})),n.d(t,"d",(function(){return i.c}));var o=n(1307);n.d(t,"b",(function(){return o.b}));var a=n(1661);n.d(t,"c",(function(){return a.a}));var c=new r.c((function(){return n.e(267).then(n.bind(null,3744))})),u=new r.a(c,(function(e){return e.addFileProviderAfterAuthFinished}));"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=u);new r.b(c,(function(e){return e.getAddableFileProviderInfo})),new r.b(c,(function(e){return e.addFileProvider})),new r.b(c,(function(e){return e.createAddableFileProviderInfo})),new r.b(c,(function(e){return e.getAuthRedirectPageUrl}))},2365:function(e,t,n){"use strict";var r=n(283);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2401:function(e){e.exports=JSON.parse('{"a":"Qfa","b":"Rfa"}')},2402:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2362);function i(e){return Object(r.c)(e)}},2407:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NoOp=0]="NoOp",e[e.AlwaysHidden=1]="AlwaysHidden",e[e.CopyMailReadingPaneContainer=2]="CopyMailReadingPaneContainer",e[e.LoadConversationReadingPane=3]="LoadConversationReadingPane",e[e.LoadItemReadingPane=4]="LoadItemReadingPane"}(r||(r={}))},2408:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),i=n(296),o=n(630),a=n(553),c=n(484),u=n(631),s=n(245),l=n(79),d="0xe0b",f=Object(i.a)({PropertyTag:d,PropertyType:"Binary"});function p(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o,a,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=null,i=Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:[f]}),[4,b([e],i)];case 1:return o=r.sent(),"Success"===(null===(t=null==o?void 0:o[0])||void 0===t?void 0:t.ResponseClass)&&(a=o[0],u=a.Items[0],n=function(e,t){var n;if(e){var r=e.ExtendedProperty;if(r)for(var i=r.length,o=0;o<i;o++){var a=r[o];if((null===(n=a.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t)return a}}return null}(u,d)),n?[2,n.Value]:(l.g.info("[getImmutableEntryId] extendedProperty could not be retrieved"),[2,null])}}))}))}function b(e,t){var n=Object(s.a)(),r=e.map((function(e){return Object(a.a)({Id:e})}));return Object(u.a)({Header:n,Body:Object(o.a)({ItemShape:t,ItemIds:r})}).then((function(e){var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).catch((function(e){return l.g.warn("GetItem:"+e.message),null}))}},2466:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1549),i="file provider is not addable";function o(e){return r.a.indexOf(e)>-1}},2477:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return c}));var r=n(108),i=n(1366);n.d(t,"b",(function(){return i.b})),n.d(t,"d",(function(){return i.d})),n.d(t,"a",(function(){return i.a})),n.d(t,"c",(function(){return i.c})),n.d(t,"e",(function(){return i.e}));var o=new r.c((function(){return n.e(250).then(n.bind(null,4454))})),a=new r.b(o,(function(e){return e.evaluateSafeLink})),c=(new r.b(o,(function(e){return e.evaluateSafeLinks})),new r.b(o,(function(e){return e.isSafeLink})))},2478:function(e,t,n){"use strict";var r=n(1123),i=n(283);t.a=Object(i.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2479:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2480:function(e,t,n){"use strict";var r=null,i={register:function(e){r=e},available:function(){return!!r},run:function(e,t,n){r&&r(e,t,n)}};t.a=i},2492:function(e,t,n){"use strict";var r=n(556),i=n(2);function o(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+n:e+"?"+t+"="+n}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));var a=Object(i.F)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(r.m)()+"/mail/"+n+t}function u(e){var t=Object(r.m)()+"/mail/AddFileProvider.html",n=encodeURIComponent("provider="+e+"&url="+t);return a+"/ADPRedirect.aspx?"+n}function s(e,t,n,r,i,a){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[],r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}(),c=o(t,"client_id",r);if(c=o(c,"redirect_uri",n),c=o(c,"response_type",i),a){var u=a(e);c=Object.keys(u).reduce((function(e,t){return o(e,t,u[t])}),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2509:function(e){e.exports=JSON.parse('{"b":"Ofa","a":"Pfa"}')},2514:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FileAttachment:#Exchange"},e)}},2572:function(e){e.exports=JSON.parse('{"b":"Ifa","a":"Jfa","e":"Kfa","d":"Lfa","f":"Mfa","c":"Nfa"}')},2582:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("loadItemAttachment",(function(e,t){return{itemAttachmentId:e,perfDatapoint:t}}))},2590:function(e,t,n){"use strict";var r=n(0),i=n(1036),o=n(255),a={},c=5e3,u=12;function s(e,t,n,s,d){var f=new o.a("SaveToCloudProgressManager"),p=setInterval((function(){!function(e,t,n,o,a,c,u){Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return(s=u[e])?(s.counter++,s.counter>c?(l(e,u),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),a&&a(),[2]):[4,i.g.import()]):[2];case 1:return r.sent()(t,n,e,0,(function(e){o&&o(e.NotificationPayloads)})),[2]}}))}))}(n,e,t,s,d,u,a)}),c);a[n]={timer:p,counter:0,datapoint:f}}function l(e,t){void 0===t&&(t=null),t||(t=a);var n=t[e];if(n){clearInterval(n.timer);var r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}}var d=n(4),f=Object(d.action)("cancelSaveAttachmentsToCloud",(function(e){return{operationId:e}}));Object(d.orchestrator)(f,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return l(e.operationId),[2]}))}))}));var p=Object(d.action)("saveAttachmentsToCloud",(function(e,t,n,r,i,o,a,c,u){return{attachmentId:e,itemId:t,notificationHandler:n,serviceCallFailureCallback:r,operationCreatedCallback:i,folderId:o,attachmentIds:a,showProgressBar:c,subscriptionId:u}})),b=n(114);function h(e){return Object(r.__assign)({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}var v=n(24);function m(e,t,n,r,i,o,a){var c,u,s=function(e,t,n,r,i,o,a){return h({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:i,channelId:r,folderItemId:o,attachmentIds:a})}(e,t,n,r,(null==i?void 0:i.type)===b.a.GroupMailbox?i.mailboxSmtpAddress:null,o,a);return c={requestObject:s},u=null==i?void 0:i.requestOptions,void 0===c.requestObject||c.requestObject.__type||(c.requestObject=h(c.requestObject)),Object(v.a)("SaveAttachmentsToCloud",c,u)}var O=n(1634),g=n(1061);Object(d.orchestrator)(p,(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var t,n,i,o,a,c,u,d,f;return Object(r.__generator)(this,(function(p){switch(p.label){case 0:return t=!1!==e.showProgressBar,!(n=e.attachmentId||e.itemId)&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]),i=function(r){if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;var i=e.notificationHandler(r);return t&&i&&(l(n.Id),t=!1),i},o=e.subscriptionId,[4,Object(O.a)(i,o)];case 1:return a=r.__read.apply(void 0,[p.sent(),4]),c=a[0],u=a[1],d=a[2],f=a[3],function(e,t,n,i,o,a,c,u,s){Object(r.__awaiter)(this,void 0,void 0,(function(){var l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,m(e?e.Id:null,t?t.Id:null,n,a,_(t,e,s),u,s?s.map((function(e){return e.Id})):null)];case 1:return[2,r.sent()];case 2:return l=r.sent(),c(l,1,"ServerError"),g.g.importAndExecute(i,o),[2,null];case 3:return[2]}}))}))}(e.attachmentId,e.itemId,c,u,d,f,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&s(e.attachmentId,e.itemId,n.Id,(function(e){e.forEach((function(e){i(e)}))}),(function(){e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout")})),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,u,d),[2]}}))}))}));function _(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}function w(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){var o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return o=function(n){if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;var r=t(n);return r&&l(e.Id),r},[4,Object(O.a)(o,i)];case 1:return r.sent(),s(e,null,e.Id,(function(e){e.forEach((function(e){o(e)}))}),(function(){n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout")})),[2]}}))}))}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return w}))},2611:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1119),i=n(1704),o=n(1690);function a(){return{previewPane:{downloadUrl:null,mode:i.a.Blank},didAutoHideRightPane:!1,hideRightPane:!1,rightPaneSize:0,leftPaneSizePixels:0,rightPaneSizePixels:0,rightPaneDisplay:o.a.Initial,eventManager:new r.a}}},2628:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1018),i=n(1245),o=n(1646);function a(e,t,n,a){if(void 0===a&&(a=!1),Object(i.b)(t))switch(t.ProviderType){case r.c:return function(e){var t=e.AttachLongPathName,n=t.lastIndexOf("?");return t.substring(0,n)+"?dl=1"}(t)}return Object(o.a)(e,t,0,Object(i.b)(t),n,a)}},2638:function(e,t,n){"use strict";var r="OLK_Beautified_",i="olkBeautifulLink",o="true",a=n(3063),c=n(9);function u(e,t,n){return{name:Object(c.b)(a.a),key:"OpenInNewTab",onClick:function(){(t||window).open(e,"_blank"),n&&n()}}}function s(e){var t;return"a"===e.tagName.toLowerCase()&&0===(null===(t=e.id)||void 0===t?void 0:t.indexOf(r))}function l(){return{"fluid-url":d,owaLinkId:d,id:f}}function d(e){return e}function f(e,t,n){return s(t)&&t.setAttribute(i,o),null}n.d(t,"a",(function(){return"owa-attachment-remove-on-send-end"})),n.d(t,"b",(function(){return"owa-attachment-remove-on-send-start"})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return"OWA"})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return s}))},2639:function(e,t,n){"use strict";var r=n(0),i=n(431),o=n(24);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(r.__assign)({__type:"ImportCalendarEventJsonRequest:#Exchange"},n)),Object(o.a)("ImportCalendarEvent",e,t)}var c=n(1020),u=n(245),s=n(315);function l(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,d;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return o?[4,Object(s.e)(o)]:[3,2];case 1:d=f.sent(),l={headers:d.headers,authNeededOnUnAuthorized:d.authNeededOnUnAuthorized},f.label=2;case 2:return[2,a({Header:Object(u.a)(),Body:(p={Content:e,ImportedItemFolderId:Object(c.a)({BaseFolderId:Object(i.a)({Id:t})}),AttachmentId:n},Object(r.__assign)({__type:"ImportCalendarEventRequest:#Exchange"},p))},Object(r.__assign)({datapoint:{jsonCustomData:function(e){return{status:e.ResponseClass,numberOfEventsImported:e.NumberOfEventsImported}}}},l)).then((function(e){if(null!=e&&null!=e.Body)return e.Body;throw new Error("[importCalendarOperation failed]")}))]}var p}))}))}n.d(t,"a",(function(){return l}))},2677:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),i=n(255),o=n(2235),a=n(2736),c={},u={},s=[],l=0,d=2;function f(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function(){var a,c;return Object(r.__generator)(this,(function(u){return a=new i.a("InitializeWacUrl"),n&&a.addCustomProperty("actionSource",n),(c=b(e,t,a))?[2,c]:[2,new Promise((function(i,c){var u={attachmentId:e,isEdit:t,actionSource:n,datapoint:a,resolve:i,reject:c};o?p(u):(s.push(u),function e(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:if(!s.length)return[2];if(l>=d)return[2];t=s.shift(),l++,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,p(t)];case 2:return n.sent(),[3,4];case 3:return l--,e(),[7];case 4:return[2]}}))}))}())}))]}))}))}function p(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,s,l,d,f,p,h,v,m;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(i=e.attachmentId,s=e.isEdit,l=e.actionSource,d=e.datapoint,f=e.resolve,p=e.reject,h=b(i,s,d))return f(h),[2];d.addCustomProperty("ReturnFromCache",!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(a.a)(i.Id,s,null,null===(t=i.mailboxInfo)||void 0===t?void 0:t.requestOptions,l)];case 2:return 0===(v=r.sent()).Status&&((s?u:c)[i.Id]={expireTime:(new Date).getTime()+36e5,value:v}),v.WacUrl||d.addCustomProperty("WacUrlIsEmpty",!0),d.addCustomProperty("WacAttachmentResponseStatus",null===(n=v.Status)||void 0===n?void 0:n.toString()),d.end(),f(v),[3,4];case 3:return m=r.sent(),Object(o.a)(m)&&Object(o.c)(d,m.response),Object(o.d)(d,m.toString()),d.endWithError("ServerError"),p(m),[3,4];case 4:return[2]}}))}))}function b(e,t,n){var r=t?u:c,i=r[e.Id];if(i){if(i.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),i.value;delete r[e.Id]}return null}},2678:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1484),i=n(1325),o=n(1120),a=n(967),c=n(1018);function u(e){if(!Object(o.b)(e,!0).directFileAccessEnabled&&!e.IsInline||Object(i.b)(e.AttachmentId.Id))return!1;if(e.Thumbnail)return!0;var t=Object(a.g)(e.Name,e.ContentType,!1),n=Object(a.h)(e.Name);if((e.__type===c.e||e.__type===c.h)&&(t||n))return!0;if(e.__type===c.n){var u=e,s=Object(r.a)(u.ProviderType);if(u.AttachmentThumbnailUrl||t&&s&&s.supportImageThumbnail)return!0}return!1}},2736:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1629);function i(e,t,n,i,o){if(o){var a="getWacAttachmentInfo"+o;(i=i||{}).headers=i.headers||new Headers,i.headers.set("X-OWA-ActionName",a)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},i)}},2737:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(1489),o=n(3e3);function a(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(o.a)(e.AttachLongPathName),[4,Object(i.l)(n)];case 1:return a=r.sent(),[2,(null===(t=a.result)||void 0===t?void 0:t.thumbnailLink)||null]}}))}))}},2742:function(e,t,n){"use strict";var r=n(0),i=n(255),o=n(147),a=n(1228),c=n(1229);function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,l,d;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(3),i=t?"folders":"files",u=Object(o.a)(n.create_shared_link_request.requestUrlFormat,i,e),[4,Object(c.a)(n.providerType,u,null,n.create_shared_link_request.method,JSON.stringify(n.create_shared_link_request.body),null,n.create_shared_link_request.dataPointName)];case 1:return s=r.sent(),l=JSON.parse(s),d={webUrl:l.shared_link.url,type:O,scope:_},[2,{expirationDateTime:null,shareId:l.id,link:d}]}}))}))}function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.create_shared_link_request.body).path=e,[4,Object(c.a)(t.providerType,t.create_shared_link_request.requestUrlFormat,null,t.create_shared_link_request.method,JSON.stringify(n),null,t.create_shared_link_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function l(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.get_shared_link_request.body).path=e,[4,Object(c.a)(t.providerType,t.get_shared_link_request.requestUrlFormat,null,t.get_shared_link_request.method,JSON.stringify(n),null,t.get_shared_link_request.dataPointName)];case 1:return i=r.sent(),(o=JSON.parse(i).links[0])?[3,3]:[4,s(e)];case 2:o=r.sent(),r.label=3;case 3:return u={webUrl:o.url,type:O,scope:_},[2,{expirationDateTime:null,shareId:o.id,link:u}]}}))}))}function d(e){var t=function(e){var t=e.match(/\/d\/(.+)\//gm);return!t||t.length>1?"":t[0].substring(3).replace("/","")}(e);return Object(o.b)(t)&&(t=function(e){var t=e.match(/\/folders\/(.+)$/gm);return!t||t.length>1?"":t[0].substring(9)}(e)),t}function f(e){var t,n;if(e)try{for(var i=Object(r.__values)(e),o=i.next();!o.done;o=i.next()){var a=o.value;if("anyoneWithLink"===a.id)return a.role}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return null}function p(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(5),n=Object(o.a)(t.get_file_info_request.requestUrlFormat,e),[4,Object(c.a)(t.providerType,n,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function b(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,p(d(e))];case 1:return(t=r.sent())&&t.permissionIds&&-1!==t.permissionIds.indexOf("anyoneWithLink")?(n=null,i=0,"reader"===(o=f(t.permissions))?(n=O,i=4):"writer"===o&&(n=g,i=5),[2,{ResultCode:0,FileName:t.name,MimeType:"application/vnd.google-apps.folder"===t.mimeType?j:t.mimeType,SharingLinkKind:i,BlocksDownload:t.capabilities.canDownload,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:null,OriginalUrl:null,Type:n,providerFileId:t.id}]):[2,null]}}))}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(5),n=Object(o.a)(t.get_file_info_request.requestUrlFormat,e),[4,Object(c.a)(t.providerType,n,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),u=JSON.parse(i),s={webUrl:u.webViewLink,type:null,scope:_},(null==u?void 0:u.permissions)&&("reader"!==(l=f(u.permissions))&&"writer"!==l||(s.type="reader"===l?O:g)),[2,{expirationDateTime:null,shareId:u.id,link:s}]}}))}))}function v(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,h(e)];case 1:return null!=(t=r.sent()).link.type?[3,3]:(n=Object(a.a)(5),i=Object(o.a)(n.create_shared_link_request.requestUrlFormat,e),(u=n.create_shared_link_request.body).role="reader",[4,Object(c.a)(n.providerType,i,null,n.create_shared_link_request.method,JSON.stringify(u),null,n.create_shared_link_request.dataPointName)]);case 2:s=r.sent(),(l=JSON.parse(s))&&"reader"===l.role&&(t.link.type=O),r.label=3;case 3:return[2,t]}}))}))}var m=n(967),O="view",g="edit",_="anonymous",w="0001-01-01T00:00:00Z",j="text/directory";function I(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(1),i=Object(o.a)(n.create_shared_link_request.requestUrlFormat,e),u=!Object(m.g)(t),(s=n.change_link_permission_request.body).type=u?g:O,[4,Object(c.a)(n.providerType,i,null,n.create_shared_link_request.method,JSON.stringify(s),null,n.create_shared_link_request.dataPointName)];case 1:return l=r.sent(),[2,JSON.parse(l)]}}))}))}var y=n(1147),k=n(288);function S(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(a.a)(0),null===(i=Object(k.parse)(e).hostname)&&t&&(i=Object(k.parse)(t).hostname,e="https://"+i+e),u=Object(o.a)(n.create_shared_link_request.requestUrlFormat,i,Object(y.g)(e)),[4,Object(c.a)(n.providerType,u,n.create_shared_link_request.additional_headers,n.create_shared_link_request.method,null,e,n.create_shared_link_request.dataPointName)];case 1:return s=r.sent(),[2,JSON.parse(s).value[0]]}}))}))}function C(e,t,n,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function(){var s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(Object(o.b)(n))throw new Error("CreateSharingLinkFromFileProvider should have valid location.");switch(s=null,e){case 1:return[3,1];case 0:return[3,3];case 2:return[3,5];case 3:return[3,7];case 5:return[3,9]}return[3,11];case 1:return[4,I(t,n)];case 2:return s=r.sent(),[3,12];case 3:return[4,S(n,c)];case 4:return s=r.sent(),[3,12];case 5:return[4,l(n)];case 6:return s=r.sent(),[3,12];case 7:return[4,u(t,a)];case 8:return s=r.sent(),[3,12];case 9:return[4,v(t)];case 10:return s=r.sent(),[3,12];case 11:throw new Error("File provider "+e+" is not supported.");case 12:return s.expirationDateTime&&Object(i.o)("expiration time found",[s.expirationDateTime]),[2,s]}}))}))}function T(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(3),n=t.get_file_info_request.requestUrlFormat,(i=JSON.parse(JSON.stringify(t.get_file_info_request.additional_headers))).BoxApi=Object(o.a)(i.BoxApi,e),[4,Object(c.a)(t.providerType,n,i,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return u=r.sent(),[2,{ResultCode:0,FileName:(s=JSON.parse(u)).name,MimeType:"folder"===s.type?j:null,SharingLinkKind:4,BlocksDownload:!s.shared_link.permissions.can_download,CanShareExternally:!0,ExpirationDate:null,OriginalUrl:null,Type:O,providerFileId:s.id,location:e}]}}))}))}function A(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(2),(n=t.get_file_info_request.body).url=e,[4,Object(c.a)(t.providerType,t.get_file_info_request.requestUrlFormat,null,t.get_file_info_request.method,JSON.stringify(n),null,t.get_file_info_request.dataPointName)];case 1:return i=r.sent(),[2,{ResultCode:0,FileName:(o=JSON.parse(i)).name,MimeType:"folder"===o[".tag"]?j:null,SharingLinkKind:4,BlocksDownload:!o.link_permissions.allow_download,CanShareExternally:!0,ExpirationDate:null,OriginalUrl:null,Type:O,providerFileId:o.id,location:e}]}}))}))}var P=n(79);function x(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(0),n=Object(k.parse)(e),i=Object(o.a)(t.get_file_info_request.requestUrlFormat,n.hostname,Object(y.g)(e)),[4,Object(c.a)(t.providerType,i,null,t.get_file_info_request.method,null,null,t.get_file_info_request.dataPointName)];case 1:return u=r.sent(),P.g.info(u),[2,null]}}))}))}function E(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(1),n=Object(o.a)(t.get_drive_item_request.requestUrlFormat,Object(y.g)(e)),[4,Object(c.a)(t.providerType,n,null,t.get_drive_item_request.method,null,null,t.get_drive_item_request.dataPointName)];case 1:return i=r.sent(),[2,JSON.parse(i)]}}))}))}function L(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i,u;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(a.a)(1),n=Object(o.a)(t.get_file_permission_request.requestUrlFormat,Object(y.g)(e)),[4,Object(c.a)(t.providerType,n,null,t.get_file_permission_request.method,null,null,t.get_file_permission_request.dataPointName)];case 1:if(i=r.sent(),JSON.parse(i).value.forEach((function(t){var n,r;(null===(n=t.link)||void 0===n?void 0:n.webUrl)&&0===e.indexOf(null===(r=t.link)||void 0===r?void 0:r.webUrl)&&(u=t)})),!u)throw new Error("GetODCSharingInfo failed to find the matching link");return[2,u]}}))}))}function R(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,E(e)];case 1:return t=r.sent(),[4,L(e)];case 2:return n=r.sent(),i=n.link.type===g?5:4,[2,{ResultCode:0,FileName:t.name,MimeType:t.file?t.file.mimeType:j,SharingLinkKind:i,BlocksDownload:!1,CanShareExternally:!0,CanCreateAnonymousEditLink:!0,CanCreateAnonymousViewLink:!0,ExpirationDate:n.expirationDateTime===w?null:n.expirationDateTime,OriginalUrl:null,Type:n.link.type,providerFileId:t.id,location:e}]}}))}))}function N(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){switch(t){case 0:return[2,x(e)];case 1:return[2,R(e)];case 2:return[2,A(e)];case 3:return[2,T(e)];case 5:return[2,b(e)];default:throw new Error("getFileInfo is not supported for "+t+".")}return[2]}))}))}function D(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t){case 4:case 3:break;default:throw new Error("We do not support this permission level for GDrive: "+t)}return n=d(e),i=Object(a.a)(5),u=Object(o.a)(i.change_link_permission_request.requestUrlFormat,n,"anyoneWithLink"),s=i.change_link_permission_request.body,l=4===t?"writer":"reader",s.role=l,[4,Object(c.a)(i.providerType,u,null,i.change_link_permission_request.method,JSON.stringify(s),null,i.change_link_permission_request.dataPointName)];case 1:return r.sent(),[2]}}))}))}function F(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,u,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:switch(t){case 4:case 3:break;default:throw new Error("OneDriveConsumer does not support this permission level: "+t)}return n=Object(a.a)(1),i=Object(o.a)(n.change_link_permission_request.requestUrlFormat,Object(y.g)(e)),(u=n.change_link_permission_request.body).type=4===t?g:O,[4,Object(c.a)(n.providerType,i,null,n.change_link_permission_request.method,JSON.stringify(u),null,n.change_link_permission_request.dataPointName)];case 1:return s=r.sent(),[2,JSON.parse(s)]}}))}))}function M(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){switch(r.label){case 0:if(Object(o.b)(t))throw new Error("CreateSharingLinkFromFileProvider should have valid location.");return 1!==e?[3,2]:[4,F(t,n)];case 1:return[2,r.sent()];case 2:return 5!==e?[3,4]:[4,D(t,n)];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))}n(2995);n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return N})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return"organization"})),n.d(t,"c",(function(){return"user"})),n.d(t,"g",(function(){return w})),n.d(t,"f",(function(){return j})),n.d(t,"h",(function(){return M}))},280:function(e,t,n){"use strict";var r=n(560);n.d(t,"a",(function(){return r.a}))},2817:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f}));var r=n(108),i=n(1128);n.d(t,"a",(function(){return i.c}));var o=n(2480);n.d(t,"c",(function(){return o.a}));var a=n(2407);n.d(t,"b",(function(){return a.a}));var c=n(2582);n.d(t,"h",(function(){return c.a}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(15),n.e(40),n.e(69),n.e(134)]).then(n.bind(null,5010))})),s=new r.a(u,(function(e){return e.previewAttachment})),l=new r.a(u,(function(e){return e.previewAttachmentInSxS})),d=new r.a(u,(function(e){return e.previewImageInSxS})),f=new r.a(u,(function(e){return e.previewLinkInSxS}))},2818:function(e,t,n){"use strict";var r=n(992),i=n(2628),o=n(283);t.a=Object(o.action)("refreshDownloadUrl")((function(e,t,n){void 0===n&&(n=!1);var o=Object(r.a)(e),a=Object(i.a)(e,o.model,t,n);o.download.url=a}))},2830:function(e,t,n){"use strict";function r(e,t,n,r,i,o){var a=!1;return{task:function(){return new Promise((function(c,u){for(var s=0,l=0,d=0,f=function(){var p,b,h,v,m;a&&c(1),s<n&&d<t.length&&((p=d,b=t[p],h=b.start,v=b.end,m=e.slice(h,v),r(m,o(p),i)).then((function(){return s-=1,(l+=1)===t.length&&c(0),void f()})).catch(u),d+=1,s+=1)},p=0;p<n;p++)f()}))},cancelTask:function(){return a=!0}}}var i=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function o(e,t,n){void 0===n&&(n=i),function(e){e.sliceSize=e.sliceSize||i.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||i.numberOfSlicesToParallelize}(n);var o=n.sliceSize,u=n.numberOfSlicesToParallelize,s=Math.ceil(e.size/o),l=function(e,t,n){for(var r=[],i=0,o=0;o<e;o++){var a=Math.min(i+t,n);r.push({start:i,end:a}),i=a}return r}(s,o,e.size),d=r(e,[l[0]],1,t,s,(function(){return 0})),f=l.length>2?r(e,l.slice(1,l.length-1),u,t,s,(function(e){return e+1})):c(),p=l.length>1?r(e,[l[l.length-1]],1,t,s,(function(){return l.length-1})):c();return{onCompletePromise:d.task().then(a(f.task)).then(a(p.task)),cancel:function(){d.cancelTask(),f.cancelTask(),p.cancelTask()}}}function a(e){return function(t){return 0===t?e():Promise.resolve(t)}}function c(){var e=!1;return{task:function(){return e?Promise.resolve(1):Promise.resolve(0)},cancelTask:function(){return e=!0}}}n.d(t,"a",(function(){return o}))},2876:function(e,t,n){"use strict";var r=n(992),i=n(283);t.a=Object(i.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},2940:function(e,t,n){"use strict";var r=n(1939),i=n(967),o=n(7),a=n(76);var c=n(2228),u=n(1484);function s(e,t,n,s,l,d){if(void 0===d&&(d=null),1===t)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};var f,p=Object(i.b)(n.Name),b=Object(c.a)(e,n,p),h=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;var r=Object(u.a)(t);return null==r?void 0:r.supportedPermissionLevels}(s,l,Object(r.a)(d,0)),v=(f=d)&&0===f.ResultCode?(Object(a.h)("doc-attachment-referenceAttachmentExpiration")||(f.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:f.BlocksDownload,canonicalUrl:f.CanonicalUrl,canShareInternally:f.CanShareInternally,canShareExternally:f.CanShareExternally,expirationDate:f.ExpirationDate?Object(o.lc)(f.ExpirationDate):null,canRefresh:!1,shareId:f.ShareId,siteUrl:f.SiteUrl,linkType:f.Type}):null;return s?function(e,t,n){return{allowDownload:e,supportedPermissionLevels:t,sharingInfo:n}}(b,h,v):function(e){return{allowDownload:e,supportedPermissionLevels:null,sharingInfo:null}}(b)}n.d(t,"a",(function(){return s}))},2995:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),i=n(1147),o=n(147),a=n(288),c=n(1228),u=n(1229);function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,n,s,l;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(c.a)(0),n=Object(a.parse)(e),s=Object(o.a)(t.get_shared_item_request.requestUrlFormat,n.hostname,Object(i.g)(e)),[4,Object(u.a)(t.providerType,s,t.get_shared_item_request.additional_headers,t.get_shared_item_request.method,null,null,t.get_shared_item_request.dataPointName)];case 1:return l=r.sent(),[2,JSON.parse(l)]}}))}))}},3e3:function(e,t,n){"use strict";function r(e){var t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},3001:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(9),i=n(1018),o=n(1939);function a(e){return Object(r.f)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function c(e,t){var n=e.AttachLongPathName;if(Object(o.f)(e.PermissionType)||e.ProviderType!==i.m)return n;var r=t.ApplicationSettings;if(null!==n&&null!==r){var c=void 0;null!==(c=a(r.VDirIsPublicProperty||t.PublicComputersDetectionEnabled&&t.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL))&&(n=function(e,t){var n,r,i,o=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),a=o.exec(e),c=o.exec(t);return a&&c&&a.length>=5&&c.length>=5&&(c[1]&&c[2]&&(i=c[1]+"://"+c[2],n=!0),c[3]&&(i+=c[3]),a[4]&&(r=!0,i+=a[4])),n&&r?i:null}(n,c))}return null!==n?n:e.AttachLongPathName}},3063:function(e){e.exports=JSON.parse('{"a":"Eta"}')},3138:function(e){e.exports=JSON.parse('{"b":"yba","a":"zba","d":"Aba","e":"Bba","g":"Cba","f":"Dba","c":"Eba","i":"Fba","h":"Gba","j":"Hba","k":"Iba"}')},3139:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(1018),o=n(2737),a=n(1646);function c(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var c;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n?(c=t).ProviderType===i.f&&c.AttachLongPathName?[4,Object(o.a)(c)]:[3,2]:[2,Object(a.a)(e,t,2,n,!0)];case 1:return[2,r.sent()];case 2:return[2,c.AttachmentThumbnailUrl||null]}}))}))}},3221:function(e,t,n){"use strict";var r=n(1018),i=n(1484),o=n(967);function a(e){var t=Object(o.b)(e.Name);return t&&".pdf"===t.toLowerCase()}var c=[".mp3"];var u=[".ics",".ical",".ifb",".icalendar"];var s=[".eml",".msg"];var l=n(2059),d=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(o.g)(e.Name)||e.__type!==r.n&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var p=n(2227),b=n(1120);function h(e,t){if(a(e)&&Object(p.a)()){if(t)return!0;var n=Object(b.c)(e,!0);return Object(b.b)(e,!0).directFileAccessEnabled&&n.directFileAccessEnabled}return!1}var v=[".txt",".xml",".log"];var m=[".mp4"],O=[".mov"];var g=n(295);function _(e,t){var n;t.__type===r.a.attachmentTypes.REFERENCE_ATTACHMENT_TYPE||t.__type===r.a.attachmentTypes.LINK_ATTACHMENT_TYPE?n=function(e){var t=Object(i.a)(e.ProviderType);return t&&t.supportPreview(e,Object(g.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(l.a)(t)?6:h(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0:n=t.__type===r.a.attachmentTypes.FILE_ATTACHMENT_TYPE?e.level===b.a.Block?1:e.level===b.a.AccessDisabled?0:f(t)?2:a(t)?function(e,t){if(!Object(b.e)().isPdfPreviewEnabled())return 1;if(h(t,!1))return 3;if(function(e){return a(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){var t=Object(o.b)(e.Name);return!!t&&c.indexOf(t.toLowerCase())>=0}(t)?5:function(e){var t=Object(o.b)(e.Name);return!!t&&s.indexOf(t.toLowerCase())>=0}(t)?10:function(e){var t=Object(o.b)(e.Name);return!!t&&v.indexOf(t.toLowerCase())>=0}(t)?11:function(e,t){var n,r=Object(o.b)(e.Name);if(r){var i=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),a=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome");return m.indexOf(r.toLowerCase())>=0||a&&O.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){var t=Object(o.b)(e.Name);return!!t&&-1!==u.indexOf(t.toLowerCase())}(t)?13:0:t.__type===r.a.attachmentTypes.ITEM_ATTACHMENT_TYPE?8:t.__type===r.a.attachmentTypes.ITEM_ID_ATTACHMENT_TYPE?9:0;return n}n.d(t,"a",(function(){return _}))},3365:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("SET_IS_CONTEXT_MENU_OPEN",(function(e,t){return{linkId:e,value:t}})),o=Object(r.action)("RESET_IS_CONTEXT_MENU_OPEN_FOR_LINKS",(function(){return{}})),a=Object(r.action)("UPDATE_COMPOSE_LINK_VIEW_STATE",(function(e,t,n){return{linkId:e,displayName:t,isLinkBeautified:n}})),c=Object(r.action)("REMOVE_COMPOSE_LINK_VIEW_STATE",(function(e){return{linkId:e}})),u=Object(r.action)("ADD_COMPOSE_LINK_VIEW_STATE",(function(e){return{linkId:e}})),s=Object(r.action)("REMOVE_ALL_COMPOSE_LINK_VIEW_STATES"),l=Object(r.action)("PREVIEW_SP_DOC_LINK_IN_SXS",(function(e,t,n,r,i){return{wacUrlGetter:e,linkId:t,readOnly:n,targetWindow:r,sxsId:i}})),d=Object(r.action)("onLinkSelectionChange",(function(e,t){return{selectedLinkId:e,isSelectedLinkReadOnly:t}})),f={composeLinks:new(n(23).ObservableMap)({}),selectedLinkId:null,isSelectedLinkReadOnly:null},p=Object(r.createStore)("composeLinkViewStore",f),b=n(1103);function h(e){var t=p();return e=Object(b.i)(e),t.composeLinks.get(e)}Object(r.mutator)(u,(function(e){var t=p(),n=Object(b.i)(e.linkId),r={linkId:n,isContextMenuOpen:!1,isLinkBeautified:!1,displayName:null};t.composeLinks.set(n,r)})),Object(r.mutator)(c,(function(e){var t=p(),n=Object(b.i)(e.linkId);t.composeLinks.delete(n)})),Object(r.mutator)(s,(function(e){p().composeLinks.clear()})),Object(r.mutator)(a,(function(e){var t=h(e.linkId);t&&(t.displayName=e.displayName)})),Object(r.mutator)(b.G,(function(e){var t=h(e.linkId);t&&!t.isLinkBeautified&&t.displayName===e.oldLinkUrl&&(t.displayName=e.newLinkUrl)})),Object(r.mutator)(i,(function(e){h(e.linkId).isContextMenuOpen=e.value})),Object(r.mutator)(o,(function(e){p().composeLinks.forEach((function(e){return e.isContextMenuOpen=!1}))})),Object(r.mutator)(a,(function(e){h(e.linkId).isLinkBeautified=e.isLinkBeautified})),Object(r.mutator)(d,(function(e){var t=p(),n=e.selectedLinkId,r=e.isSelectedLinkReadOnly;t.selectedLinkId=n,t.isSelectedLinkReadOnly=r}));var v=n(243);Object(r.orchestrator)(b.g,(function(e){var t=(e.targetWindow||window).document.getElementById(e.linkId);t&&(v.unmountComponentAtNode(t),t.remove(),c(e.linkId))}));var m="LinkContextMenu",O="style",g=";",_="rgb(58, 58, 58)",w="background-color: rgb(58, 58, 58) !important;",j=n(1);function I(e){var t=j.useRef();j.useEffect((function(){var e=t.current;v.unmountComponentAtNode(e),e.outerHTML=n()}),[]);var n=function(){return"\x3c!--"+e.text+"--\x3e"};return j.createElement("div",{ref:t})}var y=n(904),k=n(339),S=n(5795);function C(e){return j.createElement(y.a,{className:S.linkSpinner,size:k.a.xSmall})}function T(e){v.render(j.createElement(j.StrictMode,null,j.createElement(C,null)),e)}var A,P=n(0),x=n(42),E=n(550),L=n(100),R=n(255),N=n(314),D=n(2638),F=n(2248),M=n(76),U=n(1407);!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected"}(A||(A={}));var q,W=A,B=n(1288),V=n(9),z=n(4818);!function(e){e.contextMenu="contextMenu",e.sharingTip="sharingTip"}(q||(q={}));var G=n(967),H=n(2742),J=n(26);function Y(e){var t;if(!Object(J.a)().AttachmentPolicy.ClassicAttachmentsEnabled||e.sharingInfo.blocksDownload)return!1;var n=e.mimeType;return(!n||"application/onenote"!==n&&n!==H.f)&&((null===(t=e.sharingInfo)||void 0===t||!t.blocksDownload)&&".fluid"!==(Object(G.b)(e.fileName)||"").toLowerCase())}var K=n(1514),X=n(147),Q=n(79);function Z(e,t){var n=Object(b.l)(e),r=function(e,t){for(var n=0;n<e.length;n++)if(e[n].type===t)return e[n].model.Id;return Q.d("createAttachmentFromLink: Could not get "+t.toString()+" provider ID. File will not upload."),""}(Object(K.h)(),n.providerType);Object(X.b)(r)||Object(b.e)(e,r,!1,t)}var $=["OneDrivePro","OneDriveConsumer","Dropbox","Box","Mailbox","GDrive","Facebook","WopiBox","WopiEgnyte","WopiDropbox","MailMessage"];var ee=n(1939),te=n(4288);function ne(e,t,n,r){var i=[];return e.supportedPermissionLevels&&e.supportedPermissionLevels.forEach((function(o){if(1!==o&&2!==o){var a=Object(ee.e)(o,e.providerType);i.push({text:a,key:a,title:a,onClick:function(){Object(R.o)("AttachmentLinkViewChangePermission"),function(e,t,n,r,i){Object(P.__awaiter)(this,void 0,void 0,(function(){var o,a,c;return Object(P.__generator)(this,(function(u){return e===t.permissionLevel?[2]:(o=function(e,t){if(0!==t.providerType)return null;switch(e){case 6:return t.sharingUrls.organizationEditLink;case 5:return t.sharingUrls.organizationViewLink;case 2:case 1:case 0:return t.sharingInfo.canonicalUrl;default:return null}}(e,t),a=null,0===t.providerType&&(c=t.sharingInfo,a=c.canonicalUrl),Object(b.f)(t.linkId,o,t.url,a,e,t.providerType,n,r,i),[2])}))}))}(o,e,t,n,r),Ye()},isChecked:o===e.permissionLevel,canCheck:!0})}})),i.length>0?{items:i,className:te.fixWidthContextMenu,directionalHintFixed:!0}:null}var re=n(306);var ie=n(5270);function oe(e,t,n,r,i,o,a){return Object(P.__awaiter)(this,void 0,void 0,(function(){var c,u,s;return Object(P.__generator)(this,(function(l){switch(l.label){case 0:return Ye(),[4,ie.a.import()];case 1:return c=l.sent(),u=e.canonicalUrl,s=e.siteUrl,c(s,u,e.shareId,n,o).then((function(n){var o=n.shareId!==e.shareId;Object(b.E)(t,n),o?Object(b.z)(t,i,r,a):Object(R.o)("LinkUnchangedFromSharingDialog",{hasResponse:!0})})).catch((function(e){Object(R.o)("LinkUnchangedFromSharingDialog",{hasResponse:!1})})),[2]}}))}))}var ae=n(4289),ce=n(479);var ue=n(4819),se=n(3870),le=n(3871),de=n(60);function fe(e,t){return Object(V.f)(e.href)?null:{name:Object(V.b)(ue.a),key:"CopyLink",onClick:function(){!function(e,t){var n=Object(de.k)()?Object(V.b)(le.a):Object(V.b)(se.a);(t||window).prompt(n,e)}(e.href,t),Object(R.o)("AttachmentLinkViewCopyLink")}}}var pe=n(233);function be(e){return{key:e,itemType:pe.a.Divider}}var he=n(5799);function ve(e){var t="";if(null==e||"I"===e.nodeName)return"";if("#text"===e.nodeName)return e.textContent.trim();for(var n=0;n<e.childNodes.length;n++)t+=ve(e.childNodes[n]);return t}var me=n(991),Oe=n(1596);function ge(e,t,n,r){var i=Object(b.l)(e.linkId),o=(Object(G.b)(i.fileName)||"").toLowerCase();return e.isLinkBeautified&&".fluid"!==o?(Oe.f.import(),{name:Object(V.b)(he.a),key:"EditLink",onClick:function(){Object(R.o)("AttachmentLinkViewEditLink"),function(e,t,n){Object(P.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return Object(P.__generator)(this,(function(c){switch(c.label){case 0:return r=ve(e),i={LinkUrl:e.href,DisplayText:r,HasChanged:!1},[4,Oe.f.import()];case 1:return o=c.sent(),a=n||window,[4,o(i,a)];case 2:if(c.sent()===me.a.ok&&i.HasChanged){if(i.LinkUrl===e.href&&Object(X.b)(i.DisplayText))return[2];t(i.LinkUrl,i.DisplayText.length>0?i.DisplayText:null)}return[2]}}))}))}(t,n,r)}}):null}var _e=n(4820);function we(e,t,n,r,i){return n?null:{name:Object(V.b)(_e.a),key:"Preview",onClick:function(){!function(e,t,n,r){Object(P.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(P.__generator)(this,(function(a){switch(a.label){case 0:return Object(R.o)("PreviewLinkInSxS"),[4,F.c.import()];case 1:return i=a.sent(),(o=i(e))&&!o.needRedeem?[3,4]:[4,F.b.import()];case 2:return[4,a.sent()(e,!0,!0)];case 3:o=a.sent(),a.label=4;case 4:return l((function(){return Promise.resolve(o.wacUrlInfo)}),t,o.wacUrlInfo.readOnly,n,r),[2]}}))}))}(e,t,r,i),Ye()}}}var je=n(5800);var Ie=n(1055),ye=n(4821),ke=n(4822),Se=n(4290),Ce=n(2063);var Te=n(5801);function Ae(e){return e===U.c.linkHasExpired||e===U.c.linkWillExpire}var Pe=n(7);function xe(e,t,n,r){switch(e){case U.c.externalRecipientCSL:case U.c.getSharingInfoFailed:case U.c.noPermissionSet:case U.c.noPermissionToShare:case U.c.noPermissionToShareExternally:case U.c.sharingWithLargeDL:return t;case U.c.linkHasExpired:case U.c.linkWillExpire:return function(e,t,n){if(t===b.b.refreshFailed)return Object(V.b)(Te.e);if(e===U.c.linkHasExpired)return Object(V.b)(Te.a);var r=Object(Pe.Q)(n);return Object(V.c)(Object(V.b)(Te.c),r)}(e,n,r);default:return Object(N.a)(e)}}var Ee,Le=n(5802),Re=n(5803),Ne=n(1203),De=n(5804),Fe=n(479),Me=Object(x.a)((function(e){var t=e.sharingLinkInfo.linkActionStatus;return Object(Ne.a)("transitionend",(function(t){return Object(b.C)(e.sharingLinkInfo.linkId,b.b.none)}),[e.sharingLinkInfo.linkId]),Ae(e.sharingIssue.id)&&t!==b.b.none&&t!==b.b.refreshFailed?t===b.b.refreshing?j.createElement("div",{className:De.overlay},j.createElement(y.a,{className:De.spinner,size:k.a.medium}),Object(V.b)(Re.b)):t===b.b.refreshSucceeded?j.createElement("div",{className:Fe(De.overlay,De.fadeOut)},j.createElement(re.a,{iconName:"CheckMark",className:De.check}),Object(V.b)(Re.a)):null:null})),Ue=n(4289),qe=n(5806),We=n(308).bind(qe),Be=Object(x.a)((function(e){var t,n,r=j.useContext(Ce.a),i=function(t){var n;Object(U.n)(e.sharingLinkInfo.linkId),n=e.sharingIssue.id,Object(R.o)("AttachmentLinkRefreshedSharingTip",[n]),t.stopPropagation()},o=function(t){var n;oe(e.sharingLinkInfo.sharingInfo,e.sharingLinkInfo.linkId,e.sharingLinkInfo.permissionLevel,e.composeId,e.recipientInfos,r,e.isCalendar),n=e.sharingIssue.id,Object(R.o)("AttachmentLinkViewChangePermissionSharingDialog",[q.sharingTip,n]),t.stopPropagation()},a=function(t){var n;Z(e.sharingLinkInfo.linkId,r),n=e.sharingIssue.id,Object(R.o)("AttachmentLinkAttachAsACopy",[q.sharingTip,n]),Ye(),t.stopPropagation()},c=function(t){var n;b.s.import().then((function(t){return t(e.sharingLinkInfo.linkId,e.sharingIssue.id)})),n=e.sharingIssue.id,Object(R.o)("AttachmentLinkSharingTipIgnored",[n]),t.stopPropagation()},u=e.sharingIssue,s=e.sharingLinkInfo,l={error:u.messageRank===Ie.b.Error},d=(t=u.id,n=s.linkActionStatus,Ae(t)?n===b.b.refreshFailed?Object(V.b)(Te.f):t===U.c.linkWillExpire?Object(V.b)(Te.d):t===U.c.linkHasExpired?Object(V.b)(Te.b):null:null);return j.createElement("div",{className:Ue.menuItemContainer,"aria-label":u.sharingTipString,"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:null,tabIndex:0},j.createElement(Me,{sharingLinkInfo:s,sharingIssue:u}),j.createElement("div",{className:Ue.iconContainer},j.createElement(re.a,{iconName:"Info",className:We(qe.sharingTipIcon,l),title:d})),function(e,t){var n=-1!==t.sharingTipActions.indexOf(U.b.ignore),r=-1!==t.sharingTipActions.indexOf(U.b.refreshExpiration)&&e.sharingInfo.canRefresh,u=e.linkActionStatus===b.b.refreshFailed?Object(V.b)(Le.b):Object(V.b)(Se.a),s=e.sharingInfo.canShareExternally||e.sharingInfo.canShareInternally,l=-1!==t.sharingTipActions.indexOf(U.b.changePermission)&&s,d=-1!==t.sharingTipActions.indexOf(U.b.attachAsACopy)&&!l&&Y(e),f=xe(t.id,t.sharingTipString,e.linkActionStatus,e.sharingInfo.expirationDate);return j.createElement("div",{className:Ue.text},j.createElement("span",{className:qe.paddingRight},f),r&&j.createElement(j.Fragment,null,j.createElement("button",{className:qe.actionButton,onClick:i},u),j.createElement("span",{className:qe.divider}," "," | "," ")),l&&j.createElement(j.Fragment,null,j.createElement("button",{className:qe.actionButton,onClick:o},Object(V.b)(ye.a)),j.createElement("span",{className:qe.divider}," "," | "," ")),d&&j.createElement(j.Fragment,null,j.createElement("button",{className:qe.actionButton,onClick:a},Object(V.b)(Le.a)),j.createElement("span",{className:qe.divider}," "," | "," ")),n&&j.createElement("button",{className:qe.actionButton,onClick:c},Object(V.b)(ke.a)))}(s,u))}));function Ve(e){var t=p();return e===t.selectedLinkId?!1===t.isSelectedLinkReadOnly?W.Edit:W.Selected:W.None}!function(e){e[e.SharingTip=0]="SharingTip",e[e.ChangePermission=1]="ChangePermission",e[e.Preview=2]="Preview",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.AttachACopy=4]="AttachACopy",e[e.RevertToFullUrl=5]="RevertToFullUrl",e[e.EditLink=6]="EditLink",e[e.CopyLinkToClipboard=7]="CopyLinkToClipboard"}(Ee||(Ee={}));var ze=n(4288),Ge=n(308).bind(ze),He=Object(x.a)((function(e){var t=Object(b.l)(e.composeLinkViewState.linkId);if(!t||t.linkActionStatus===b.b.attachingAsACopy||t.linkActionStatus===b.b.pendingAttachAsACopy)return null;var n,r,i,o,a,c,u,s,l,d,f,p,h,O,g=Object(P.__read)((n=e.composeLinkViewState,r=e.anchorElement,e.editor,i=e.composeEditorViewState,o=e.operateContent,a=e.composeId,c=e.recipientInfo,u=e.isCalendar,s=e.targetWindow,l=e.sxsId,d=!1,f=!1,p=[],h=Object.keys(Ee).filter((function(e){return!isNaN(Number(Ee[e]))})).map((function(e){return Ee[e]})),O=function(e,t){o(i,(function(n){return n.addUndoSnapshot((function(){return function(e,t,n,r){v.unmountComponentAtNode(t);var i=document.createElement("a");i.href=n,i.innerText=r,e.replaceNode(t,i),e.select(i,-3),e.triggerContentChangedEvent(m)}(n,r,e,t)})),null}))},h.forEach((function(e){switch(e){case Ee.SharingTip:var t=function(e,t,n,r){var i=U.i.tryImportForRender();if(!i)return null;var o=i(Object(b.k)(e.linkId),t);if(o.length>0){o.length>1&&Object(R.o)("AttachmentLinkMultipleSharingTipsShown");var a=[];return o.map((function(i){var o=Object(b.l)(e.linkId);a.push({key:"contextualSharingTip",onRender:function(e,a){return j.createElement(Be,{sharingIssue:i,sharingLinkInfo:o,composeId:n,recipientInfos:t,isCalendar:r})}})})),a}return null}(n,c,a,u);t&&t.length>0&&(d=!0,t.forEach((function(e,t){p.push(e),p.push(be("divider_sharing "+t))})));break;case Ee.OpenInNewTab:var i=Object(D.g)(Object(b.l)(n.linkId).url,s,(function(){Ye(),Object(R.o)("OpenInNewTab",{entryPoint:"BeautifulLinkContextMenu"})}));i&&p.push(i);break;case Ee.AttachACopy:var o=function(e,t){var n=Object(b.l)(e);if(!Y(n))return null;var r=Object(B.n)($[n.providerType]);return(null==r?void 0:r.supportConvertCloudyToClassic)?{name:Object(V.b)(z.a),key:"AttachACopy",onClick:function(){Object(R.o)("AttachmentLinkAttachAsACopy",[q.contextMenu]),Ye(),Z(e,t)}}:null}(n.linkId,s);o&&p.push(o);break;case Ee.ChangePermission:var h=function(e,t,n,r,i){var o=Object(b.l)(e),a=o.sharingInfo;if(!o.accessTokenAvailable)return null;var c=function(){Object(R.o)("AttachmentLinkViewChangePermissionSharingDialog",[q.contextMenu]),oe(a,o.linkId,o.permissionLevel,t,n,r,i)};return{key:"ChangePermissionsSharingDialog",onRender:function(e,t){return j.createElement("button",{className:ce(ae.menuItemContainer,ae.buttonStyles),"aria-label":Object(ee.e)(o.permissionLevel,0),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:c,tabIndex:0},j.createElement("div",{className:ae.iconContainer},j.createElement("img",{src:(n=o.permissionLevel,function(e){var t="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing";switch(e){case 2:case 3:return t+"/companyonly.svg";case 4:case 5:return t+"/anyone.svg";case 6:return t+"/directrecipients.svg";default:return t+"/existingaccess.svg?v2"}}(function(e){switch(e){case 4:return 5;case 3:return 4;case 6:return 3;case 5:return 2;case 2:case 1:return 6;default:return 1}}(n))),className:ae.permissionIcon})),j.createElement("div",{className:ce(ae.text,ae.paddingForChevron)},Object(ee.e)(o.permissionLevel,0)),j.createElement(re.a,{iconName:"ChevronRight",className:ce(ae.chevronRight,"flipForRtl")}));var n}}}(n.linkId,a,c,s,u);if(h)p.push(h),p.push(be("divider_perms")),f=!0;else{var v=function(e,t,n,r){var i=Object(b.l)(e.linkId);return{text:Object(ee.e)(i.permissionLevel,0),key:"changePermission",className:te.smallFontContextMenu,subMenuProps:ne(i,t,n,r)}}(n,a,c,u);v&&(p.push(v),p.push(be("divider_perms")))}break;case Ee.EditLink:var m=ge(n,r,O,s);m&&p.push(m);break;case Ee.RevertToFullUrl:var g=function(e,t,n){var r=Object(b.l)(e.linkId),i=(Object(G.b)(r.fileName)||"").toLowerCase();return e.isLinkBeautified&&".fluid"!==i?{name:Object(V.b)(je.a),key:"RevertToFullUrl",onClick:function(){Object(R.o)("AttachmentLinkViewRevertToFullUrl"),Ye(),n(t.href,t.href)}}:null}(n,r,O);g&&p.push(g);break;case Ee.Preview:if(Object(M.h)("doc-SxS-jsApi-ODB-Links")){var _=F.a.tryImportForRender(),w=Object(b.l)(n.linkId),I=w.unwrappedUrl?w.unwrappedUrl:w.url;if(n.isLinkBeautified&&_&&_(I)&&Ve(n.linkId)===W.None){var y=we(I,n.linkId,u,s,l);y&&p.push(y)}}break;case Ee.CopyLinkToClipboard:var k=fe(r,s);k&&p.push(k);break;default:Object(N.a)(e)}})),[p,d||f]),2),_=g[0],w={conditionalPadding:g[1]};return j.createElement(E.a,{className:Ge(w),target:e.anchorElement,shouldFocusOnMount:!0,onDismiss:Ke,items:_,directionalHint:L.DirectionalHint.bottomLeftEdge,gapSpace:2})})),Je=null;function Ye(){Je&&(v.unmountComponentAtNode(Je),Je.parentNode&&Je.parentNode.removeChild(Je),Je=null),o()}function Ke(e){Ye()}var Xe=n(1268);var Qe=n(1639);var Ze,$e=n(2),et=n(2267),tt=n(999),nt=n(2477);!function(e){e[e.None=0]="None",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(Ze||(Ze={}));var rt=n(4291),it=n.n(rt),ot=n(4291),at=n(308).bind(ot),ct=Object(x.a)((function(e){var t=Object(M.h)("cmp-prague")&&e.sharingLink.fileName.indexOf(".fluid")>0;j.useEffect((function(){return o(),e.viewState.isLinkBeautified&&n.current.setAttribute("contenteditable","false"),Object(M.h)("doc-link-errorAttribute")&&n.current.setAttribute("owa-btf-l-cmp-only",""),n.current.setAttribute(et.f,""),n.current.addEventListener("click",c),n.current.addEventListener("contextmenu",c),e.operateContent(e.composeEditorViewState,(function(t,r,i){var o=t.queryElements("#"+e.originalElement.id),a=!1;if(o&&1===o.length){Q.g.info("operateContent replacing node with beautiful link"),t.replaceNode(o[0],n.current);var c=t.getSelectionRange();t.hasFocus()&&c&&c.startContainer===c.endContainer&&c.startContainer===n.current.parentNode&&(a=!0)}else if(o&&o.length>=1){(u=new Error("BeautifulLinkWithMoreThanOne")).diagnosticInfo=e.originalElement.id,Q.d(u)}else{var u;(u=new Error("BeautifulLinkWithNoTarget")).diagnosticInfo=e.originalElement.id,Q.d(u)}return a?i.createRange(n.current,-3):null})),function(){n.current&&(n.current.removeEventListener("click",c),n.current.removeEventListener("contextmenu",c))}}),[]);var n=j.useRef(),r=j.useRef(),o=function(){if(e.originalElement&&"a"===e.originalElement.tagName.toLowerCase()){var t=function(e){var t=e.getAttribute(O);e.style.backgroundColor===_&&(t=t.replace(w,""));t&&t.length>0&&t.lastIndexOf(g)!==t.length-1&&(t+=g);return t}(e.originalElement);if(t+=n.current.getAttribute(O),e.isLinkPreviouslyBeautified){var r=e.originalElement.querySelector("SPAN");if(r){var i=r.getAttribute(O);i&&(i.lastIndexOf("width:")>=0?Q.d("Ignore dangerous Span style ${spanStyle}"):t+=i)}}n.current.setAttribute(O,t),function(e,t){var n=e.getAttribute(nt.b);n&&n.length>0&&t.setAttribute(nt.b,n);var r=e.getAttribute(nt.d);r&&r.length>0&&t.setAttribute(nt.d,r)}(e.originalElement,n.current)}},a=e.viewState?function(e,t,n){var r=t(),i=Object(b.k)(e);if(null===i)return Ze.None;var o=b.r.tryImportForRender(),a=U.i.tryImportForRender();if(o&&a){var c=a(i,o(r,n));if(c&&c.length>0)return c.some((function(e){return e.messageRank===Ie.b.Error}))?Ze.Error:Ze.Warning}return Ze.None}(e.viewState.linkId,e.getRecipientWells,e.fromAddress):Ze.None,c=function(t){!function(e,t,n,r,o,a,c,u){Object(P.__awaiter)(this,void 0,void 0,(function(){var s,l,d,f,p,m,O,g;return Object(P.__generator)(this,(function(_){switch(_.label){case 0:return Ye(),s=b.r.tryImportForRender(),l=[],s&&(l=s(a,c)),d=!a.some((function(e){return Object(b.B)(e)})),f=e.ownerDocument.defaultView,(Je=f.document.createElement("span")).id="sharingLinkContextMenu",e.appendChild(Je),p=Object(b.i)(e.id),v.render(j.createElement(j.StrictMode,null,j.createElement(He,{composeLinkViewState:h(p),anchorElement:e,editor:t,composeEditorViewState:n,operateContent:r,composeId:o,recipientInfo:l,isCalendar:d,targetWindow:f,sxsId:u})),Je),i(p,!0),[4,U.i.import()];case 1:return m=_.sent(),O=Object(b.k)(p),g=m(O,l).length>0,Object(R.o)("LinkContextMenuOpened",{hasSharingIssue:g,linkId:p}),[2]}}))}))}(n.current,e.editor,e.composeEditorViewState,e.operateContent,e.composeId,e.getRecipientWells(),e.fromAddress,e.sxsId),t.preventDefault()};Object(M.h)("doc-SxS-jsApi-ODB-Links")?r.current=Ve(e.sharingLink.linkId):r.current=W.None;var u={attachingAsACopy:e.sharingLink.linkActionStatus===b.b.attachingAsACopy||e.sharingLink.linkActionStatus===b.b.pendingAttachAsACopy,link:e.viewState.isLinkBeautified};u[function(e){switch(e){case W.Edit:return"edit";case W.Selected:return"selected";case W.None:return"none";default:return Object(N.a)(e)}}(r.current)]=!0;var s=e.viewState.isLinkBeautified&&e.hasValidFileName&&!t;return j.createElement("a",{ref:function(e){return n.current=e},href:e.sharingLink.url,onMouseOver:function(){n.current&&e.viewState.isLinkBeautified&&!t&&(n.current.style.backgroundColor="rgb(237,235,233)")},onMouseLeave:function(){n.current&&e.viewState.isLinkBeautified&&!t&&(n.current.style.backgroundColor="rgb(243,242,241)")},style:function(n){var r=st(e.composeEditorViewState),i={};return e.viewState.isLinkBeautified&&(i={padding:"0 1px",borderRadius:"2px",userSelect:"all"},t||(i=Object(P.__assign)(Object(P.__assign)({},i),{backgroundColor:"rgb(244,244,244)"}))),n===Ze.Error&&r&&(i=Object(P.__assign)(Object(P.__assign)({},i),{color:it.a.linkErrorColor})),i}(a),id:Object(b.h)(e.sharingLink.linkId,e.sharingLink.permissionLevel),className:at("OWAAutoLink",function(t){var n=st(e.composeEditorViewState);if(t===Ze.Error&&!n)return Object(M.h)("doc-link-errorAttribute")?ot.linkWithSharingIssueAttribute:ot.linkWithSharingIssue}(a),u)},e.viewState.isLinkBeautified&&Object(M.h)("doc-SxS-jsApi-ODB-Links")?j.createElement(j.Fragment,null,j.createElement(I,{text:D.b}),j.createElement(re.a,{className:r.current===W.Edit?ot.editLinkIcon:null,iconName:"Edit",hidden:r.current!==W.Edit}),j.createElement(I,{text:D.a})):null,s&&j.createElement("img",{src:e.fileIcon,style:{width:"16px",height:"16px",verticalAlign:"middle",padding:"1px 2px 2px 0"},alt:"",role:"presentation"}),e.viewState.displayName,function(t){return e.viewState.isLinkBeautified?j.createElement(j.Fragment,null,j.createElement(I,{text:D.b}),j.createElement("img",{alt:"",role:"presentation",src:ut(t),hidden:t===Ze.None,style:{width:"12px",height:"12px",verticalAlign:"top"}}),j.createElement(I,{text:D.a})):null}(a))}));function ut(e){return e===Ze.Error?Object(V.c)("{0}{1}",Object($e.t)(),"resources/images/redinfo_24.png"):e===Ze.Warning?Object(V.c)("{0}{1}",Object($e.t)(),"resources/images/greyinfo_24.png"):""}function st(e){return Object(tt.a)(e,"isDarkMode")||!1}function lt(e,t,n,r,i,o,c,u,s,l,d,f){return Object(P.__awaiter)(this,void 0,void 0,(function(){var p,b,m,O,g,_,w;return Object(P.__generator)(this,(function(I){switch(I.label){case 0:return Q.g.info("createSharingLinkView for id="+o.id+" isLinkPreviouslyBeautified="+l),p=s||l,b=u||l,m=function(e,t,n){if(e&&t){var r=Object(Qe.e)(e,n===H.f,n);return r.cdn?r.cdn:(Q.d("Failed to get cdn fileicon for "+e),"")}return""}(l?ve(o):c.fileName,p,c.mimeType),O=(d||window).document,g=O.createElement("span"),_=function(e,t,n,r,i){return i?ve(e):n&&r?t.fileName:e.innerText}(o,c,b,s,l),a(c.linkId,_,p),[4,Xe.c.import()];case 1:return w=I.sent(),v.render(j.createElement(j.StrictMode,null,j.createElement(Ce.a.Provider,{value:d||window},j.createElement(ct,{viewState:h(c.linkId),getRecipientWells:n,fromAddress:r,sharingLink:c,fileIcon:m,hasValidFileName:b,editor:e,composeEditorViewState:t,originalElement:o,composeId:i,isLinkPreviouslyBeautified:l,operateContent:w,sxsId:f}))),g),[2]}}))}))}n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return"OWAAutoLink"})),n.d(t,"f",(function(){return"SPAN"})),n.d(t,"b",(function(){return"contextmenu"})),n.d(t,"a",(function(){return"click"})),n.d(t,"g",(function(){return u})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return l})),n.d(t,"m",(function(){return c})),n.d(t,"e",(function(){return I})),n.d(t,"j",(function(){return T})),n.d(t,"h",(function(){return Ye})),n.d(t,"i",(function(){return lt}))},338:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(241),i=null,o=3e4;function a(){return null==i&&(i=new r.Cache),i}function c(e){return a().get(e)}function u(e){return a().del(e)}function s(e,t){a().put(e,t,o)}},3429:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),i=n(255),o=n(1286),a=n(1595),c=n(79);function u(e,t,n,u,s){return Object(r.__awaiter)(this,void 0,void 0,(function(){var l,d,f,p,b,h,v,m,O,g,_,w,j,I;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:l=new i.a("getWacInfoForOneDriveJsApi",{isCore:!0}),u&&l.addCustomData({redeemSharingLinkIfNecessary:u}),r.label=1;case 1:return r.trys.push([1,3,,4]),d=btoa(t),f="u!"+d.replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),p=new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0],b=p+"_api/v2.0/shares/"+f+"/root?select=openWith/wac,officeBundle,@content.downloadUrl,name,size,currentUserRole&action="+(n?"Open":"View"),h=new Object,u&&(h.prefer="redeemSharingLinkIfNecessary"),v=Object(o.a)({ProviderType:e,Url:b,Headers:JSON.stringify(h)}),m=(new Date).getTime(),[4,Object(a.a)(v)];case 2:if(200===(O=r.sent()).Status&&O.Body)return g=(new Date).getTime(),(_=JSON.parse(O.Body)).fetchStartTime=m,_.responseStartTime=g,!_.openWith.wac&&s||(_.openWith.wac.fileGetUrl=_["@content.downloadUrl"],_.openWith.wac.accessTokenExpiry&&(_.openWith.wac.accessTokenExpiry=new Date(Number(_.openWith.wac.accessTokenExpiry))),!n&&_.currentUserRole&&(_.currentUserRole.readOnly=!0)),l.end(),[2,_];throw l.addCustomData({StatusCode:O.Status}),(w=O.Headers)&&(j=JSON.parse(w))&&l.addCustomData({SharePointError:j.SharePointError,SPClientServiceRequestDuration:j.SPClientServiceRequestDuration,SPRequestGuid:j.SPRequestGuid}),new Error("Result status is: "+O.Status+" or empty response body.");case 3:return I=r.sent(),l.endWithError("ServerError",I),c.g.warn("Something went wrong while calling fetchDataProviderResourceOperation: "+I),[3,4];case 4:return[2,null]}}))}))}},3751:function(e,t,n){"use strict";var r=n(24),i=n(0);function o(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object(i.__assign)({__type:"GetWacInfoRequest:#Exchange"},n))),Object(r.a)("GetWacInfo",e,t)}function a(e,t,n,r,i){return void 0===n&&(n=!1),void 0===r&&(r=!1),o({request:{Url:e,IsEdit:r,ProviderType:t,ShouldGrantAccess:n}},i)}n.d(t,"a",(function(){return a}))},3800:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4),i=Object(r.action)("previewAttachment",(function(e){return{context:e}}))},383:function(e,t,n){"use strict";var r=n(0),i=n(241),o=n(271),a=n(340);function c(e){return Object(r.__assign)({__type:"TokenRequest:#Exchange"},e)}var u=n(120),s=n(24);function l(e,t){return void 0===e||e.__type||(e=c(e)),Object(s.a)("GetAccessTokenforResource",e,t)}var d=n(71),f=n(98),p="OWA_GetAccessTokenForResource";function b(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return[4,Object(d.a)()];case 1:return(i=r.sent())&&e==Object(f.a)()?[2,{AccessToken:i}]:(o={isUserActivity:!1,datapoint:{customData:{Scenario:p,Resource_Url:e,Retry_attempt:t,Request_Id:n},headersCustomData:function(e){return{TokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){var t;return{TokenStatus:(null===(t=null==e?void 0:e.TokenResultCode)||void 0===t?void 0:t.toString())||2}}},returnFullResponseOnSuccess:!0},[4,l(c({Resource:e,UserToken:i}),o)]);case 2:return[4,r.sent().json()];case 3:return[2,r.sent()]}}))}))}function h(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(r){return t<1?[2,Promise.reject()]:[2,b(e,t,i).catch((function(r){return Object(u.a)(n).then((function(){return h(e,t-1,2*n,i)}))}))]}))}))}var v,m=n(76),O=n(482),g=3,_=500;function w(e,t){var n=this,i=null,o=null,a=new Promise((function(e,t){return Object(r.__awaiter)(n,void 0,void 0,(function(){return Object(r.__generator)(this,(function(n){return i=e,o=t,[2]}))}))})),c={onFulfilled:i,onRejected:o,resource:e,requestId:t};return(null==v&&(v=new O.a(g,j,_)),v).add(c),a}function j(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){return R(e.resource,e.requestId).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var I=n(338),y=n(123),k=n(428);n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return E})),n.d(t,"c",(function(){return L})),n.d(t,"a",(function(){return R}));var S=1,C=8e3,T=3,A=1500,P=null;function x(e){P=e}function E(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=N(D(),e),t=t||Object(k.a)(),null!=n?[3,2]:[4,R(e,t)];case 1:n=r.sent(),r.label=2;case 2:return[2,null!=n?n.AccessToken:void 0]}}))}))}function L(e,t){t=t||Object(k.a)();var n=N(D(),e);if(n)return[n.AccessToken,void 0];if(Object(m.h)("auth-getAccessTokenQueueEnabled")){var r=Object(I.a)(e),i=void 0;return r?i=r:(i=w(e,t),Object(I.b)(e,i)),[void 0,i.then((function(t){return Object(I.c)(e),t.AccessToken})).catch((function(n){Object(I.c)(e),Object(y.h)(p,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",stk:n?n.stack:"",resource:e,requestId:t})}))]}return[void 0,R(e,t).then((function(e){return e.AccessToken}))]}function R(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,i,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(m.h)("auth-getAccessTokenQueueEnabled")?[4,h(e,T,A,t)]:[3,2];case 1:return i=r.sent(),[3,4];case 2:return[4,b(e,T,t)];case 3:i=r.sent(),r.label=4;case 4:return null!=(n=i)&&0==n.TokenResultCode&&null!=n.AccessTokenExpiry&&(n.ExpiresIn&&n.ExpiresIn>0&&(n.AccessTokenExpiry=Object(a.a)(Date.now(),n.ExpiresIn).toISOString()),(o=new Date(n.AccessTokenExpiry).getTime()-Date.now()-C)>0&&D().put(e,n,o,(function(e,n){R(e,t).catch((function(n){Object(y.h)(p,{category:"Cache_Expired",err:n?n.toString():"",message:n?n.message:"",stk:n?n.stack:"",resource:e,requestId:t})}))}))),[2,n]}}))}))}function N(e,t){var n=e.get(t),r=void 0;(null==n?void 0:n.AccessTokenExpiry)&&n.AccessToken&&(Object(o.a)(new Date(n.AccessTokenExpiry),-S)>new Date(Date.now())&&(r=n));return r}function D(){return null==P&&(P=new i.Cache),P}},3862:function(e,t,n){"use strict";n.d(t,"j",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(4),i=Object(r.action)("tryQueueGetWacInfo",(function(e){return{url:e}})),o=Object(r.action)("queueGetWacInfo",(function(e){return{url:e}})),a=Object(r.action)("processGetWacInfoQueue"),c=Object(r.action)("getWacInfoQueueShift"),u=Object(r.action)("onStartGetWacInfoOperation",(function(e){return{url:e}})),s=Object(r.action)("onFinishGetWacInfoOperation",(function(e){return{url:e}})),l=Object(r.action)("pushSupressedUrl",(function(e){return{url:e}})),d=Object(r.action)("onGetWacInfoSuccess",(function(e,t,n){return{url:e,wacUrlInfo:t,needRedeem:n}})),f=Object(r.action)("addGenericLinkClickListener",(function(e,t,n){return{element:e,isSafeLinkWrapped:t,isSafeLinkVerified:n}})),p=Object(r.action)("addOpenDocumentPreviewEventListener",(function(e,t,n,r,i,o){return{element:e,href:t,itemId:n,isSafeLinkWrapped:r,isSafeLinkVerified:i,isOfficeSPLink:o}}))},3870:function(e){e.exports=JSON.parse('{"a":"zza"}')},3871:function(e){e.exports=JSON.parse('{"a":"yza"}')},4288:function(e,t,n){var r=n(5797),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4289:function(e,t,n){var r=n(5798),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4290:function(e){e.exports=JSON.parse('{"a":"Tda"}')},4291:function(e,t,n){var r=n(5808),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},4572:function(e,t,n){"use strict";var r=n(23),i=n(4),o={activeGetWacInfoOperations:[],getWacInfoQueue:[],suppressedUrls:[],docLinkPreviewInfoMap:new r.ObservableMap},a=Object(i.createStore)("sharePointDocLinkPreview",o);t.a=a()},4818:function(e){e.exports=JSON.parse('{"a":"Aza"}')},4819:function(e){e.exports=JSON.parse('{"a":"xza"}')},482:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},4820:function(e){e.exports=JSON.parse('{"a":"uza"}')},4821:function(e){e.exports=JSON.parse('{"a":"Dza"}')},4822:function(e){e.exports=JSON.parse('{"a":"Sda"}')},5022:function(e,t,n){"use strict";var r=n(0),i=n(9),o=n(4),a=n(2),c=n(288);var u=n(443),s={am:"am-et","be-by":"be",cy:"cy-gb",en:"en-us",fil:"fil-ph","gd-gb":"gd","lo-la":"lo","mn-mn":"mn",no:"nn-no",or:"or-in","pa-in":"pa",prs:"prs-af",pt:"pt-br",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs","ug-cn":"ug",uz:"uz-latn-uz","zh-hant":"zh-cn","zh-hans":"zh-tw"};function l(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(r.__generator)(this,(function(f){switch(f.label){case 0:return p=Object(u.a)(Object(i.e)().currentLocale).locale.toLocaleLowerCase(),e=s[p]||p,t=["items-view","items-view-addon-graph","items-view-addon-sp","items-view-utilities","odsp-datasources","odsp-list-utilities","odsp-shared-sharing","odsp-utilities","utilities-custom-formatter","utilities-date-time","utilities-office-apps"],[4,Promise.all(t.map((function(t){return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n=Object(c.resolve)(Object(a.t)(),"resources/"+e+"/locale/"+t+".json"),[4,fetch(n)];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}}))}))}(t,e)})))];case 1:return n=f.sent(),window.ItemsViewStrings=n.reduce((function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),t)}),{}),d||(Object(o.orchestrator)(i.g,l),d=!0),[2]}var p}))}))}var d=!1;n.d(t,"a",(function(){return l}))},515:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,i=!1,o=function(a,c){i?c(new Error("The function retry was cancelled")):(r++,e().then((function(e){return a(e)})).catch((function(e){t&&r>=t?c(e):setTimeout((function(){return o(a,c)}),n(r))})))};return{retriableFunc:function(){return new Promise((function(e,t){return o(e,t)}))},cancel:function(){return i=!0}}}}function i(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},5236:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=18e5,i=2,o="SP_LINK_CLICK_EVENT_LISTENER",a="SP_LINK_MOUSEUP_EVENT_LISTENER"},5270:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(0),i=n(910),o=n(108),a=n(5022),c=new o.c((function(){return Object(r.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,Object(a.a)()];case 1:return t.sent(),[4,Promise.all([n.e(1),n.e(5),n.e(6),n.e(8),n.e(537)]).then(n.bind(null,8045))];case 2:return e=t.sent(),Object(i.initializeIcons)(),[2,e]}}))}))})),u=new o.b(c,(function(e){return e.sharingDialog}))},560:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},5751:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(5236),i=n(4572);function o(e){return a(e).docLinkPreviewInfo||null}function a(e){var t=i.a.docLinkPreviewInfoMap.get(e);return t?t.time+r.c>Date.now()?{docLinkPreviewInfo:t}:{reason:"Expired"}:i.a.getWacInfoQueue.some((function(t){return t===e}))||i.a.activeGetWacInfoOperations.some((function(t){return t===e}))?{reason:"InQueue"}:i.a.suppressedUrls.some((function(t){return t===e}))?{reason:"FileTypeNotSupportedOrSuppressedAfterError"}:{reason:"Unknown"}}},5795:function(e,t,n){var r=n(5796),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},5796:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,".zlTOIqgXrUeoE4QgaYR88{vertical-align:middle;width:14px;height:14px;display:inline-block}",""]),t.locals={linkSpinner:"zlTOIqgXrUeoE4QgaYR88"}},5797:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,"._17WyMAb7kE3GVOOwb-TpZ2{width:380px}.iji84L-TYfQ1OzoQCLarU{font-size:12px;font-weight:400}html[dir=ltr] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-left:40px}html[dir=rtl] .kYi6jPW-Twz-7yNjFuas7 .ms-ContextualMenu-link{padding-right:40px}",""]),t.locals={fixWidthContextMenu:"_17WyMAb7kE3GVOOwb-TpZ2",smallFontContextMenu:"iji84L-TYfQ1OzoQCLarU",conditionalPadding:"kYi6jPW-Twz-7yNjFuas7"}},5798:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._1FXMYQgOMl3amdWxRszOtq{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;max-width:340px;width:100%}html[dir] ._1FXMYQgOMl3amdWxRszOtq{background:transparent;padding:4px 0;margin:1px}html[dir=ltr] ._1FXMYQgOMl3amdWxRszOtq{text-align:left}html[dir=rtl] ._1FXMYQgOMl3amdWxRszOtq{text-align:right}._1FXMYQgOMl3amdWxRszOtq:focus{outline:dotted 1px}._2J6rsM7M0QVkdfFCwf00JE{cursor:pointer}html[dir] ._2J6rsM7M0QVkdfFCwf00JE:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}._3C9hg6ajHb65GB2Yn3bZfl{word-wrap:break-word;max-width:286px}html[dir=ltr] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 16px 8px 0}html[dir=rtl] ._3C9hg6ajHb65GB2Yn3bZfl{padding:8px 0 8px 16px}._T68wDSYHk9rU_lDLi9YG{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;min-width:44px}._T68wDSYHk9rU_lDLi9YG,._3ocYJJXdgtwVydxjhLdwEm{display:-webkit-box;display:-ms-flexbox;display:flex}._3ocYJJXdgtwVydxjhLdwEm{width:24px}html[dir=ltr] ._3ocYJJXdgtwVydxjhLdwEm{left:10px}html[dir=rtl] ._3ocYJJXdgtwVydxjhLdwEm{right:10px}._1aMX_W4LfwQ1uTeRkbETcG{display:inline-block;height:32px;line-height:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;font-size:12px}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG{text-align:center}html[dir=ltr] ._1aMX_W4LfwQ1uTeRkbETcG{right:8px}html[dir=rtl] ._1aMX_W4LfwQ1uTeRkbETcG{left:8px}._1aMX_W4LfwQ1uTeRkbETcG,._3ocYJJXdgtwVydxjhLdwEm,._2RFcp9Zl9UWOAAPCKGSCKd{position:absolute;top:50%}html[dir] ._1aMX_W4LfwQ1uTeRkbETcG,html[dir] ._3ocYJJXdgtwVydxjhLdwEm,html[dir] ._2RFcp9Zl9UWOAAPCKGSCKd{-webkit-transform:translateY(-50%);transform:translateY(-50%)}html[dir=ltr] .G28wWLVhUsHo2YnnrMEFD{padding-right:28px}html[dir=rtl] .G28wWLVhUsHo2YnnrMEFD{padding-left:28px}',""]),t.locals={menuItemContainer:"_1FXMYQgOMl3amdWxRszOtq",buttonStyles:"_2J6rsM7M0QVkdfFCwf00JE",text:"_3C9hg6ajHb65GB2Yn3bZfl",iconContainer:"_T68wDSYHk9rU_lDLi9YG",permissionIcon:"_3ocYJJXdgtwVydxjhLdwEm",chevronRight:"_1aMX_W4LfwQ1uTeRkbETcG",verticalCenter:"_2RFcp9Zl9UWOAAPCKGSCKd",paddingForChevron:"G28wWLVhUsHo2YnnrMEFD"}},5799:function(e){e.exports=JSON.parse('{"a":"v_b"}')},5800:function(e){e.exports=JSON.parse('{"a":"k_b"}')},5801:function(e){e.exports=JSON.parse('{"e":"p_b","a":"q_b","c":"r_b","f":"s_b","d":"t_b","b":"u_b"}')},5802:function(e){e.exports=JSON.parse('{"b":"n_b","a":"o_b"}')},5803:function(e){e.exports=JSON.parse('{"b":"l_b","a":"m_b"}')},5804:function(e,t,n){var r=n(5805),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},5805:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._15uyY13ASl7ioBzQ_C4EWc{position:absolute;z-index:2;width:100%;height:calc(100% - 10px);opacity:.9;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;color:"[theme:themePrimary, default:#0078D4]";font-size:14px}html[dir] ._15uyY13ASl7ioBzQ_C4EWc{background-color:"[theme:white, default:#ffffff]"}._3d_DdC8WbZ8lVAv_uGMON8{color:#107c10}html[dir=ltr] ._3d_DdC8WbZ8lVAv_uGMON8{padding-right:4px}html[dir=rtl] ._3d_DdC8WbZ8lVAv_uGMON8{padding-left:4px}html[dir=ltr] ._2Atp1TsvFekBpdmnwjlUMU{padding-right:8px}html[dir=rtl] ._2Atp1TsvFekBpdmnwjlUMU{padding-left:8px}._3FqcARyIY48vWIbTdVE2SJ{opacity:0}html[dir] ._3FqcARyIY48vWIbTdVE2SJ{-webkit-transition:opacity 4s cubic-bezier(.95,.05,.5,.12);transition:opacity 4s cubic-bezier(.95,.05,.5,.12)}',""]),t.locals={overlay:"_15uyY13ASl7ioBzQ_C4EWc",check:"_3d_DdC8WbZ8lVAv_uGMON8",spinner:"_2Atp1TsvFekBpdmnwjlUMU",fadeOut:"_3FqcARyIY48vWIbTdVE2SJ"}},5806:function(e,t,n){var r=n(5807),i=n(116);"string"==typeof r&&(r=[[e.i,r]]);for(var o=0;o<r.length;o++)i.loadStyles(r[o][1],!1);r.locals&&(e.exports=r.locals)},5807:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._1j7cMKJzK3hDG-6d1x8z6x{font-size:14px;color:"[theme:neutralSecondary, default:#666666]"}._1j7cMKJzK3hDG-6d1x8z6x.NCCd4mtRtnDhwXkQV3Z_P{color:#c50e2e}._1XTgRlvIFVAMWCwk3N1Mrd{font-size:12px;font-weight:400;color:"[theme:themePrimary, default:#0078D4]";cursor:pointer}html[dir] ._1XTgRlvIFVAMWCwk3N1Mrd{background:transparent}html[dir=ltr] ._1lAZM-j0_dTiprJU8qtsOC{padding-right:5px}html[dir=rtl] ._1lAZM-j0_dTiprJU8qtsOC{padding-left:5px}._2A5MU0_Ldq3YiUz9_7eSp0{position:relative;top:-1px}',""]),t.locals={sharingTipIcon:"_1j7cMKJzK3hDG-6d1x8z6x",error:"NCCd4mtRtnDhwXkQV3Z_P",actionButton:"_1XTgRlvIFVAMWCwk3N1Mrd",paddingRight:"_1lAZM-j0_dTiprJU8qtsOC",divider:"_2A5MU0_Ldq3YiUz9_7eSp0"}},5808:function(e,t,n){(t=e.exports=n(115)(!1)).push([e.i,'._3Yr2UU45BKqj8cd21wO--0,.MEvaZK33-uzHgSrR3sZ2B[owa-btf-l-cmp-only]{color:#c50e2e}._3iLgzr8un7L5GebClucrpV{display:inline-block}._3BQT8e_ffVCDX0mocATk3h{opacity:.3}html[dir] ._1qJHlPfY83WgqLBJTIZPj{border-radius:2px}html[dir] ._1qJHlPfY83WgqLBJTIZPj:focus,html[dir] ._1qJHlPfY83WgqLBJTIZPj:hover{background:"[theme:neutralLighter, default:#f4f4f4]"}._1Bl3Epd8DW0Ci3uZDqSnP5,._12rPxFFSJYfi0v4-eMstQ7,._2m59mwUb8f5uts16JkmmuW{color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5,html[dir] ._12rPxFFSJYfi0v4-eMstQ7,html[dir] ._2m59mwUb8f5uts16JkmmuW{border-width:1px;background-color:"[theme:themeLight, default:#C7E0F4]"!important;border-color:"[theme:themePrimary, default:#0078D4]";border-radius:2px}html[dir] ._1Bl3Epd8DW0Ci3uZDqSnP5{border-style:dashed;background-color:"[theme:themeLighterAlt, default:#EFF6FC]"!important}html[dir] ._12rPxFFSJYfi0v4-eMstQ7{border-style:solid}._28V6s2qWpjnFBjP3O5_ZUO{font-size:14px;font-weight:400;position:relative;top:-1px;color:"[theme:themePrimary, default:#0078D4]";vertical-align:middle;text-decoration:underline;-webkit-text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]";text-decoration-color:"[theme:themeLighterAlt, default:#EFF6FC]"}html[dir=ltr] ._28V6s2qWpjnFBjP3O5_ZUO{padding-right:4px;padding-left:3px}html[dir=rtl] ._28V6s2qWpjnFBjP3O5_ZUO{padding-left:4px;padding-right:3px}._7uvXE6H5Cmt5xolh9xVtj{vertical-align:middle;width:14px;height:14px;display:inline-block}',""]),t.locals={linkErrorColor:"#c50e2e",linkWithSharingIssue:"_3Yr2UU45BKqj8cd21wO--0",linkWithSharingIssueAttribute:"MEvaZK33-uzHgSrR3sZ2B",link:"_3iLgzr8un7L5GebClucrpV",attachingAsACopy:"_3BQT8e_ffVCDX0mocATk3h",none:"_1qJHlPfY83WgqLBJTIZPj",edit:"_1Bl3Epd8DW0Ci3uZDqSnP5",selected:"_12rPxFFSJYfi0v4-eMstQ7",withBorder:"_2m59mwUb8f5uts16JkmmuW",editLinkIcon:"_28V6s2qWpjnFBjP3O5_ZUO",linkSpinner:"_7uvXE6H5Cmt5xolh9xVtj"}},598:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},6189:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(255);function i(e,t,n,i,o){Object(r.o)("SharePointLinkClick",{newTabReason:e,isSafeLinkWrapped:t,isSafeLinkVerified:n,extraInfo:i,isOfficeSPLink:o})}},626:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(24),i=n(598);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,t)}},627:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e){return Object(r.__assign)({__type:"FindItemRequest:#Exchange"},e)}},699:function(e,t,n){"use strict";n.r(t);var r=n(241),i=n(383);function o(e){Object(i.d)(new r.Cache),Object(i.b)(e.location.origin)}var a=n(0),c=n(57),u=n(107),s=n(340),l=n(123),d="OWA_GetDelegationAccessToken",f={};function p(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:t=encodeURIComponent(e.client_id+e.scope+e.requestId),n={},r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,b(e,window,t)];case 2:return n=r.sent(),[3,5];case 3:return r.sent(),n.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",f[e]),t.document.body.removeChild(n),delete f[e])}(t,window),[7];case 5:return[2,n]}}))}))}function b(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(a.__generator)(this,(function(o){return r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+c.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((i=t.document.createElement("iframe")).src=r.toString(),i.style.display="none",i.id=n,t.document.body.appendChild(i),[2,new Promise((function(r,o){f[n]=function(n){var a={};try{i.contentWindow&&i.contentWindow.location.host==t.location.host&&(a=function(e,t){var n=c.parse(e),r={};n.access_token?(r.AccessToken=n.access_token,r.AccessTokenExpiry=Object(s.a)(Date.now(),parseInt(n.expires_in)).toISOString(),r.TokenResultCode=0):"login_required"==n.error||"interaction_required"==n.error||"consent_required"==n.error?(r.TokenResultCode=3,Object(l.h)(d+" MSA Failure Unauthorized",{error:n.error,param:e,requestId:t})):(r.TokenResultCode=2,Object(l.h)(d+" MSA Failure",{error:n.error,param:e,requestId:t}));return r}(i.contentWindow.location.hash.substring(1),e.requestId))}catch(t){Object(l.h)(d+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),a.TokenResultCode=2,o(a)}r(a)},i.addEventListener("load",f[n],!1)}))])}))}))}var h,v=n(76),m=n(338),O=n(482),g=3,_=1500;function w(e){var t=this,n=null,r=null,i=new Promise((function(e,i){return Object(a.__awaiter)(t,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return n=e,r=i,[2]}))}))})),o={onFulfilled:n,onRejected:r,options:e};return(null==h&&(h=new O.a(g,j,_)),h).add(o),i}function j(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){return Object(a.__generator)(this,(function(t){return p(e.options).then((function(t){e.onFulfilled(t)})).catch((function(t){e.onRejected(t)})),[2]}))}))}var I=n(98),y=n(428),k=null,S="OWA_GetDelegationAccessToken",C="https://login.live.com/oauth20_authorize.srf",T="/owa/auth/dt.aspx",A="292841";function P(e,t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:n={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:t||Object(y.a)()},r=void 0,i=void 0,a.label=1;case 1:return a.trys.push([1,7,,8]),Object(v.h)("auth-disableGetAuthenticationCall")?[4,x(R(n))]:[3,3];case 2:return r=a.sent(),[3,6];case 3:return[4,Object(u.a)()];case 4:return 0!=(i=a.sent()).ResultCode||null==i.ImplicitGrantAuthorizationUrl||""==i.ImplicitGrantAuthorizationUrl?(Object(l.h)(S+" ImplicitGrantAuthorizationUrl is empty or null ",{scope:e,correlationId:n.requestId}),[2,r]):(o=c.parse(i.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&o.redirect_uri?(n.client_id=o.client_id,n.authorization_uri=i.ImplicitGrantAuthorizationUrl.split("?")[0],n.redirect_uri=o.redirect_uri,[4,x(n)]):[3,6];case 5:r=a.sent(),a.label=6;case 6:return[2,r];case 7:return s=a.sent(),Object(l.h)(S+" GetDelegationToken Operation failed ",{err:s.toString(),message:s.message,stk:s.stack||"",scope:e,requestId:n.requestId}),[2,r];case 8:return[2]}}))}))}function x(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i;return Object(a.__generator)(this,(function(o){switch(o.label){case 0:return t=e.client_id+e.scope,(null==(n=function(e,t){var n=e.get(t),r=void 0;if(null==n?void 0:n.AccessTokenExpiry){new Date(n.AccessTokenExpiry)>new Date(Date.now())&&(r=n)}return r}(L(),t))?void 0:n.AccessToken)?[2,n.AccessToken]:[3,1];case 1:return Object(v.h)("auth-getDelegationTokenQueueEnabled")?(r=Object(m.a)(t),i=void 0,r?i=r:(i=w(e),Object(m.b)(t,i)),[2,i.then((function(e){return E(t,e),Object(m.c)(t),e.AccessToken})).catch((function(n){Object(m.c)(t),Object(l.h)(S,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",scope:e.scope,requestId:e.requestId})}))]):[3,2];case 2:return[4,p(e)];case 3:return n=o.sent(),E(t,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}}))}))}function E(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&L().put(e,t,n)}}function L(){return null==k&&(k=new r.Cache),k}function R(e){return e.redirect_uri=Object(I.a)()+T,e.authorization_uri=C,e.client_id=A,e}var N=n(5),D=n(440);var F=!1;function M(){var e;F||(e=Object(D.a)("/owa"),Object(N.b)({baseUrl:e}),F=!0)}var U={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function q(e,t,n,r,i){n?e.acquireTokenPopup(t,null,n,i):e.acquireToken(t,(function(n,o){n&&n.indexOf(U.NoPreAuth)>=0&&r?e.acquireTokenPopup(t,null,null,i):i(n,o)}))}var W=n(108),B=new W.c((function(){return Promise.all([n.e(677),n.e(114)]).then(n.bind(null,14896))})),V=new W.a(B,(function(e){return e.createAdalAuthenticationContext}));var z=function(e,t,n,r,i){return function(o,a){o||!a?i(o,null):(e.getCachedUser(),q(e,t,n,r,i))}},G="adalIdTokenFrame";function H(e,t,n,r,i){e.config.displayCall=function(o){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(o),window.detectUserCachedCallback=z(e,t,n,r,i),function(e,t){e._addAdalFrame(G).src="about:blank",e._loadFrame(t+"&prompt=none",G)}(e,o)},e.login()}var J=n(26);function Y(e,t,n,r,i,o){var c,u;return Object(a.__awaiter)(this,void 0,void 0,(function(){var s,l,d,f;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return"https://login.microsoftonline.com/",[4,V.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return s=a.sent(),l=Object(J.a)(),d=null===(c=l.SessionSettings)||void 0===c?void 0:c.UserPrincipalName,f=null===(u=l.SessionSettings)||void 0===u?void 0:u.UserEmailAddress,s._user={profile:{upn:d||f}},s.getCachedUser()?q(s,n,r,i,o):H(s,n,r,i,o),[2]}}))}))}var K=n(71);n.d(t,"registerTokenProvider",(function(){return o})),n.d(t,"getAccessTokenforResource",(function(){return i.b})),n.d(t,"getAccessTokenforResourceAsLazy",(function(){return i.c})),n.d(t,"getDelegationToken",(function(){return x})),n.d(t,"getDelegationTokenForOwa",(function(){return P})),n.d(t,"bootstrap",(function(){return M})),n.d(t,"getAccessTokenOnBehalfOfResource",(function(){return Y})),n.d(t,"AdalErrorCode",(function(){return U})),n.d(t,"setUserTokenCallback",(function(){return K.b}))},7098:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),i=n(3751),o=n(3429),a=n(76),c=n(967),u=n(3862),s=n(5751);function l(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var i,l,f,p;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,,9,10]),Object(u.f)(e),i=null,Object(a.h)("doc-SxS-jsApi-ODB-Links")?[4,Object(o.a)(0,e,!0,n,!0)]:[3,6];case 1:return(l=r.sent())?[3,2]:(Object(u.h)(e),[2,null]);case 2:return f=Object(c.b)(l.name),(p=Object(c.f)(f))!==c.a.Word&&p!==c.a.Excel&&p!==c.a.PowerPoint?[3,3]:(l.openWith.wac?i={wacUrl:l.openWith.wac.applicationUrl,jsApiInfo:{bootScriptUrl:l.openWith.wac.bootstrapperUrl,wopiSrcUrl:l.openWith.wac.wopiSrc,accessToken:l.openWith.wac.accessToken,accessTokenExpiry:l.openWith.wac.accessTokenExpiry,fileSize:l.size,fileGetUrl:l.openWith.wac.fileGetUrl,bundleInfo:l.officeBundle,fetchStartTime:l.fetchStartTime,responseStartTime:l.responseStartTime,openUrl:e,fileName:l.name,userId:l.openWith.wac.userId},readOnly:l.currentUserRole.readOnly}:Object(u.e)(e,null,!0),[3,5]);case 3:return[4,d(e)];case 4:i=r.sent(),r.label=5;case 5:return[3,8];case 6:return[4,d(e)];case 7:i=r.sent(),r.label=8;case 8:return i&&Object(u.e)(e,i),t?[2,Object(s.a)(e)]:[2,null];case 9:return Object(u.d)(e),[7];case 10:return[2]}}))}))}function d(e){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(i.a)(e,0)];case 1:if(9===(t=n.sent()).Status||6===t.Status||5===t.Status)Object(u.h)(e);else if(0===t.Status)return[2,{wacUrl:t.WacUrl,bootScriptUrl:t.BootScriptUrl,wopiSrcUrl:t.WopiSrcUrl,accessToken:t.AccessToken,deprecatedTokenAndParameters:t.Token}];return[2,null]}}))}))}},7187:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(108),i=(n(255),new r.c((function(){return n.e(349).then(n.bind(null,9670))}))),o=new r.a(i,(function(e){return e.loadItemAttachment})),a=new r.b(i,(function(e){return e.loadItemAttachmentFromServer}))},8057:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(4),o=n(3862),a=n(1782),c=n(5236),u=n(8819),s=n(7098),l=n(5751),d=n(6189),f=n(8820);Object(i.orchestrator)(o.b,(function(e){var t=e.element,n=e.href,i=e.itemId,p=e.isSafeLinkWrapped,b=e.isSafeLinkVerified,h=e.isOfficeSPLink;Object(o.j)(n);var v=function(e){!function(e,t,n,i,o,c){var u=this,p=null;if(!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)){var b=Object(l.b)(n),h=b.docLinkPreviewInfo,v=b.reason;if((null==h?void 0:h.needRedeem)||"Expired"===v)return Object(a.a)((function(){return Object(r.__awaiter)(u,void 0,void 0,(function(){var e,t;return Object(r.__generator)(this,(function(a){switch(a.label){case 0:return[4,Object(s.a)(n,!0,!0)];case 1:return e=a.sent(),t=(null==h?void 0:h.needRedeem)?"redeem":"retryAfterCacheExpire",Object(d.a)(null,i,o,t,c),[2,Object(r.__assign)(Object(r.__assign)({},e.wacUrlInfo),{extraInfo:t})]}}))}))}),t),void e.preventDefault();if(h)return Object(a.a)((function(){return Promise.resolve(h.wacUrlInfo)}),t),e.preventDefault(),void Object(d.a)(null,i,o,null,c);p=v}Object(f.a)(e,i,o,p)}(e,i,n,p,b,h)};t.addEventListener("click",v),t[c.a]=v;var m=function(e){Object(u.a)(e,p,b)};t.addEventListener("mouseup",m),t[c.b]=m}));var p=n(2817),b=n(108),h=new b.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(554)]).then(n.bind(null,14617))})),v=new b.a(h,(function(e){return e.insertSxSV2IntoDomIfNeeded}));p.c.register(v.importAndExecute);var m=n(7187);Object(i.orchestrator)(p.h,(function(e){var t=e.itemAttachmentId,n=e.perfDatapoint;m.a.importAndExecute(t,n)}));var O=n(3800);Object(i.orchestrator)(O.a,(function(e){var t=e.context;p.d.importAndExecute(t)}));var g=n(3365),_=n(1128);Object(i.orchestrator)(g.l,(function(e){var t=e.wacUrlGetter,n=e.linkId,r=e.readOnly,i=e.targetWindow,o=e.sxsId;p.g.importAndExecute(t,null,p.a.ComposeDocLink,{method:p.b.CopyMailReadingPaneContainer},null,n,r,i,o)})),Object(i.orchestrator)(_.H,(function(e){var t=e.selectedLinkId,n=e.isSelectedLinkReadOnly;Object(g.k)(t,n)}));var w=n(2248);Object(i.orchestrator)(w.f,(function(e){var t=e.wacUrlGetter,n=e.itemId;p.g.importAndExecute(t,n,p.a.ReadingPaneDocLink,{method:p.b.CopyMailReadingPaneContainer},null,null,null,window)}))},8819:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6189),i=1,o=2;function a(e,t,n){e.button===i?Object(r.a)("MouseMiddleButton",t,n):e.button===o&&Object(r.a)("MouseRightButton",t,n)}},8820:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(255),i=n(428),o=n(2477),a=n(6189);function c(e,t,n,c){var u,s,l=Date.now(),d=new r.a("ServiceGeneratedLinkClickHandler"),f="CT="+l+"&OR=OWA-"+(e?e.ctrlKey||1===e.button?"NTB":e.shiftKey?"NW":"NT":"NT")+"&CID="+Object(i.a)(),p=e.currentTarget,b=(s=new URL(p.href),["CID","OR","CT"].forEach((function(e){var t;(null===(t=s.searchParams)||void 0===t?void 0:t.get(e))&&s.searchParams.delete(e)})),s);if(t){var h=b.href,v=h.indexOf(o.c);if(-1===v)return;var m=encodeURIComponent(btoa(f));u=h.substr(0,v)+"&xdata="+m+o.c}else{var O=b.href.indexOf("?")>=0?"&":"?";u=b.href+O+f}d.end(),window.open(u),e.preventDefault(),Object(a.a)(c||(e.altKey?"AltKey":e.ctrlKey?"CtrlKey":e.metaKey?"MetaKey":e.shiftKey?"ShiftKey":"Default"),t,n)}},967:function(e,t,n){"use strict";var r=n(977),i=n(1384),o=n(9);function a(e){var t;return e>=1073741824?(e/=1073741824,t=Object(o.b)(i.b)):e>=1048576?(e/=1048576,t=Object(o.b)(i.d)):e>=1024?(e/=1024,t=Object(o.b)(i.c)):t=Object(o.b)(i.a),Object(o.c)(t,Math.round(e))}function c(e){return t=e||"",(n=s.exec(t))&&n.length>1&&u[n[1].toLowerCase()];var t,n}var u={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},s=/^\s*([^;\s]*)(?:;|\s|$)/;function l(e){var t="";return Object.entries(u).forEach((function(n){n[1]===e&&(t=n[0])})),t}var d=n(60),f=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],p=[".tiff",".tif"];function b(e,t,n){void 0===n&&(n=!0);var i=Object(r.a)(e)||c(t);return!!i&&(f.indexOf(i.toLowerCase())>=0||n&&p.indexOf(i.toLowerCase())>=0&&(Object(d.e)()||Object(d.d)()||Object(d.h)()||Object(d.g)()&&!Object(d.k)()))}var h,v=n(76),m=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function O(e){if(!Object(v.h)("doc-attachment-documentThumbnail"))return!1;var t=Object(r.a)(e);return!!t&&m.indexOf(t.toLowerCase())>=0}function g(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return h.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return h.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return h.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(h||(h={})),n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return O})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return h}))},977:function(e,t,n){"use strict";function r(e){if(!e)return null;var t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){var t=r(e);return t?t.replace(".",""):null}function o(e){var t;return(null===(t=i(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}))},984:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc"}(r||(r={}))},992:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1123);function i(e){return Object(r.a)().attachments.get(e.Id)}},999:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(0),i=n(1785),o=n(1991),a=n(1644),c=n(255),u="EditorRibbonUsage";function s(e,t){for(var n,o=[],c=2;c<arguments.length;c++)o[c-2]=arguments[c];var u=a.Editor.prototype[t];return Object(i.b)(e,(function(e){n=u.call.apply(u,Object(r.__spread)([e],o))}),null),n}function l(e,t,n,a){var s;void 0===n&&(n=[]),void 0===a&&(a=n);var l=o[t];return Object(i.b)(e,(function(e){s=l.apply(void 0,Object(r.__spread)([e],n)),(null==a?void 0:a.length)>0&&Object(c.o)(u+t,Object(r.__spread)(a.map((function(e){return JSON.stringify(e)})),[e.isDarkMode()]))}),null),s}}}]);
//# sourceMappingURL=owa.AttachmentPreviewSxSInitialize.js.map
self.scriptsLoaded['owa.AttachmentPreviewSxSInitialize.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.AttachmentPreviewSxSInitialize.js'] = (new Date()).getTime();