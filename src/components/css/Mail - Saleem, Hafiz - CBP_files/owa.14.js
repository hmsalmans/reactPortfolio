self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.14.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[14],{1e3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3527);t.NodeBlockElement=r.default;var o=n(2185);t.getBlockElementAtNode=o.default;var i=n(4122);t.getFirstLastBlockElement=i.default;var a=n(4120);t.StartEndBlockElement=a.default;var u=n(3103);t.ContentTraverser=u.default;var s=n(5537);t.PositionContentSearcher=s.default;var l=n(2576);t.getInlineElementAtNode=l.default;var c=n(4123);t.ImageInlineElement=c.default;var d=n(4124);t.LinkInlineElement=d.default;var f=n(3104);t.NodeInlineElement=f.default;var p=n(3107);t.PartialInlineElement=p.default;var h=n(3529);t.applyTextStyle=h.default;var g=n(4128);t.Browser=g.Browser,t.getBrowserInfo=g.getBrowserInfo;var v=n(5538);t.applyFormat=v.default;var m=n(4129);t.changeElementTag=m.default;var y=n(3102);t.collapseNodes=y.default;var E=n(1594);t.contains=E.default;var S=n(5539);t.extractClipboardEvent=S.default;var b=n(2575);t.findClosestElementAncestor=b.default;var C=n(4121);t.fromHtml=C.default;var N=n(3106);t.getComputedStyles=N.default,t.getComputedStyle=N.getComputedStyle;var P=n(5540);t.getPendableFormatState=P.default,t.PendableFormatCommandMap=P.PendableFormatCommandMap;var O=n(1363);t.getTagOfNode=O.default;var T=n(2804);t.isBlockElement=T.default;var _=n(2384);t.isNodeEmpty=_.default;var w=n(5541);t.isRtl=w.default;var A=n(3528);t.isVoidHtmlElement=A.default;var M=n(5542);t.matchLink=M.default;var x=n(5543);t.adjustNodeInsertPosition=x.default;var k=n(3108);t.queryElements=k.default;var R=n(2573);t.splitParentNode=R.default,t.splitBalancedNodeRange=R.splitBalancedNodeRange;var B=n(3109);t.unwrap=B.default;var L=n(2574);t.wrap=L.default;var D=n(2040);t.getNextLeafSibling=D.getNextLeafSibling,t.getPreviousLeafSibling=D.getPreviousLeafSibling;var I=n(4126);t.getFirstLeafNode=I.getFirstLeafNode,t.getLastLeafNode=I.getLastLeafNode;var F=n(5544);t.getTextContent=F.default;var j=n(3530);t.splitTextNode=j.default;var U=n(2186);t.toArray=U.default;var H=n(4131);t.VTable=H.default;var z=n(4132);t.VList=z.default;var V=n(5546);t.createVListFromRegion=V.default;var K=n(5547);t.getRegionsFromRange=K.default;var q=n(4133);t.getSelectedBlockElementsInRegion=q.default;var W=n(5549);t.collapseNodesInRegion=W.default;var G=n(3533);t.isNodeInRegion=G.default;var Q=n(1735);t.Position=Q.default;var Z=n(2187);t.createRange=Z.default,t.getRangeFromSelectionPath=Z.getRangeFromSelectionPath;var Y=n(5550);t.getPositionRect=Y.default;var $=n(4130);t.isPositionAtBeginningOf=$.default;var J=n(4134);t.getSelectionPath=J.default;var X=n(5551);t.getHtmlWithSelectionPath=X.default;var ee=n(5552);t.setHtmlWithSelectionPath=ee.default;var te=n(5553);t.addSnapshot=te.default;var ne=n(3534);t.canMoveCurrentSnapshot=ne.default;var re=n(4135);t.clearProceedingSnapshots=re.default;var oe=n(5554);t.moveCurrentSnapsnot=oe.default;var ie=n(2975);t.createSnapshots=ie.default},1363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}},1594:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1146);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(r.isRange(t)&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&e.contains(t)))}},1644:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5559);t.Keys=r.Keys;var o=n(5560);t.Editor=o.default;var i=n(4153);t.Undo=i.default;var a=n(4147);t.EditPlugin=a.default;var u=n(4151);t.MouseUpPlugin=u.default;var s=n(4146);t.DOMEventPlugin=s.default;var l=n(4152);t.TypeInContainerPlugin=l.default;var c=n(4148);t.FirefoxTypeAfterLink=c.default;var d=n(4144);t.CopyPlugin=d.default;var f=n(3536);t.cacheGetEventData=f.default;var p=n(4150);t.clearEventDataCache=p.default;var h=n(4149);t.cacheGetContentSearcher=h.cacheGetContentSearcher,t.clearContentSearcherCache=h.clearContentSearcherCache;var g=n(5574);t.cacheGetElementAtCursor=g.default;var v=n(4155);t.isModifierKey=v.default;var m=n(4154);t.isCharacterValue=m.default;var y=n(3535);t.isCtrlOrMetaPressed=y.default},1735:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2575),o=n(2803),i=function(){function e(e,t,n){switch(this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=a(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=a(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=u(this.node),this.isAtEnd=!0;break;default:var o=u(this.node);this.offset=Math.max(0,Math.min(t,o)),this.isAtEnd=t>0&&t>=o}this.element=r.default(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType;){var r=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:o.default(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function a(e){for(var t=0;e=e.previousSibling;)t++;return t}function u(e){return 3==e.nodeType?e.nodeValue.length:1==e.nodeType?e.childNodes.length:1}t.default=i},1991:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5533);t.changeFontSize=r.default,t.FONT_SIZES=r.FONT_SIZES;var o=n(5555);t.clearBlockFormat=o.default,t.TAGS_TO_UNWRAP=o.TAGS_TO_UNWRAP,t.TAGS_TO_STOP_UNWRAP=o.TAGS_TO_STOP_UNWRAP,t.ATTRIBUTES_TO_PRESERVE=o.ATTRIBUTES_TO_PRESERVE;var i=n(5556);t.clearFormat=i.default;var a=n(5557);t.createLink=a.default;var u=n(5558);t.getFormatState=u.default,t.getElementBasedFormatState=u.getElementBasedFormatState,t.getStyleBasedFormatState=u.getStyleBasedFormatState;var s=n(5575);t.insertImage=s.default;var l=n(5576);t.insertTable=l.default;var c=n(5577);t.editTable=c.default;var d=n(5578);t.formatTable=d.default;var f=n(5579);t.removeLink=f.default;var p=n(5580);t.replaceWithNode=p.default;var h=n(5581);t.setAlignment=h.default;var g=n(4137);t.setBackgroundColor=g.default;var v=n(4140);t.setTextColor=v.default;var m=n(5582);t.setDirection=m.default;var y=n(4138);t.setFontName=y.default;var E=n(4139);t.setFontSize=E.default;var S=n(5583);t.setImageAltText=S.default;var b=n(5584);t.setIndentation=b.default;var C=n(4141);t.toggleBold=C.default;var N=n(5586);t.toggleBullet=N.default;var P=n(4142);t.toggleItalic=P.default;var O=n(5587);t.toggleNumbering=O.default;var T=n(5588);t.toggleBlockQuote=T.default;var _=n(5589);t.toggleCodeBlock=_.default;var w=n(5590);t.toggleStrikethrough=w.default;var A=n(5591);t.toggleSubscript=A.default;var M=n(5592);t.toggleSuperscript=M.default;var x=n(4143);t.toggleUnderline=x.default;var k=n(5593);t.toggleHeader=k.default;var R=n(1e3);t.getPendableFormatState=R.getPendableFormatState},2040:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594),o=n(1363),i=n(3105);function a(e,t,n,a,u){var s=null,l=n?function(e){return e.nextSibling}:function(e){return e.previousSibling},c=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(r.default(e,t))for(var d=t,f=!0;f;){var p=d.parentNode;for(d=l(d);!d&&p!=e;)d=l(p),p=p.parentNode;for(;d&&(!a||a.indexOf(o.default(d))<0)&&c(d);)d=c(d);if(!(f=d&&i.default(d,u))){s=d;break}}return s}t.getLeafSibling=a,t.getNextLeafSibling=function(e,t,n){return a(e,t,!0,n)},t.getPreviousLeafSibling=function(e,t,n){return a(e,t,!1,n)}},2185:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3102),o=n(1594),i=n(1363),a=n(2804),u=n(3527),s=n(4120);function l(e,t,n){var r=e;if("BR"==i.default(r)&&n)return r;for(;r;){for(var o=e;!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if(a.default(o))return r;if("BR"==i.default(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}t.default=function(e,t){if(!o.default(e,t))return null;var n=s.default.getBlockContext(t);if(n==t)return new u.default(n);var i=l(t,n,!1),c=l(t,n,!0),d=r.default(e,i,c,!1);if(i=d[0],c=d[d.length-1],i.parentNode!=c.parentNode)return new s.default(e,i,c);for(;!i.previousSibling&&!c.nextSibling;){var f=i.parentNode;if(f==n){n!=e&&(i=c=f);break}i=c=f}return i==c&&a.default(i)?new u.default(i):new s.default(e,i,c)}},2186:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},2187:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3528),o=n(1735),i=n(1146);function a(e,t,n,r){var a,c;if(s(e)?(a=e,c=s(t)?t:null):i.isNode(e)&&(Array.isArray(t)?(a=l(e,t),c=Array.isArray(n)?l(e,n):null):"number"==typeof t?(a=new o.default(e,t),c=i.isNode(n)?new o.default(n,r):null):!i.isNode(t)&&t||(a=new o.default(e,-2),c=new o.default(t||e,-3))),a&&a.node){var d=a.node.ownerDocument.createRange();return a=u(a),c=u(c||a),d.setStart(a.node,a.offset),d.setEnd(c.node,c.offset),d}return null}function u(e){return 1==e.node.nodeType&&r.default(e.node)?new o.default(e.node,e.isAtEnd?-3:-2):e}function s(e){return e&&e.node}function l(e,t){if(!e||!t)return null;for(var n,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new o.default(e,n)}t.default=a,t.getRangeFromSelectionPath=function(e,t){return a(e,t.start,t.end)}},2188:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o=null;t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},i=e.getSelectionRange();i&&i.collapsed?(e.addUndoSnapshot(),n(),function(e){o||(o=Object.keys(r.PendableFormatCommandMap).map((function(e){return r.PendableFormatCommandMap[e]})));return o.indexOf(e)>=0}(t)&&e.triggerPluginEvent(12,{formatState:r.getPendableFormatState(e.getDocument())})):e.addUndoSnapshot(n,"Format")}},2384:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1363),o=["IMG"],i=["TABLE","IMG","LI"].join(","),a=/\u200b/g;function u(e,t){return e=e.replace(a,""),t?e.trim():e}t.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==u(e.nodeValue,t);if(1==e.nodeType){var n=e;if(""!=u(n.textContent,t)||o.indexOf(r.default(n))>=0||n.querySelectorAll(i)[0])return!1}return!0}},2573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2803);function o(e,t){if(!e||!e.parentNode)return null;var n=e.parentNode,r=n.cloneNode(!1);if(r.removeAttribute("id"),t)for(;n.firstChild&&n.firstChild!=e;)r.appendChild(n.firstChild);else for(;e.nextSibling;)r.appendChild(e.nextSibling);return r.firstChild&&""!=r.innerHTML?n.parentNode.insertBefore(r,t?n:n.nextSibling):r=null,r}t.default=o,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,i=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(i){if(r.default(t,n)){var a=n;n=t,t=a}o(t,!0),o(n,!1)}return i}},2574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4121),o=n(1146);t.default=function(e,t){if(0==(e=e?o.isNode(e)?[e]:e:[]).length||!e[0])return null;if(!o.isHTMLElement(t)){var n=e[0].ownerDocument;t=/^\w+$/.test(t=t||"div")?n.createElement(t):r.default(t,n)[0]}var i=e[0].parentNode;i&&i.insertBefore(t,e[0]);for(var a=0,u=e;a<u.length;a++){var s=u[a];t.appendChild(s)}return t}},2575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594);t.default=function(e,t,n){var o=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(o&&n)if(o.closest)o=o.closest(n);else for(;o&&o!=t&&!(o.matches||o.msMatchesSelector).call(o,n);)o=o.parentElement;return!t||r.default(t,o)?o:null}},2576:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2185),o=n(1363),i=n(4123),a=n(4124),u=n(3104),s=n(1146);t.default=function(e,t){var n=s.isNode(e)?r.default(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],s=e.parentNode;s&&t.contains(s);s=s.parentNode)r.push(s);for(var l=r.length-1;l>=0&&!n;l--){var c=r[l],d=o.default(c);"A"==d?n=new a.default(c,t):"IMG"==d&&(n=new i.default(c,t))}return n||new u.default(e,t)}(t,n)}},2802:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o="​";t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var i=n.startContainer;if("SPAN"==r.getTagOfNode(i)&&(!i.firstChild||"BR"==r.getTagOfNode(i.firstChild)&&!i.firstChild.nextSibling))e.addUndoSnapshot(),t(i);else i&&3==i.nodeType&&i.nodeValue==o&&"SPAN"==r.getTagOfNode(i.parentNode)||(e.addUndoSnapshot(),i=e.getDocument().createTextNode(o),n.insertNode(i)),r.applyTextStyle(i,t),e.select(i,-1)}else e.addUndoSnapshot((function(){for(var n,r,o=e.getSelectionTraverser(),i=o&&o.currentInlineElement;i;){var a=o.getNextInlineElement();i.applyStyle((function(e,o){t(e,o),n=n||e,r=e})),i=a}n&&r&&e.select(n,-2,r,-3)}),"Format")}},2803:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},2804:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1363),o="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),i=["block","list-item","table-cell"];t.default=function(e){var t=r.default(e);return!(!t||!(i.indexOf(e.style.display)>=0||o.indexOf(t)>=0))}},3102:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594),o=n(2573),i=n(2186);function a(e,t,n,i,a){for(;t.parentNode!=e&&!r.default(t.parentNode,n);){if(i&&t.previousSibling||!i&&t.nextSibling){if(!a)break;o.default(t,i)}t=t.parentNode}return t}t.default=function(e,t,n,o){if(!r.default(e,t)||!r.default(e,n))return[];if(t=a(e,t,n,!0,o),n=a(e,n,t,!1,o),r.default(t,n,!0))return[t];if(r.default(n,t))return[n];if(t.parentNode==n.parentNode){var u=i.default(t.parentNode.childNodes),s=u.indexOf(t),l=u.indexOf(n);return u.slice(s,l+1)}return[t,n]}},3103:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5534),o=n(4127),i=n(2185),a=n(2576),u=n(3107),s=n(5535),l=n(5536),c=n(3531),d=n(2040),f=function(){function e(e,t){this.scoper=e,this.skipTags=t}return e.createBodyTraverser=function(t,n,o){return new e(new r.default(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new l.default(t,n),r)},e.createBlockTraverser=function(t,n,r,o){return void 0===r&&(r=3),new e(new s.default(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!0,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=d.getLeafSibling(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?i.default(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof o.default?null:this.currentInline},enumerable:!0,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof o.default?(t=c.getInlineElementBeforeAfter(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof u.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var o=t.getContainerNode();return o=d.getLeafSibling(e,o,n),a.default(e,o)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();t.default=f},3104:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3529),o=n(2803),i=n(1735),a=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return 3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new i.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new i.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&o.default(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){r.default(this.containerNode,e)},e}();t.default=a},3105:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1363),o=n(3106),i=/^[\r\n]+$/gm,a=/[\t\r\n\u0020\u200B]/gm;t.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!i.test(t.nodeValue))||!(!n||""!=t.nodeValue.replace(a,""));if(1==t.nodeType){if("none"==o.getComputedStyle(t,"display"))return!0;var u=r.default(t);if("DIV"==u||"SPAN"==u){for(var s=t.firstChild;s;s=s.nextSibling)if(!e(s,n))return!1;return!0}return!1}return!0}},3106:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2575);function o(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n=r.default(e),o=[];if(t=Array.isArray(t)?t:[t],n){var a=(n.ownerDocument.defaultView||window).getComputedStyle(n);if(a)for(var u=0,s=t;u<s.length;u++){var l=s[u],c=(a.getPropertyValue(l)||"").toLowerCase();c="font-size"==l?i(c):c,o.push(c)}}return o}function i(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}t.default=o,t.getComputedStyle=function(e,t){return o(e,t)[0]||""}},3107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3529),o=n(2187),i=n(1735),a=n(2040),u=function(){function e(e,t,n){this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return o.default(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end&&new e(this.inlineElement,this.end,null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start&&new e(this.inlineElement,null,this.start)},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),o=this.getContainerNode();if(t.isAtEnd){var u=a.getNextLeafSibling(o,t.node);t=u?new i.default(u,0):null}if(0==n.offset){var s=a.getPreviousLeafSibling(o,n.node);n=s?new i.default(s,-1):null}r.default(o,e,t,n)},e}();t.default=u},3108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2186);function o(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}t.default=function(e,t,n,i,a){if(void 0===i&&(i=0),!e||!t)return[];var u=r.default(e.querySelectorAll(t));if(0!=i&&a){var s=a.startContainer,l=a.startOffset,c=a.endContainer,d=a.endOffset;if(1==s.nodeType&&s.firstChild){var f=s.childNodes[l];s=f||s.lastChild}c=1==c.nodeType&&c.firstChild&&d>0?c.childNodes[d-1]:c,u=u.filter((function(e){return function(e,t,n,r){var i=e.compareDocumentPosition(t),a=e.compareDocumentPosition(n),u=[0,8];r||u.push(16);return o(i,u)||o(a,u)||o(i,[2])&&o(a,[4])&&!o(a,[16])}(e,s,c,2==i)}))}return n&&u.forEach(n),u}},3109:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},3527:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594),o=n(2803),i=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return o.default(this.element,e.getEndNode())},e.prototype.contains=function(e){return r.default(this.element,e,!0)},e.prototype.getTextContent=function(){return this.element.textContent},e}();t.default=i},3528:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1363),o="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&o.indexOf(r.default(e))>=0}},3529:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1363),o=n(1735),i=n(3530),a=n(2574),u=n(2040),s=n(2573),l="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function c(e,t){e&&1==e.nodeType&&t(e,!0)}t.default=function(e,t,n,d){void 0===n&&(n=new o.default(e,0).normalize()),void 0===d&&(d=new o.default(e,-1).normalize());for(var f=[];n&&d&&d.isAfter(n);){var p=n.node,h=r.default(p.parentNode),g=u.getNextLeafSibling(e,p);3==p.nodeType&&["TR","TABLE"].indexOf(h)<0&&(p!=d.node||d.isAtEnd||(p=i.default(p,d.offset,!0)),n.offset>0&&(p=i.default(p,n.offset,!1)),f.push(p)),n=g&&new o.default(g,0)}if(f.length>0){if(f.every((function(e){return e.parentNode==f[0].parentNode}))){var v=f.shift();f.forEach((function(e){v.nodeValue+=e.nodeValue,e.parentNode.removeChild(e)})),f=[v]}f.forEach((function(e){for(;"SPAN"!=r.default(e)&&l.indexOf(r.default(e.parentNode))>=0;)c(e,t),e=s.splitBalancedNodeRange(e);"SPAN"!=r.default(e)&&(c(e,t),e=a.default(e,"SPAN")),t(e)}))}}},3530:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e.nodeValue.substr(0,t),o=e.nodeValue.substr(t),i=e.ownerDocument.createTextNode(n?r:o);return e.nodeValue=n?o:r,e.parentNode.insertBefore(i,n?e:e.nextSibling),i}},3531:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2576),o=n(3107),i=n(3105),a=n(2040);function u(e,t,n){if(!e||!t||!t.node)return null;var u=(t=t.normalize()).node,s=t.offset,l=t.isAtEnd,c=!1;!n&&0==s&&!l||n&&l?u=a.getLeafSibling(e,u,n):3==u.nodeType&&(!n&&!l||n&&s>0)&&(c=!0),u&&i.default(u)&&(u=a.getLeafSibling(e,u,n));var d=r.default(e,u);return d&&(c||d.contains(t))&&(d=n?new o.default(d,t,null):new o.default(d,null,t)),d}t.getInlineElementBefore=function(e,t){return u(e,t,!1)},t.getInlineElementAfter=function(e,t){return u(e,t,!0)},t.getInlineElementBeforeAfter=u},3532:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1363);function o(e){switch(r.default(e)){case"OL":return 1;case"UL":return 2;default:return 0}}t.default=o,t.isListElement=function(e){return 0!=o(e)}},3533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594);t.default=function(e,t){return!(!e||!r.default(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}},3534:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},3535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=r},3536:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}},3537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.default=function(e,t){var n=e.getElementAtCursor("OL,UL");if(r.Browser.isChrome&&"indent"!==t){var o=e.getElementAtCursor("LI");if(o){var i=e.getSelectionRange(),a=r.getSelectionPath(o,i);if(i&&(i.collapsed||e.getElementAtCursor("LI",i.startContainer)==o&&e.getElementAtCursor("LI",i.endContainer)==o))if("OL"===n.tagName&&"insertUnorderedList"===t||"UL"===n.tagName&&"insertOrderedList"===t)e.getDocument().execCommand(t,!1,null);else{var u=n.parentElement;if("OL"==u.tagName||"UL"==u.tagName)o.nextElementSibling&&r.splitBalancedNodeRange(o),n.insertAdjacentElement("afterend",o),e.select(r.createRange(o,a.start,a.end));else{o.nextElementSibling&&r.splitBalancedNodeRange(o);var s=r.wrap(r.toArray(o.childNodes)),l=r.createRange(s,a.start,a.end),c=r.getSelectionPath(s,l);n.insertAdjacentElement("afterend",s),e.deleteNode(o);var d=r.createRange(s,c.start,c.end);e.select(d)}0==n.childElementCount&&e.deleteNode(n)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null)}else e.getDocument().execCommand(t,!1,null);var f=e.getElementAtCursor("OL,UL");return f==n&&(f=null),f}},4120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3102),o=n(1594),i=n(1363),a=n(2804),u=n(2803),s=n(2574),l=n(2573),c=n(2187),d=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(;e&&!a.default(e);)e=e.parentNode;return e},e.prototype.collapseToSingleElement=function(){for(var t=r.default(e.getBlockContext(this.startNode),this.startNode,this.endNode,!0),n=e.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&d.indexOf(i.default(t[0].parentNode))<0;)t=[l.splitBalancedNodeRange(t)];return 1==t.length&&a.default(t[0])?t[0]:s.default(t)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return u.default(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return o.default(this.startNode,e,!0)||o.default(this.endNode,e,!0)||u.default(e,this.startNode)&&u.default(this.endNode,e)},e.prototype.getTextContent=function(){return c.default(this.getStartNode(),this.getEndNode()).toString()},e}();t.default=f},4121:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2186);t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,r.default(n.childNodes)}},4122:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2185);function o(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&r.default(e,n)}t.default=o,t.getFirstBlockElement=function(e){return o(e,!0)},t.getLastBlockElement=function(e){return o(e,!1)}},4123:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(3104).default);t.default=i},4124:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(3104).default);t.default=i},4125:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2576),o=n(4126);t.getFirstInlineElement=function(e){var t=o.getFirstLeafNode(e);return t?r.default(e,t):null},t.getLastInlineElement=function(e){var t=o.getLastLeafNode(e);return t?r.default(e,t):null}},4126:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3105),o=n(2040);function i(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},i=n(e);i&&n(i);)i=n(i);return i&&r.default(i)&&(i=o.getLeafSibling(e,i,t)),i}t.getFirstLeafNode=function(e){return i(e,!0)},t.getLastLeafNode=function(e){return i(e,!1)}},4127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=r},4128:function(e,t,n){"use strict";function r(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||n,o=!1,i=!1,a=!1,u=!1,s=-1!=e.indexOf("WebKit");return r||(o=-1!=e.indexOf("Chrome"),i=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(u=-1!=e.indexOf("Edge"))&&(s=o=i=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:s,isIE:r,isIE11OrGreater:n,isSafari:a,isChrome:o,isFirefox:i,isEdge:u,isIEOrEdge:r||u}}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=r,t.Browser=window?r(window.navigator.userAgent,window.navigator.appVersion):{}},4129:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3106),o=n(1363);t.default=function(e,t){var n;if(!e||!t)return null;for(var i=e.ownerDocument.createElement(t),a=0;a<e.attributes.length;a++){var u=e.attributes[a];i.setAttribute(u.name,u.value)}for(;e.firstChild;)i.appendChild(e.firstChild);return"P"!=o.default(e)&&"P"!=o.default(i)||(n=r.default(e,["margin-top","margin-bottom"]),i.style.marginTop=n[0],i.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(i,e),i}},4130:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594),o=n(1363),i=n(2384);function a(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==o.default(e)||!i.default(e))return!1;return!0}t.default=function(e,t){if(e){var n=e.normalize(),o=n.node;if(0==n.offset){for(;r.default(t,o)&&a(o);)o=o.parentNode;return o==t}}return!1}},4131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1146),o=n(1e3),i=function(){function e(e){var t=this;if(this.trs=[],this.table=r.isHTMLTableElement(e)?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var n=r.isHTMLTableElement(e)?null:e,i=o.toArray(this.table.rows);this.cells=i.map((function(e){return[]})),i.forEach((function(e,r){t.trs[r%2]=e;for(var o=0,i=0;o<e.cells.length;o++){for(;t.cells[r][i];i++);var a=e.cells[o];a==n&&(t.col=i,t.row=r);for(var u=0;u<a.colSpan;u++,i++)for(var s=0;s<a.rowSpan;s++)t.cells[r+s][i]={td:u+s==0?a:null,spanLeft:u>0,spanAbove:s>0}}}))}}return e.prototype.writeBack=function(){var e=this;this.cells?(l(this.table),this.cells.forEach((function(t,n){var r=s(e.trs[n%2]||e.trs[0]);e.table.appendChild(r),t.forEach((function(t,o){t.td&&(e.recalcSpans(n,o),r.appendChild(t.td))}))}))):this.table&&this.table.parentNode.removeChild(this.table)},e.prototype.applyFormat=function(e){e&&this.table&&(this.table.style.borderCollapse="collapse",this.trs[0].style.backgroundColor=e.bgColorOdd||"transparent",this.trs[1]&&(this.trs[1].style.backgroundColor=e.bgColorEven||"transparent"),this.cells.forEach((function(t){return t.filter((function(e){return e.td})).forEach((function(t){t.td.style.borderTop=a(e.topBorderColor),t.td.style.borderBottom=a(e.bottomBorderColor),t.td.style.borderLeft=a(e.verticalBorderColor),t.td.style.borderRight=a(e.verticalBorderColor)}))})))},e.prototype.edit=function(e){var t=this;if(this.table){var n=this.cells[this.row],r=n[this.col];switch(e){case 0:this.cells.splice(this.row,0,n.map(u));break;case 1:var o=this.row+this.countSpanAbove(this.row,this.col);this.cells.splice(o,0,this.cells[o-1].map((function(e,n){var r=t.getCell(o,n);if(r.spanAbove)return u(r);if(e.spanLeft){var i=u(e);return i.spanAbove=!1,i}return{td:s(t.getTd(t.row,n))}})));break;case 2:this.forEachCellOfCurrentColumn((function(e,n){n.splice(t.col,0,u(e))}));break;case 3:var i=this.col+this.countSpanLeft(this.row,this.col);this.forEachCellOfColumn(i-1,(function(e,n,r){var o,a=t.getCell(r,i);a.spanLeft?o=u(a):e.spanAbove?(o=u(e)).spanLeft=!1:o={td:s(t.getTd(r,t.col))},n.splice(i,0,o)}));break;case 6:this.forEachCellOfCurrentRow((function(e,n){var r=t.getCell(t.row+1,n);e.td&&e.td.rowSpan>1&&r.spanAbove&&(r.td=e.td)})),this.cells.splice(this.row,1);break;case 5:this.forEachCellOfCurrentColumn((function(e,n,r){var o=t.getCell(r,t.col+1);e.td&&e.td.colSpan>1&&o.spanLeft&&(o.td=e.td),n.splice(t.col,1)}));break;case 7:case 8:for(var a=7==e?-1:1,c=this.row+a;c>=0&&c<this.cells.length;c+=a){if((g=this.getCell(c,this.col)).td&&!g.spanAbove){var d=c<this.row?g:r,f=c<this.row?r:g;d.td.colSpan==f.td.colSpan&&(l(f.td,d.td),f.td=null,f.spanAbove=!0);break}}break;case 9:case 10:for(var p=9==e?-1:1,h=this.col+p;h>=0&&h<this.cells[this.row].length;h+=p){var g;if((g=this.getCell(this.row,h)).td&&!g.spanLeft){var v=h<this.col?g:r,m=h<this.col?r:g;v.td.rowSpan==m.td.rowSpan&&(l(m.td,v.td),m.td=null,m.spanLeft=!0);break}}break;case 4:this.cells=null;break;case 12:if(r.td.rowSpan>1)this.getCell(this.row+1,this.col).td=s(r.td);else{var y=n.map((function(e){return{td:e==r?s(e.td):null,spanAbove:e!=r,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,y)}break;case 11:r.td.colSpan>1?this.getCell(this.row,this.col+1).td=s(r.td):this.forEachCellOfCurrentColumn((function(e,r){r.splice(t.col+1,0,{td:r==n?s(e.td):null,spanAbove:e.spanAbove,spanLeft:r!=n})}))}}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){for(var n=0;n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){for(var n=0;n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalcSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},e}();function a(e){return"solid 1px "+(e||"transparent")}function u(e){return{td:s(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function s(e){var t=e?e.cloneNode(!1):null;return r.isHTMLTableCellElement(t)&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}function l(e,t){for(;e.firstChild;)t?t.appendChild(e.firstChild):e.removeChild(e.firstChild)}t.default=i},4132:function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3532),i=n(1363),a=n(2804),u=n(2384),s=n(1735),l=n(3108),c=n(2573),d=n(2186),f=n(3109),p=n(5545),h=n(2574),g=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");v(this.rootList),l.default(this.rootList,"ol,ul",v),l.default(this.rootList,"li",m),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getFirstOrLastNode=function(e){var t=this.items[e?this.items.length-1:0];return null==t?void 0:t.getNode()},e.prototype.writeBack=function(){if(!this.rootList)throw new Error("rootList must not be null");var e=[this.rootList.ownerDocument.createDocumentFragment()];this.items.forEach((function(t){return t.writeBack(e)})),this.rootList.parentNode.replaceChild(e[0],this.rootList),this.rootList=null},e.prototype.setIndentation=function(e,t,n){this.findListItems(e,t,(function(e){return 1==n?e.outdent():e.indent()}))},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.appendItem=function(e,t){e="LI"==i.default(e)?e:h.default(e,"li"),this.items.push(0==t?new p.default(e):new p.default(e,t))},e.prototype.mergeVList=function(e){var t,n=this;if(e&&e!=this){var r=this.items.length;e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),this.mergeOrphanNodesAfter(r-1),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList)}},e.prototype.mergeOrphanNodesAfter=function(e){var t=this.items[e];if(t&&!t.isOrphanItem())for(var n=e+1;n<=this.items.length;n++)if(!t||!t.canMerge(this.items[n])){t.mergeItems(this.items.splice(e+1,n-e-1));break}},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new s.default(this.items[0].getNode(),0),o=new s.default(this.items[this.items.length-1].getNode(),-1),i=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(o)?1:0);this.items.forEach((function(n,r){i=n.contains(e.node)?r:i,a=n.contains(t.node)?r:a})),i=a<this.items.length?Math.max(0,i):i,a=i>=0?Math.min(this.items.length-1,a):a;var u=i<=a?this.items.slice(i,a+1):[];return n&&(u.forEach(n),this.mergeOrphanNodesAfter(a)),u},e.prototype.populateItems=function(e,t){void 0===t&&(t=[]);for(var n=o.default(e),i=e.firstChild;i;i=i.nextSibling){var a=r(t,[n]);o.isListElement(i)?this.populateItems(i,a):3==i.nodeType&&""==i.nodeValue.trim()||this.items.push(new(p.default.bind.apply(p.default,r([void 0,i],a))))}},e}();function v(e){var t=null;d.default(e.childNodes).forEach((function(e){"LI"==i.default(e)?t=e:o.isListElement(e)?t=null:t&&!u.default(e,!0)&&t.appendChild(a.default(e)?e:h.default(e))}))}function m(e){for(;!o.isListElement(e.parentNode);){c.default(e,!0);var t=d.default(e.parentNode.childNodes).slice(1);t.length>0&&(a.default(t[0])||(t=[h.default(t)]),t.forEach((function(t){return e.appendChild(t)}))),f.default(e.parentNode)}}t.default=g},4133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3103),o=n(2187),i=n(1735),a=n(2040);t.default=function(e){if(!e)return[];var t=e.nodeBefore,n=e.nodeAfter,u=e.rootNode,s=e.skipTags,l=e.fullSelectionEnd,c=e.fullSelectionStart,d=t?a.getNextLeafSibling(e.rootNode,t,e.skipTags):u.firstChild,f=n?a.getPreviousLeafSibling(u,n,s):u.lastChild,p=[];if(d&&f){var h=o.default(d,f),g=i.default.getStart(h).normalize(),v=i.default.getEnd(h).normalize();if(!c.isAfter(v)&&!g.isAfter(l))for(var m=c.isAfter(g)?c:g,y=l.isAfter(v)?v:l,E=o.default(m,y),S=r.default.createSelectionTraverser(u,E,s),b=null==S?void 0:S.currentBlockElement;b;b=S.getNextBlockElement())p.push(b)}return p}},4134:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594),o=n(1735);function i(e,t){if(!e||!t)return[];var n,o=e.node,i=e.offset,a=[];if(!r.default(t,o,!0))return[];if(3==o.nodeType){for(n=o.parentNode;o.previousSibling&&3==o.previousSibling.nodeType;)i+=o.previousSibling.nodeValue.length,o=o.previousSibling;a.unshift(i)}else n=o,o=o.childNodes[i];do{i=0;for(var u=!1,s=n.firstChild;s&&s!=o;s=s.nextSibling){if(3==s.nodeType){if(0==s.nodeValue.length||u)continue;u=!0}else u=!1;i++}a.unshift(i),o=n,n=n.parentNode}while(o&&o!=t);return a}t.default=function(e,t){return t?{start:i(o.default.getStart(t),e),end:i(o.default.getEnd(t),e)}:null}},4135:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3534);t.default=function(e){if(r.default(e,1)){for(var t=0,n=e.currentIndex+1;n<e.snapshots.length;n++)t+=e.snapshots[n].length;e.snapshots.splice(e.currentIndex+1),e.totalSize-=t}}},4136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);function o(e){var t=e.getStartNode();return e instanceof r.StartEndBlockElement&&t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(r.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),r=n&&n.currentBlockElement,i=[];r;)o(r)||i.push(r),r=n.getNextBlockElement();i.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},4137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2802);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.backgroundColor=t?"":n}))}else{var o=e.isDarkMode(),i=o?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.backgroundColor=n?"":i,o&&(e.dataset.ogsb=t.lightModeColor)}))}}},4138:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2802);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontFamily=n?"":t}))}},4139:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2802),o=n(1e3);t.default=function(e,t){t=t.trim(),r.default(e,(function(e,n){e.style.fontSize=n?"":t,"normal"!=o.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))}},4140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2802);t.default=function(e,t){if("string"==typeof t){var n=t.trim();r.default(e,(function(e,t){e.style.color=t?"":n}))}else{var o=e.isDarkMode(),i=o?t.darkModeColor:t.lightModeColor;r.default(e,(function(e,n){e.style.color=n?"":i,o&&(e.dataset.ogsc=t.lightModeColor)}))}}},4141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188);t.default=function(e){r.default(e,"bold")}},4142:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188);t.default=function(e){r.default(e,"italic")}},4143:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188);t.default=function(e){r.default(e,"underline")}},4144:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4145),o=function(){function e(){var e=this;this.onExtract=function(t){return function(n){if(e.editor&&e.editor.isDarkMode()){var o=e.editor.getSelectionRange();if(o&&!o.collapsed){var i=n,a=e.editor.getSelectionRange().cloneContents(),u=r.default(a),s=e.editor.getDocument().createElement("div");s.setAttribute("contenteditable","true"),s.innerHTML=u,i.clipboardData.setData("text/html",u),i.clipboardData.setData("text/plain",s.innerText),t&&e.editor.getSelectionRange().deleteContents(),n.preventDefault()}}}}}return e.prototype.getName=function(){return"Copy"},e.prototype.initialize=function(e){this.editor=e,this.eventDisposer=e.addDomEventHandler({copy:this.onExtract(!1),cut:this.onExtract(!0)})},e.prototype.dispose=function(){this.eventDisposer(),this.eventDisposer=null,this.editor=null},e}();t.default=o},4145:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1146),o=n(1e3);function i(e){return e&&"undefined"!=e&&"null"!=e}t.default=function(e){var t=document.createElement("div");t.setAttribute("contenteditable","true"),r.isDocumentFragment(e)?t.appendChild(e):t.innerHTML=e;var n=t.getElementsByTagName("*");return o.toArray(n).forEach((function(e){e.dataset&&(e.style.color=i(e.dataset.ogsc)?e.dataset.ogsc:"",e.style.backgroundColor=i(e.dataset.ogsb)?e.dataset.ogsb:"",i(e.dataset.ogac)?e.setAttribute("color",e.dataset.ogac):e.removeAttribute("color"),i(e.dataset.ogab)?e.setAttribute("bgcolor",e.dataset.ogab):e.removeAttribute("bgcolor"),e.dataset.ogsc&&delete e.dataset.ogsc,e.dataset.ogsb&&delete e.dataset.ogsb,e.dataset.ogac&&delete e.dataset.ogac,e.dataset.ogab&&delete e.dataset.ogab)})),t.innerHTML}},4146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o=function(){function e(e){var t=this;this.disableRestoreSelectionOnFocus=e,this.inIme=!1,this.onNativeEvent=function(e){t.editor.runAsync((function(){t.editor.addUndoSnapshot((function(){}),"cut"==e.type?"Cut":"Drop")}))},this.onFocus=function(){if(t.disableRestoreSelectionOnFocus){if(t.cachedPosition&&t.cachedFormatState){var e=t.editor.getSelectionRange();e.collapsed&&r.Position.getStart(e).normalize().equalTo(t.cachedPosition)?t.restorePendingFormatState():t.clear()}}else t.editor.restoreSavedRange()},this.onBlur=function(){t.editor.saveSelectionRange()},this.onScroll=function(e){t.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:t.editor.getScrollContainer()})}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n=this;this.editor=e,this.disposer=e.addDomEventHandler(((t={compositionstart:function(){return n.inIme=!0},compositionend:function(t){n.inIme=!1,e.triggerPluginEvent(3,{rawEvent:t})},drop:this.onNativeEvent,cut:this.onNativeEvent,focus:this.onFocus})[r.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.onBlur,t)),this.editor.getScrollContainer().addEventListener("scroll",this.onScroll)},e.prototype.dispose=function(){this.editor.getScrollContainer().removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null,this.clear()},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 12:this.cachedPosition=this.getCurrentPosition(),this.cachedFormatState=e.formatState;break;case 0:case 4:case 6:this.cachedPosition&&!this.cachedPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.restorePendingFormatState=function(){var e=this;if(this.cachedFormatState){var t=r.getPendableFormatState(this.editor.getDocument());Object.keys(r.PendableFormatCommandMap).forEach((function(n){e.cachedFormatState[n]!=t[n]&&e.editor.getDocument().execCommand(r.PendableFormatCommandMap[n],!1,null)})),this.cachedPosition=this.getCurrentPosition()}},e.prototype.isInIME=function(){return this.inIme},e.prototype.clear=function(){this.cachedPosition=null,this.cachedFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&r.Position.getStart(e).normalize()},e}();t.default=o},4147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3535),o=function(){function e(){this.featureMap={},this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.addFeature({keys:[8],shouldHandleEvent:function(){return null!==t.autoCompleteSnapshot},handleEvent:function(e,n){e.rawEvent.preventDefault(),n.setContent(t.autoCompleteSnapshot,!1)}})},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=!1,n=this.findFeature(e);switch(e.eventType){case 6:t=this.autoCompleteChangeSource!=e.source;break;case 4:case 0:t=!0}n&&n.handleEvent(e,this.editor),t&&(this.autoCompleteSnapshot=null,this.autoCompleteChangeSource=null)},e.prototype.addFeature=function(e){var t=this;e.keys.forEach((function(n){var r=t.featureMap[n]||[];r.push(e),t.featureMap[n]=r}))},e.prototype.performAutoComplete=function(e,t){var n=this;this.editor.addUndoSnapshot((function(r,o,i){var a=e();return n.autoCompleteSnapshot=i,n.autoCompleteChangeSource=t,a}),t)},e.prototype.findFeature=function(e){var t,n=this,o=!1,i=!1;if(0==e.eventType){var a=e.rawEvent;i=r.default(a),o=i||a.altKey,t=this.featureMap[a.which]}else 6==e.eventType&&(t=this.featureMap[2048]);return t&&t.filter((function(t){return(t.allowFunctionKeys||!o)&&t.shouldHandleEvent(e,n.editor,i)}))[0]},e}();t.default=o},4148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o=n(4149),i=function(){function e(){}return e.prototype.getName=function(){return"FirefoxTypeAfterLink"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(r.Browser.isFirefox&&1==e.eventType||8==e.eventType){var t=this.editor.getSelectionRange();if(t&&t.collapsed&&this.editor.getElementAtCursor("A[href]")){var n=o.cacheGetContentSearcher(e,this.editor).getInlineElementBefore();n instanceof r.LinkInlineElement&&this.editor.select(new r.Position(n.getContainerNode(),-3))}}},e}();t.default=i},4149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3536),o=n(4150),i="CONTENTSEARCHER";t.cacheGetContentSearcher=function(e,t){return r.default(e,i,(function(){return t.getContentSearcherOfCursor()}))},t.clearContentSearcherCache=function(e){o.default(e,i)}},4150:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)&&delete e.eventDataCache[t]}},4151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(5,{rawEvent:t}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){4!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=r},4152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1146),o=n(1e3),i=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){1==e.eventType&&this.onKeyPress(e)},e.prototype.ensureTypeInElement=function(e,t){var n,r=e.normalize(),i=this.editor.getBlockElementAtNode(r.node);if(i){n=i.collapseToSingleElement();var a=o.isNodeEmpty(n)||t&&this.wasNodeJustCreatedByKeyboardEvent(t,n);n=n&&a?n:null}else n=o.fromHtml(o.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",this.editor.getDocument())[0],this.editor.insertNode(n,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),r=new o.Position(n.firstChild,0);return n&&o.applyFormat(n,this.editor.getDefaultFormat(),this.editor.isDarkMode()),r},e.prototype.onKeyPress=function(e){var t=this,n=this.editor.getSelectionRange();n&&!this.editor.contains(o.findClosestElementAncestor(n.startContainer))&&(n.collapsed?this.tryNormalizeTyping(e,n):n.collapsed||this.editor.runAsync((function(){t.tryNormalizeTyping(e)})))},e.prototype.tryNormalizeTyping=function(e,t){var n=this.ensureTypeInElement(o.Position.getStart(t||this.editor.getSelectionRange()),e);this.editor.select(n)},e.prototype.wasNodeJustCreatedByKeyboardEvent=function(e,t){return r.isNode(e.rawEvent.target)&&e.rawEvent.target.contains(t)&&e.rawEvent.key===t.innerText},e}();t.default=i},4153:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3535),o=n(5563),i=function(){function e(e,t){void 0===t&&(t=1e7),this.preserveSnapshots=e,this.maxBufferSize=t}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.preserveSnapshots||this.clear()},e.prototype.onPluginEvent=function(e){if(!this.editor.isInIME())switch(e.eventType){case 9:this.preserveSnapshots&&(this.canUndo()||this.canRedo())||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 3:this.clearRedoForInput(),this.addUndoSnapshot();break;case 6:this.isRestoring||this.clearRedoForInput()}},e.prototype.clear=function(){this.undoSnapshots=null,this.hasNewContent=!1},e.prototype.undo=function(){this.hasNewContent&&this.addUndoSnapshot(),this.restoreSnapshot(-1)},e.prototype.redo=function(){this.restoreSnapshot(1)},e.prototype.canUndo=function(){return this.hasNewContent||this.getSnapshotsManager().canMove(-1)},e.prototype.canRedo=function(){return this.getSnapshotsManager().canMove(1)},e.prototype.addUndoSnapshot=function(){var e=this.editor.getContent(!1,!0);return this.getSnapshotsManager().addSnapshot(e),this.hasNewContent=!1,e},e.prototype.getSnapshotsManager=function(){return this.undoSnapshots||(this.undoSnapshots=new o.default(this.maxBufferSize)),this.undoSnapshots},e.prototype.restoreSnapshot=function(e){var t=this.getSnapshotsManager().move(e);if(null!=t)try{this.isRestoring=!0,this.editor.setContent(t)}finally{this.isRestoring=!1}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which){var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!r.default(e)||this.addUndoSnapshot(),this.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.getSnapshotsManager().clearRedo(),this.lastKeyPress=0,this.hasNewContent=!0},e}();t.default=i},4154:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4155);t.default=function(e){return!r.default(e)&&e.key&&1==e.key.length}},4155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="Control",o="Alt",i="Meta";t.default=function(e){var t=e.ctrlKey||e.key===r,n=e.altKey||e.key===o,a=e.metaKey||e.key===i;return t||n||a}},4156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o={backgroundColors:{darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},textColors:{darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"}};t.calculateDefaultFormat=function(e,t,n){if(n&&(t.backgroundColors||(t.backgroundColors=o.backgroundColors),t.textColors||(t.textColors=o.textColors)),t&&0===Object.keys(t).length)return{};var i=(t=t||{}).fontFamily,a=t.fontSize,u=t.textColor,s=t.textColors,l=t.backgroundColor,c=t.backgroundColors,d=t.bold,f=t.italic,p=t.underline,h=i&&a&&(u||s)?null:r.getComputedStyles(e);return{fontFamily:i||h[0],fontSize:a||h[1],get textColor(){return s?n?s.darkModeColor:s.lightModeColor:u||h[2]},textColors:s,get backgroundColor(){return c?n?c.darkModeColor:c.lightModeColor:l||""},backgroundColors:c,bold:d,italic:f,underline:p}}},4157:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.hasFocus=function(e){var t=e.document.activeElement;return t&&r.contains(e.contentDiv,t,!0)}},4158:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,r){e.getSelectedRegions().forEach((function(e){return t(e,n,r)})),e.select(n,r)}),"Format")}},4159:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4158),o=n(1e3);t.default=function(e,t){r.default(e,(function(e,n,r){var i=o.createVListFromRegion(e,!0);i&&(i.changeListType(n,r,t),i.writeBack())}))}},4160:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o="&#8203;",i="LI,THEAD,TBODY,TR,TD,TH".split(","),a=function(e){};t.default=function(e,t,n,u,s){void 0===u&&(u=function(e){return r.wrap(e,t)}),void 0===s&&(s=r.unwrap),e.focus(),e.addUndoSnapshot((function(l,c){var d,f=e.getSelectionRange();if(f&&0==e.queryElements(t,1,s).length){var p=r.Position.getStart(f).normalize().node,h=e.getBlockElementAtNode(p),g=r.Position.getEnd(f).normalize().node,v=e.getBlockElementAtNode(g),m=h&&v?e.collapseNodes(h.getStartNode(),v.getEndNode(),!0):[];if(0==m.length)m=r.fromHtml("<DIV>"+(r.Browser.isIEOrEdge?o:"<BR>")+"</DIV>",e.getDocument()),e.insertNode(m[0]),e.select(m[0],0);else if(1==m.length){var y=r.getTagOfNode(m[0]);"BR"==y?m=[r.wrap(m[0])]:"LI"!=y&&"TD"!=y||(m=r.toArray(m[0].childNodes))}else for(;m[0]&&e.contains(m[0].parentNode)&&m.some((function(e){return i.indexOf(r.getTagOfNode(e))>=0}));)m=[r.splitBalancedNodeRange(m)];d=u(m),(n||a)(d)}return!e.select(l,c)&&d&&e.select(d),d}),"Format")}},5533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2802),o=n(1e3);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];var i=1,a=1e3;function u(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,i);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),a);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;o>=0;o--)if(e>n[o]){e=n[o];break}return e}t.default=function(e,n,i){void 0===i&&(i=t.FONT_SIZES);var a=0==n?1:-1;r.default(e,(function(e){var t=parseFloat(o.getComputedStyle(e,"font-size"));e.style.fontSize=u(t,a,i)+"pt","normal"!=o.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=u},5534:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594),o=n(2185),i=n(2576),a=n(4122),u=n(4125),s=function(){function e(e,t){this.rootNode=e,this.startNode=r.default(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?o.default(this.rootNode,this.startNode):a.getFirstBlockElement(this.rootNode)},e.prototype.getStartInlineElement=function(){return this.startNode?i.default(this.rootNode,this.startNode):u.getFirstInlineElement(this.rootNode)},e.prototype.isBlockInScope=function(e){return r.default(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=s},5535:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4127),o=n(2185),i=n(2576),a=n(3527),u=n(1735),s=n(3531),l=n(1146),c=n(4125),d=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,t=l.isRange(t)?u.default.getStart(t):t,this.position=t.normalize(),this.block=o.default(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof a.default){var n=e.getStartNode();return t?c.getFirstInlineElement(n):c.getLastInlineElement(n)}return i.default(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=s.getInlineElementAfter(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new r.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=d},5536:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2185),o=n(3107),i=n(1735),a=n(3531),u=function(){function e(e,t){this.rootNode=e,this.start=i.default.getStart(t).normalize(),this.end=i.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=r.default(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(a.getInlineElementAfter(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=n&&n.equals(e);else{var o=r.default(this.rootNode,this.end.node);t=n&&o&&(e.equals(n)||e.equals(o)||e.isAfter(n)&&o.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,i=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,i=!0),t.isAfter(n)||t.equalTo(n)?null:r||i?new o.default(e,r&&t,i&&n):e},e}();t.default=u},5537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3103),o=n(2187),i=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.inlineElements=[]}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=r.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n,r,i=e.length-1;return this.forEachTextInlineElement((function(o){for(var a=o.getTextContent()||"",u=a.length-1;u>=0&&i>=0;u--)if(e.charCodeAt(i)==a.charCodeAt(u))i--,r||(r=o.getStartPosition().move(u+1));else if(t||r)return!0;return-1==i&&(n=o.getStartPosition().move(u+1),!0)})),n&&r&&o.default(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||r.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var o=i.exec(n);o&&2==o.length&&(this.word=o[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},5538:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(t){var r=e.style,o=t.fontFamily,i=t.fontSize,a=t.textColor,u=t.textColors,s=t.backgroundColor,l=t.backgroundColors,c=t.bold,d=t.italic,f=t.underline;o&&(r.fontFamily=o),i&&(r.fontSize=i),(a||u)&&(u&&n&&(e.dataset.ogsc=u.lightModeColor),r.color=a),(s||l)&&(l&&n&&(e.dataset.ogsb=l.lightModeColor),r.backgroundColor=s),c&&(r.fontWeight="bold"),d&&(r.fontStyle="italic"),f&&(r.textDecoration="underline")}}},5539:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2186),o=n(4128),i=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i;function a(e){for(var t=e.items?e.items.length:0,n=0;n<t;n++){var r=e.items[n];if(r.type&&0==r.type.indexOf("image/"))return r.getAsFile()}t=e.files?e.files.length:0;for(n=0;n<t;n++){var o=e.files.item(n);if(o.type&&0==o.type.indexOf("image/"))return o}return null}function u(e){var t=i.exec(e);if(t&&3==t.length){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}t.default=function(e,t){var n=e.clipboardData||e.target.ownerDocument.defaultView.clipboardData,i={types:n.types?r.default(n.types):[],text:n.getData("text"),image:a(n),html:void 0};if(e.clipboardData&&e.clipboardData.items){e.preventDefault();for(var s=e.clipboardData.items,l=0;l<s.length;l++){var c=s[l];if(c.type&&0==c.type.indexOf("text/html"))return void c.getAsString((function(e){i.html=o.Browser.isEdge?u(e):e,t(i)}))}i.html=null}t(i)}},5540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},t.default=function(e){return Object.keys(t.PendableFormatCommandMap).reduce((function(n,r){return n[r]=e.queryCommandState(t.PendableFormatCommandMap[r]),n}),{})}},5541:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3106);t.default=function(e){return"rtl"==r.getComputedStyle(e,"direction")}},5542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,o="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",i={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+o+"|www\\."+o,"i"),except:r,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+o,"i"),except:r},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+o+"|ftp\\."+o,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+o,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+o,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+o,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+o,"i")}};t.default=function(e){if(e)for(var t=0,n=Object.keys(i);t<n.length;t++){var r=n[t],o=i[r],a=e.match(o.match);if(a&&a[0]==e&&(!o.except||!o.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null}},5543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4129),o=n(1594),i=n(2187),a=n(2575),u=n(2185),s=n(1363),l=n(2384),c=n(4130),d=n(3528),f=n(1735),p=n(3108),h=n(3530),g=n(2186),v=n(3109),m=n(4131),y=n(2574),E=n(2573),S=[function(e,t,n){var r=u.default(e,n.node);if(r){var a=p.default(e,"a[href]",null,1,i.default(n)).filter((function(e){return r.contains(e)}))[0];if(a&&l.default(a)&&(n=new f.default(a,-2),b(a),a=null),a&&t.querySelector&&t.querySelector("a[href]")){var s=n.normalize(),c=s.node.parentNode,d=3==s.node.nodeType?h.default(s.node,s.offset,!1):s.isAtEnd?s.node.nextSibling:s.node,g=e.ownerDocument.createTextNode("");for(c.insertBefore(g,d);o.default(a,g);)g=E.splitBalancedNodeRange(g);n=new f.default(g,-2),b(g)}}return n},function(e,t,n){var r=t;if(11==r.nodeType){var o=g.default(r.childNodes).filter((function(e){return"BR"!=s.default(e)}));r=1==o.length?o[0]:null}var i=s.default(r),u=i&&"BR"==s.default(r.nextSibling),l=a.default(n.node,e,"LI"),d=l&&a.default(l,e,"OL,UL"),p=a.default(n.node,e,"TD,TH"),h=p&&a.default(p,e,"TR");"LI"==i&&(i=d?s.default(d):"UL",r=y.default(r,i));if("OL"!=i&&"UL"!=i||"LI"!=s.default(r.firstChild)){if("TABLE"==i&&h){var E=new m.default(r),S=new m.default(p);0==S.col&&p==S.getCell(S.row,0).td&&E.cells[0]&&E.cells[0].length==S.cells[0].length&&c.default(n,p)&&("TBODY"!=s.default(r.firstChild)||r.firstChild.nextSibling||v.default(r.firstChild),v.default(r),n=new f.default(h,-3))}}else{var C=!r.firstChild.nextSibling&&!u;u&&r.parentNode&&b(r.nextSibling),C?(v.default(r.firstChild),v.default(r)):s.default(d)==i&&(v.default(r),n=new f.default(l,c.default(n,l)?-2:-3))}return n},function(e,t,n){if("P"==s.default(n.node)){var o=n.normalize(),i=r.default(n.node,"div");o.node!=i&&(n=o)}return n},function(e,t,n){d.default(n.node)&&(n=new f.default(n.node,n.isAtEnd?-3:-2));return n}];function b(e){e&&e.parentNode&&e.parentNode.removeChild(e)}t.default=function(e,t,n){return S.forEach((function(r){n=r(e,t,n)})),n}},5544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3103);t.default=function(e){for(var t=r.default.createBodyTraverser(e),n=t&&t.currentBlockElement,o=[];n;)o.push(n.getTextContent()),n=t.getNextBlockElement();return o.join("\n")}},5545:function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1594),i=n(3532),a=n(1363),u=n(2804),s=n(2186),l=n(3109),c=n(2574),d=[null,"lower-alpha","lower-roman"],f=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.node=e,!e)throw new Error("node must not be null");this.listTypes=r([0],t)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getNode=function(){return this.node},e.prototype.contains=function(e){return o.default(this.node,e,!0)},e.prototype.isOrphanItem=function(){return"LI"!=a.default(this.node)},e.prototype.canMerge=function(e){return!(null==e||!e.isOrphanItem()||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;p((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(){this.listTypes.length>1&&this.listTypes.pop()},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.writeBack=function(e){for(var t,n,r=this.node.ownerDocument,o=1;o<e.length;o++)if(i.default(e[o])!==this.listTypes[o]){e.splice(o);break}for(;o<this.listTypes.length;o++){var u=this.listTypes[o],c=r.createElement(1==u?"ol":"ul");1==u&&(c.style.listStyle=d[(o-1)%d.length]),e[e.length-1].appendChild(c),e.push(c)}e[e.length-1].appendChild(this.node),this.listTypes.length<=1&&p("LI"==a.default(this.node)?(t=this.node,n=s.default(t.childNodes),l.default(t),n):[this.node],!0,!0)},e}();function p(e,t,n){return!(e.length>0)||t&&u.default(e[0])||n&&u.default(e[e.length])||(e=[c.default(e)]),e}t.default=f},5546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2575),o=n(4133),i=n(3533),a=n(3105),u=n(4132),s=n(2040),l=n(3532),c="ol,ul";function d(e,t,n){var r=t[n?t.length-1:0];r=f(e,r=s.getLeafSibling(e.rootNode,r,n,e.skipTags,!0)),i.default(e,r)&&l.isListElement(r)&&(n?t.push(r):t.unshift(r))}function f(e,t){var n=r.default(t,e.rootNode,c);if(n)for(var o=void 0;o=r.default(n.parentNode,e.rootNode,c);)n=o;return n}t.default=function(e,t,n){if(!e)return null;var r=[];if(n){var i=f(e,n);i&&r.push(i)}else{o.default(e).forEach((function(t){var n=f(e,t.getStartNode());n?r[r.length-1]!=n&&r.push(n):r.push(t.collapseToSingleElement())})),t&&(d(e,r,!1),d(e,r,!0)),r=r.filter((function(e){return!a.default(e,!0)}))}var s=null;if(r.length>0){var c=r.shift();s=l.isListElement(c)?new u.default(c):function(e){var t,n=e.ownerDocument.createElement("ol");null===(t=e.parentNode)||void 0===t||t.insertBefore(n,e);var r=new u.default(n);return r.appendItem(e,0),r}(c),r.forEach((function(e){l.isListElement(e)?s.mergeVList(new u.default(e)):s.appendItem(e,0)}))}return s}},5547:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1594),o=n(2575),i=n(1735),a=n(3108),u=n(5548),s=n(2040);function l(e,t){var n=i.default.getStart(e).normalize(),o=i.default.getEnd(e).normalize();return function(e,i,a){return function(e,t,n,o){if(e&&e.firstChild){var i=t&&s.getNextLeafSibling(e,t,o),a=n&&s.getPreviousLeafSibling(e,n,o),u=!t||r.default(e,t)&&r.default(e,i),l=!n||r.default(e,n)&&r.default(e,a),c=!(t&&n&&(r.default(t,n,!0)||r.default(t,a,!0)||r.default(n,t,!0)||r.default(n,i,!0)));return u&&l&&c}return!1}(e,i,a,t)?{rootNode:e,nodeBefore:i,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:o}:null}}t.default=function(e,t,n){var i=[];if(e&&t){var s=u.default[n],c=s.innerSelector,d=s.skipTags,f=function(e,t,n){var i=[{innerNode:e,children:[]}],s=u.default[n],l=s.outerSelector,c=s.innerSelector,d=a.default(e,l,null,2,t);return a.default(e,c,(function(t){var n=o.default(t,e,l);if(n&&d.indexOf(n)<0){for(var a={innerNode:t,children:[]},u=i.length-1;u>=0;u--){var s=i[u],c=s.innerNode,f=s.children;if(r.default(c,n)){var p=f.filter((function(e){return e.outerNode==n}))[0];p||(p={outerNode:n,boundaries:[]},f.push(p)),p.boundaries.push(a);break}}i.push(a)}}),1,t),i[0]}(e,t,n),p=o.default(t.startContainer,e,c)||e,h=o.default(t.endContainer,e,c)||e;i=function e(t,n,r,o,i){var a;i=i||n.innerNode==r;var u=!1,s=n.children,l=n.innerNode,c=[];if(0==s.length)c.push(t(l));else for(var d=0;d<=s.length&&!u;d++){var f=s[d]||{},p=f.outerNode,h=f.boundaries,g=null===(a=s[d-1])||void 0===a?void 0:a.outerNode;i&&c.push(t(l,g,p)),null==h||h.forEach((function(n){var a,s;s=(a=e(t,n,r,o,i))[0],i=a[1],u=a[2],c=c.concat(s)}))}return[c,i,u||l==o]}(l(t,d),f,p,h)[0]}return i.filter((function(e){return!!e}))},t.getRegionCreator=l},5548:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=((r={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},r);t.default=o},5549:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3102),o=n(3533);t.default=function(e,t){if(!(t=t&&t.filter((function(t){return o.default(e,t)})))||0==t.length)return[];var n=t[0],i=t[t.length-1];return o.default(e,n)&&o.default(e,i)?r.default(e.rootNode,n,i,!0):[]}},5550:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2187);function o(e){var t=e||{},n=t.left,r=t.right,o=t.top,i=t.bottom;return n+r+o+i>0?{left:Math.round(n),right:Math.round(r),top:Math.round(o),bottom:Math.round(i)}:null}t.default=function(e){if(!e)return null;var t=r.default(e),n=t.getBoundingClientRect&&o(t.getBoundingClientRect());if(n)return n;e=e.normalize();var i=t.getClientRects&&t.getClientRects();if(n=i&&1==i.length&&o(i[0]))return n;if(3==e.node.nodeType){var a=e.node.ownerDocument.createElement("SPAN");if(a.innerHTML="​",(t=r.default(e)).insertNode(a),n=a.getBoundingClientRect&&o(a.getBoundingClientRect()),a.parentNode.removeChild(a),n)return n}var u=e.element;return u&&u.getBoundingClientRect&&(n=o(u.getBoundingClientRect()))?n:null}},5551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4134);t.default=function(e,t){if(!e)return"";var n=e.innerHTML,o=t&&r.default(e,t);return o?n+"\x3c!--"+JSON.stringify(o)+"--\x3e":n}},5552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2187);t.default=function(e,t){e.innerHTML=t||"";var n=null,o=e.lastChild;try{(n=o&&8==o.nodeType&&JSON.parse(o.nodeValue))&&n.end&&n.end.length>0&&n.start&&n.start.length>0?e.removeChild(o):n=null}catch(e){}return n&&r.default(e,n.start,n.end)}},5553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4135);t.default=function(e,t){if(e.currentIndex<0||t!=e.snapshots[e.currentIndex]){r.default(e),e.snapshots.push(t),e.currentIndex++,e.totalSize+=t.length;for(var n=0;n<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=e.snapshots[n].length,n++;n>0&&(e.snapshots.splice(0,n),e.currentIndex-=n)}}},5554:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3534);t.default=function(e,t){return r.default(e,t)?(e.currentIndex+=t,e.snapshots[e.currentIndex]):null}},5555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4136),o=n(1e3);function i(e,t){return e.indexOf(o.getTagOfNode(t))<0}t.TAGS_TO_UNWRAP="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),t.TAGS_TO_STOP_UNWRAP=["TD","TH","TR","TABLE","TBODY","THEAD"],t.ATTRIBUTES_TO_PRESERVE=["href"],t.default=function(e,n,a,u){void 0===n&&(n=t.TAGS_TO_UNWRAP),void 0===a&&(a=t.TAGS_TO_STOP_UNWRAP),void 0===u&&(u=t.ATTRIBUTES_TO_PRESERVE),e.focus(),e.addUndoSnapshot((function(t,s){var l=[{}],c=a.join(",");r.default(e,(function(t){var n=l[l.length-1],r=e.getElementAtCursor(c,t);r!=n.td&&n.first&&l.push(n={}),n.td=r,n.first=n.first||t,n.last=t})),l.filter((function(e){return e.first})).forEach((function(t){var r=e.collapseNodes(t.first,t.last,!0);if(i(a,r[0]))for(;e.contains(r[0].parentNode)&&i(a,r[0].parentNode);)r=[o.splitBalancedNodeRange(r)];if(r.forEach((function(e){return function e(t,n,r,a){if(1!=t.nodeType||"BR"==o.getTagOfNode(t))return!1;var u=o.toArray(t.childNodes).map((function(t){return e(t,n,r,a)})).reduce((function(e,t){return e&&t}),!0);if(!i(r,t))return!1;var s=o.isBlockElement(t);n.indexOf(o.getTagOfNode(t))>=0||u?(s&&!u&&o.wrap(t),o.unwrap(t)):function(e,t){for(var n=0,r=o.toArray(e.attributes);n<r.length;n++){var i=r[n];t.indexOf(i.name.toLowerCase())<0&&0!=i.name.indexOf("data-")&&e.removeAttribute(i.name)}}(t,a);return s}(e,n,a,u)})),t.td){var s=t.td.getAttribute("style")||"",l=s.split(";");(s=(l=l.filter((function(e){return 0==e.trim().toLowerCase().indexOf("border")}))).join(";"))?t.td.setAttribute("style",s):t.td.removeAttribute("style")}})),e.select(t,s)}),"Format")}},5556:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188),o=n(4137),i=n(4138),a=n(4139),u=n(4140),s=n(4141),l=n(4142),c=n(4143),d=["font","text-decoration","color","background"];t.default=function(e){e.focus(),e.addUndoSnapshot((function(){r.default(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;e.queryElements("[style]",2,(function(e){d.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),n||(t.fontFamily&&i.default(e,t.fontFamily),t.fontSize&&a.default(e,t.fontSize),t.textColor&&(t.textColors?u.default(e,t.textColors):u.default(e,t.textColor)),t.backgroundColor&&(t.backgroundColors?o.default(e,t.backgroundColors):o.default(e,t.backgroundColor)),t.bold&&s.default(e),t.italic&&l.default(e),t.underline&&c.default(e))}),"Format")}},5557:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1722),o=n(1e3),i=/^[a-zA-Z]+:/i,a=/^[\w.%+-]+@/i,u=/^ftp\./i,s="istemptitle";function l(e){return e.queryElements("a[href]",1)[0]}function c(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,d){e.focus();var f=(function(e){var t=new r.HtmlSanitizer,n=(new DOMParser).parseFromString("<a></a>","text/html"),o=n.body.firstChild;return o.href=e||"",t.sanitize(n.body),o.getAttribute("href")}(t)||"").trim();if(f){var p=o.matchLink(f),h=p?p.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(i)<0&&(t=0==e.search(a)?"mailto:":0==e.search(u)?"ftp://":"http://"),t+e}(f),g=p?p.originalUrl:f;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),r=null;return t&&t.collapsed?(r=l(e))?(r.href=h,c(r,d)):((r=e.getDocument().createElement("A")).textContent=d||g,r.href=h,e.insertNode(r)):(e.getDocument().execCommand("createLink",!1,h),c(r=l(e),d)),n&&r&&(r.removeAttribute(s),r.title=n),r}),"CreateLink")}}},5558:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1644),i=n(1e3),a=n(1e3);function u(e,t){var n=i.getTagOfNode(o.cacheGetElementAtCursor(e,t,"OL,UL")),r=i.getTagOfNode(o.cacheGetElementAtCursor(e,t,"H1,H2,H3,H4,H5,H6"));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:r&&parseInt(r[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}function s(e){var t=e.getSelectionRange(),n=t&&i.Position.getStart(t).normalize().node,r=n?i.getComputedStyles(n):[];return{fontName:r[0],fontSize:r[1],textColor:r[2],backgroundColor:r[3]}}t.getElementBasedFormatState=u,t.getStyleBasedFormatState=s,t.default=function(e,t){return r(r(r(r({},a.getPendableFormatState(e.getDocument())),u(e,t)),s(e)),{canUndo:e.canUndo(),canRedo:e.canRedo()})}},5559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SPACE=32]="SPACE",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.Ctrl=256]="Ctrl",e[e.Meta=512]="Meta",e[e.Shift=1024]="Shift",e[e.CONTENTCHANGED=2048]="CONTENTCHANGED",e[e.MOUSEDOWN=4096]="MOUSEDOWN"}(t.Keys||(t.Keys={}))},5560:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(5561),i=n(5562),a=n(4145),u=n(5572),s=n(4156),l=n(5573),c=n(1146),d=n(1e3),f=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=d.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");if(this.core=i.default(e,t),this.enableExperimentFeatures=t.enableExperimentFeatures,this.core.plugins.forEach((function(e){return e.initialize(n)})),this.setContent(t.initialContent||e.innerHTML||"",!1),this.eventDisposers=u.default(this.core),t.additionalEditFeatures&&t.additionalEditFeatures.forEach((function(e){return n.addContentEditFeature(e)})),!t.omitContentEditableAttributeChanges&&!e.isContentEditable){e.setAttribute("contenteditable","true");var r=e.style;r.userSelect=r.msUserSelect=r.webkitUserSelect="text",this.contenteditableChanged=!0}o.default(this.core.document),this.triggerPluginEvent(9,{},!0),this.core.corePlugins.typeInContainer.ensureTypeInElement(this.getFocusedPosition()||new d.Position(e,0))}return e.prototype.dispose=function(){this.triggerPluginEvent(10,{},!0),this.core.plugins.forEach((function(e){return e.dispose()})),this.eventDisposers.forEach((function(e){return e()})),this.eventDisposers=null;for(var e=0,t=Object.keys(this.core.customData);e<t.length;e++){var n=t[e],r=this.core.customData[n];r&&r.disposer&&r.disposer(r.value),delete this.core.customData[n]}if(this.contenteditableChanged){var o=this.core.contentDiv.style;o.userSelect=o.msUserSelect=o.webkitUserSelect="",this.core.contentDiv.removeAttribute("contenteditable")}this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){var n=this.getDarkModeOptions(),r=this.isDarkMode()?l.convertContentToDarkMode(e,n&&n.onExternalContentTransform?n.onExternalContentTransform:void 0):null,o=!!e&&this.core.api.insertNode(this.core,e,t);return o&&r&&r(),o},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t){return!!(e&&t&&this.contains(e))&&(e.parentNode.replaceChild(t,e),!0)},e.prototype.getInlineElementAtNode=function(e){return d.getInlineElementAtNode(this.core.contentDiv,e)},e.prototype.getBlockElementAtNode=function(e){return d.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return d.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var r=t instanceof Function?0:t;n=t instanceof Function?t:n;var o=0==r?null:this.getSelectionRange();return d.queryElements(this.core.contentDiv,e,n,r,o)},e.prototype.collapseNodes=function(e,t,n){return d.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return d.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1);var n=d.getHtmlWithSelectionPath(this.core.contentDiv,t&&this.getSelectionRange());return e&&(n=this.triggerPluginEvent(7,{content:n},!0).content),this.core.inDarkMode&&(n=a.default(n)),n},e.prototype.getTextContent=function(){return d.getTextContent(this.core.contentDiv)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0);var n=this.core.contentDiv,r=!1;if(n.innerHTML!=e){var o=d.setHtmlWithSelectionPath(n,e);this.select(o),r=!0}if(this.core.inDarkMode){var i=this.getDarkModeOptions(),a=l.convertContentToDarkMode(n,i&&i.onExternalContentTransform?i.onExternalContentTransform:void 0,!0);a&&(a(),r=!0)}t&&r&&this.triggerContentChangedEvent()},e.prototype.insertContent=function(e,t){if(e){var n=d.fromHtml(e,this.core.document);t&&t.insertOnNewLine&&n.length>1&&(n=[d.wrap(n)]);var r=this.core.document.createDocumentFragment();n.forEach((function(e){return r.appendChild(e)})),this.insertNode(r,t)}},e.prototype.getSelectionRange=function(){return this.core.api.getSelectionRange(this.core,!0)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&d.getSelectionPath(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,r){var o=e?c.isRange(e)?e:Array.isArray(e.start)&&Array.isArray(e.end)?d.createRange(this.core.contentDiv,e.start,e.end):d.createRange(e,t,n,r):null;return this.contains(o)&&this.core.api.selectRange(this.core,o)},e.prototype.getSelection=function(){return this.core.document.defaultView.getSelection()},e.prototype.saveSelectionRange=function(){this.core.cachedSelectionRange=this.core.api.getSelectionRange(this.core,!1)},e.prototype.restoreSavedRange=function(){this.select(this.core.cachedSelectionRange),this.core.cachedSelectionRange=null},e.prototype.getFocusedPosition=function(){var e=this.getSelection();if(this.contains(e&&e.focusNode))return new d.Position(e.focusNode,e.focusOffset);var t=this.getSelectionRange();return t?d.Position.getStart(t):null},e.prototype.getCursorRect=function(){var e=this.getFocusedPosition();return e&&d.getPositionRect(e)},e.prototype.getElementAtCursor=function(e,t){if(!t){var n=this.getFocusedPosition();t=n&&n.node}return t&&d.findClosestElementAncestor(t,this.core.contentDiv,e)},e.prototype.isPositionAtBeginning=function(e){return d.isPositionAtBeginningOf(e,this.core.contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0),this.core.corePlugins.typeInContainer.ensureTypeInElement(this.getFocusedPosition()||new d.Position(this.core.contentDiv,0));var t=this.getSelectionRange();return t?d.getRegionsFromRange(this.core.contentDiv,t,e):[]},e.prototype.addDomEventHandler=function(e,t){var n=this;if(e instanceof Object){var r=Object.keys(e).map((function(t){return e[t]&&n.core.api.attachDomEvent(n.core,t,null,e[t])})).filter((function(e){return e}));return function(){return r.forEach((function(e){return e()}))}}return this.core.api.attachDomEvent(this.core,e,null,t)},e.prototype.triggerPluginEvent=function(e,t,n){var o=r({eventType:e},t);return this.core.api.triggerEvent(this.core,o,n),o},e.prototype.triggerEvent=function(e,t){void 0===t&&(t=!0),this.core.api.triggerEvent(this.core,e,t)},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(6,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.corePlugins.undo.undo()},e.prototype.redo=function(){this.focus(),this.core.corePlugins.undo.redo()},e.prototype.addUndoSnapshot=function(e,t){this.core.api.editWithUndo(this.core,e,t)},e.prototype.performAutoComplete=function(e,t){this.core.corePlugins.edit.performAutoComplete(e,t)},e.prototype.canUndo=function(){return this.core.corePlugins.undo.canUndo()},e.prototype.canRedo=function(){return this.core.corePlugins.undo.canRedo()},e.prototype.getDocument=function(){return this.core.document},e.prototype.getScrollContainer=function(){return this.core.scrollContainer},e.prototype.getCustomData=function(e,t,n){return this.core.api.getCustomData(this.core,e,t,n)},e.prototype.isInIME=function(){return this.core.corePlugins.domEvent.isInIME()},e.prototype.getDefaultFormat=function(){return this.core.defaultFormat},e.prototype.getBodyTraverser=function(e){return d.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&d.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&d.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(){var e=this.getSelectionRange();return e&&new d.PositionContentSearcher(this.core.contentDiv,d.Position.getStart(e))},e.prototype.runAsync=function(e){var t=this;(this.core.contentDiv.ownerDocument.defaultView||window).requestAnimationFrame((function(){!t.isDisposed()&&e&&e()}))},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.addContentEditFeature=function(e){this.core.corePlugins.edit.addFeature(e)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(void 0,!0);this.core.inDarkMode=e,this.core.defaultFormat=s.calculateDefaultFormat(this.core.contentDiv,this.core.defaultFormat,this.core.inDarkMode),this.setContent(t),this.triggerPluginEvent(13,{changedToDarkMode:e})}},e.prototype.isDarkMode=function(){return this.core.inDarkMode},e.prototype.getDarkModeOptions=function(){return this.core.darkModeOptions},e.prototype.useExperimentFeatures=function(){return!!this.enableExperimentFeatures},e}();t.default=f},5561:function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var i=n(1e3),a=i.Browser.isFirefox?((r={}).enableObjectResizing=!1,r.enableInlineTableEditing=!1,r):i.Browser.isIE?((o={}).defaultParagraphSeparator="div",o.AutoUrlDetect=!1,o):{};t.default=function(e){Object.keys(a).forEach((function(t){try{e.execCommand(t,!1,a[t])}catch(e){}}))}},5562:function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(4144),i=n(4146),a=n(4147),u=n(4148),s=n(4151),l=n(4152),c=n(4153),d=n(5564),f=n(1e3),p=n(4156),h=n(5565),g=n(5566),v=n(5567),m=n(5568),y=n(4157),E=n(5569),S=n(5570),b=n(5571);function C(e){return{attachDomEvent:(e=e||{}).attachDomEvent||d.attachDomEvent,editWithUndo:e.editWithUndo||h.editWithUndo,focus:e.focus||g.focus,getCustomData:e.getCustomData||v.getCustomData,getSelectionRange:e.getSelectionRange||m.getSelectionRange,hasFocus:e.hasFocus||y.hasFocus,insertNode:e.insertNode||E.insertNode,select:e.select||S.select,selectRange:e.selectRange||S.selectRange,triggerEvent:e.triggerEvent||b.triggerEvent}}t.default=function(e,t){var n,d={undo:t.undo||new c.default,edit:new a.default,typeInContainer:new l.default,mouseUp:new s.default,domEvent:new i.default(t.disableRestoreSelectionOnFocus),firefoxTypeAfterLink:new u.default,copyPlugin:!f.Browser.isIE&&new o.default},h=function(e,t){return r([e.typeInContainer,e.edit,e.mouseUp],t||[],[e.firefoxTypeAfterLink,e.undo,e.domEvent,e.copyPlugin]).filter((function(e){return!!e}))}(d,t.plugins),g=h.filter((function(e){return e.onPluginEvent||e.willHandleEventExclusively}));return{contentDiv:e,scrollContainer:t.scrollContainer||e,document:e.ownerDocument,defaultFormat:p.calculateDefaultFormat(e,t.defaultFormat,t.inDarkMode),corePlugins:d,currentUndoSnapshot:null,customData:(n=t.customData||{},Object.keys(n).reduce((function(e,t){return e[t]={value:n[t]},e}),{})),cachedSelectionRange:null,plugins:h,eventHandlerPlugins:g,api:C(t.coreApiOverride),defaultApi:C(),inDarkMode:t.inDarkMode,darkModeOptions:t.darkModeOptions}}},5563:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o=1e7,i=function(){function e(e){void 0===e&&(e=o),this.maxSize=e,this.snapshots=r.createSnapshots(e)}return e.prototype.canMove=function(e){return r.canMoveCurrentSnapshot(this.snapshots,e)},e.prototype.move=function(e){return r.moveCurrentSnapsnot(this.snapshots,e)},e.prototype.addSnapshot=function(e){r.addSnapshot(this.snapshots,e)},e.prototype.clearRedo=function(){r.clearProceedingSnapshots(this.snapshots)},e}();t.default=i},5564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4154);t.attachDomEvent=function(e,t,n,o){var i=function(t){var i;(("keydown"==(i=t).type||"keypress"==i.type||"keyup"==i.type)&&r.default(t)||11==n)&&t.stopPropagation(),o&&o(t),null!=n&&e.api.triggerEvent(e,{eventType:n,rawEvent:t},!1)};return e.contentDiv.addEventListener(t,i),function(){e.contentDiv.removeEventListener(t,i)}}},5565:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.editWithUndo=function(e,t,n){var o,i=null!==e.currentUndoSnapshot;i||(e.currentUndoSnapshot=e.corePlugins.undo.addUndoSnapshot());try{if(t){var a=e.api.getSelectionRange(e,!0);o=t(a&&r.Position.getStart(a).normalize(),a&&r.Position.getEnd(a).normalize(),e.currentUndoSnapshot),i||e.corePlugins.undo.addUndoSnapshot()}}finally{i||(e.currentUndoSnapshot=null)}if(t&&n){var u={eventType:6,source:n,data:o};e.api.triggerEvent(e,u,!0)}}},5566:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.focus=function(e){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.cachedSelectionRange&&e.api.selectRange(e,e.cachedSelectionRange,!0))){var t=r.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,r.createRange(t,0),!0)}e.cachedSelectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}},5567:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCustomData=function(e,t,n,r){return(e.customData[t]=e.customData[t]||{value:n?n():void 0,disposer:r}).value}},5568:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.getSelectionRange=function(e,t){var n=null;if(!t||e.api.hasFocus(e)){var o=e.document.defaultView.getSelection();if(o&&o.rangeCount>0){var i=o.getRangeAt(0);r.contains(e.contentDiv,i)&&(n=i)}}return!n&&t&&(n=e.cachedSelectionRange),n}},5569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.insertNode=function(e,t,n){n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var o=e.contentDiv;switch(n.updateCursor&&e.api.focus(e),n.position){case 0:case 1:var i,a=0==n.position,u=r.getFirstLastBlockElement(o,a);if(u){var s=a?u.getStartNode():u.getEndNode();i=n.insertOnNewLine||3==s.nodeType||r.isVoidHtmlElement(s)?s.parentNode.insertBefore(t,a?s:s.nextSibling):s.insertBefore(t,a?s.firstChild:null)}else i=o.appendChild(t);i&&n.insertOnNewLine&&!r.isBlockElement(i)&&r.wrap(i);break;case 2:var l=o.appendChild(t);l&&n.insertOnNewLine&&!r.isBlockElement(l)&&r.wrap(l);break;case 5:case 3:var c=function(e,t){var n=e.api.getSelectionRange(e,!0),r=null;return 5==t.position?(r=n,n=t.range):n&&(r=n.cloneRange()),{range:n,rangeToRestore:r}}(e,n),d=c.range,f=c.rangeToRestore;if(!d)return;n.replaceSelection&&!d.collapsed&&d.deleteContents();var p=r.Position.getStart(d),h=void 0;p=n.insertOnNewLine&&(h=r.getBlockElementAtNode(o,p.normalize().node))?new r.Position(h.getEndNode(),-3):r.adjustNodeInsertPosition(o,t,p);var g=11==t.nodeType?t.lastChild:t;(d=r.createRange(p)).insertNode(t),n.updateCursor&&g&&(f=r.createRange(new r.Position(g,-3).normalize())),e.api.selectRange(e,f);break;case 4:e.contentDiv.parentNode.insertBefore(t,o.nextSibling)}return!0}},5570:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3),o=n(4157),i=n(1146);t.selectRange=function(e,t,n){var i,a=!0;if(!r.contains(e.contentDiv,t)||!(i=e.document.defaultView.getSelection()))return!1;if(i.rangeCount>0)try{var u=void 0;(n||r.Browser.isEdge)&&(u=1==i.rangeCount?i.getRangeAt(0):null)&&u.startContainer==t.startContainer&&u.startOffset==t.startOffset&&u.endContainer==t.endContainer&&u.endOffset==t.endOffset?a=!1:i.removeAllRanges()}catch(e){}return a&&i.addRange(t),o.hasFocus(e)||(e.cachedSelectionRange=t),t.collapsed&&e.corePlugins.domEvent.restorePendingFormatState(),!0},t.select=function(e,t,n,o,a){var u=i.isRange(t)?t:r.createRange(t,n,o,a);return e.api.selectRange(e,u)}},5571:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=function(e,t,n){!n&&e.eventHandlerPlugins.some((function(e){return function(e,t){if(t.onPluginEvent&&t.willHandleEventExclusively&&t.willHandleEventExclusively(e))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.eventHandlerPlugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},5572:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=((r={keypress:1,keydown:0,keyup:2,mousedown:4})[n(1e3).Browser.isIE?"textinput":"input"]=11,r);t.default=function(e){return Object.keys(o).map((function(t){return e.api.attachDomEvent(e,t,o[t])}))}},5573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1146);t.convertContentToDarkMode=function(e,t,n){var o=[];return r.isHTMLElement(e)?(o=Array.prototype.slice.call(e.getElementsByTagName("*")),n||o.unshift(e)):r.isDocumentFragment(e)&&(o=Array.prototype.slice.call(e.querySelectorAll("*"))),o.length>0?function(){o.forEach((function(e){t?t(e):(e.style.color=null,e.style.backgroundColor=null)}))}:null}},5574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3536),o="GET_ELEMENT_AT_CURSOR_";t.default=function(e,t,n){return r.default(t,o+n,(function(){return e.getElementAtCursor(n)}))}},5575:function(e,t,n){"use strict";function r(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),"Format")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"==typeof t)r(e,t);else{var n=new FileReader;n.onload=function(t){e.isDisposed()||r(e,t.target.result)},n.readAsDataURL(t)}}},5576:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);function o(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,i){var a=e.getDocument(),u=a.createDocumentFragment(),s=a.createElement("table");u.appendChild(s),s.cellSpacing="0",s.cellPadding="1";for(var l=0;l<n;l++){var c=a.createElement("tr");s.appendChild(c);for(var d=0;d<t;d++){var f=a.createElement("td");c.appendChild(f),f.appendChild(a.createElement("br")),f.style.width=o(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new r.VTable(s);t.applyFormat(i||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(u),e.runAsync((function(){return e.select(new r.Position(s,0).normalize())}))}),"Format")}},5577:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(o,i){var a=new r.VTable(n);a.edit(t),a.writeBack(),e.focus(),e.select(o,i)||e.select(e.contains(n)?n:a.getCurrentTd())}),"Format")}},5578:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(o,i){var a=new r.VTable(n);a.applyFormat(t),a.writeBack(),e.focus(),e.select(o,i)}),"Format")}},5579:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1e3);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",1,r.unwrap),e.select(t,n)}),"Format")}},5580:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){if(!t||!n)return!1;var i;if(i="string"==typeof t?(o=o||e.getContentSearcherOfCursor())&&o.getRangeFromText(t,r):t){var a=e.getSelectionRange();return a.collapsed&&i.endContainer==a.startContainer&&i.endOffset==a.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:i}),!0}return!1}},5581:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188);t.default=function(e,t){var n="justifyLeft",o="left";1==t?(n="justifyCenter",o="center"):2==t&&(n="justifyRight",o="right"),e.addUndoSnapshot((function(){r.default(e,n),e.queryElements("[align]",1,(function(e){return e.style.textAlign=o}))}),"Format")}},5582:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4136);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,o){r.default(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),e.select(n,o)}),"Format")}},5583:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"Format")}},5584:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5585),o=n(3537);t.default=function(e,t){if(e.useExperimentFeatures())r.default(e,t);else{var n=0==t?"indent":"outdent";e.addUndoSnapshot((function(){var t;return e.focus(),e.getElementAtCursor("OL,UL")?t=o.default(e,n):(e.getDocument().execCommand(n,!1,null),e.queryElements("BLOCKQUOTE",1,(function(e){t=t||e,e.style.marginTop="0px",e.style.marginBottom="0px"}))),t}),"Format")}}},5585:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4158),o=n(1e3),i=n(1e3),a='<blockquote style="margin-top:0;margin-bottom:0"></blockquote>';function u(e,t){if(t.length>0){var n=t[0].getStartNode(),r=t[t.length-1].getEndNode(),o=i.collapseNodesInRegion(e,[n,r]);i.wrap(o,a)}}function s(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=i.findClosestElementAncestor(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=i.wrap(i.toArray(n.childNodes)));i.isNodeInRegion(e,n)&&"BLOCKQUOTE"!=i.getTagOfNode(n);)n=i.splitBalancedNodeRange(n);i.isNodeInRegion(e,n)&&i.unwrap(n)}}))}t.default=function(e,t){var n=0==t?u:s;r.default(e,(function(e,r,a){for(var u=o.getSelectedBlockElementsInRegion(e),s=[[]],l=0;l<u.length;l++){var c=u[l].getStartNode(),d=i.createVListFromRegion(e,!0,c);if(d){for(s.push([]);u[l+1]&&d.contains(u[l+1].getStartNode());)l++;d.setIndentation(r,a,t),d.writeBack()}else s[s.length-1].push(u[l])}s.forEach((function(t){return n(e,t)}))}))}},5586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4159),o=n(3537);t.default=function(e){e.useExperimentFeatures()?r.default(e,2):(e.focus(),e.addUndoSnapshot((function(){return o.default(e,"insertUnorderedList")}),"Format"))}},5587:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4159),o=n(3537);t.default=function(e){e.useExperimentFeatures()?r.default(e,1):(e.focus(),e.addUndoSnapshot((function(){return o.default(e,"insertOrderedList")}),"Format"))}},5588:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4160),o="blockquote",i=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){r.default(e,o,t||i)}},5589:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4160),o=n(1e3),i="pre",a="code",u="CODE";function s(e){var t=o.wrap(e,a);return o.wrap(t,i)}function l(e){if(!e)return null;var t=e.childNodes[0];return 1==e.childNodes.length&&o.getTagOfNode(t)==u&&o.unwrap(t),o.unwrap(e)}t.default=function(e,t){r.default(e,i,t,s,l)}},5590:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188);t.default=function(e){r.default(e,"strikeThrough")}},5591:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188);t.default=function(e){r.default(e,"subscript")}},5592:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2188);t.default=function(e){r.default(e,"superscript")}},5593:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1722);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);for(var r=e.getDocument().createElement("div");t.firstChild;)r.appendChild(t.firstChild);e.replaceNode(t,r)})),t>0){for(var o=e.getSelectionTraverser(),i=o?o.currentBlockElement:null,a=new r.HtmlSanitizer({styleCallbacks:{"font-size":function(){return!1}}});i;){var u=i.collapseToSingleElement();a.sanitize(u),i=o.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"Format")}}}]);
//# sourceMappingURL=owa.14.js.map
self.scriptsLoaded['owa.14.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.14.js'] = (new Date()).getTime();