self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FileProviderStore.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[269,94],{1008:function(e,t,r){"use strict";var n=r(108),o=r(949),a=r(4),i=r(1240);Object(a.mutator)(i.a,(function(e){var t=e.suggestionSet;Object(o.a)(e.scenarioId).currentSuggestions=t}));var c=r(0),u=r(1382),s=r(1012),l=Object(a.action)("INITIALIZE_SCENARIO_STORE",(function(e,t){return{scenarioId:e,isUsing3S:t}}));Object(a.mutator)(l,(function(e){var t=Object(u.a)(e.scenarioId);Object(s.b)().scenarioStores.get(t)||(Object(s.b)().scenarioStores.set(t,Object(c.__assign)({},Object(s.a)())),Object(s.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)}));var d=Object(a.action)("RESET_CURRENT_SUGGESTIONS",(function(e){return{scenarioId:e}}));Object(a.mutator)(d,(function(e){var t=Object(s.a)();Object(o.a)(e.scenarioId).currentSuggestions=t.currentSuggestions}));var f=r(1124);Object(a.mutator)(f.a,(function(e){Object(o.a)(e.scenarioId).isSuggestionsDropdownVisible=e.isSuggestionsDropdownVisible}));var b=r(1615),h=(Object(a.mutator)(b.a,(function(e){Object(o.a)(e.scenarioId).searchText=e.searchText})),Object(a.action)("ADD_SUGGESTION_PILL_INTERNAL",(function(e,t){return{suggestionPill:e,scenarioId:t}}))),p=(Object(a.mutator)(h,(function(e){var t=Object(o.a)(e.scenarioId),r=e.suggestionPill,n=r.ReferenceId;t.suggestionPills.set(n,r),t.suggestionPillIds.push(n)})),Object(a.action)("SET_LATEST_TRACE_ID",(function(e,t,r){return{latestTraceId:e,scenarioId:t,isQFTraceId:r}}))),m=(Object(a.mutator)(p,(function(e){var t=Object(o.a)(e.scenarioId),r=e.latestTraceId;t.latestTraceId=r,e.isQFTraceId&&(t.latestQFTraceId=r)})),r(123)),g=Object(a.action)("ON_SEARCH_INPUT_FOCUSED",(function(e){return Object(m.c)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e})})),v=Object(a.action)("SEARCH_BOX_BLURRED",(function(e){return{scenarioId:e}}));Object(a.mutator)(g,(function(e){Object(o.a)(e.scenarioId).searchBoxHasFocus=!0})),Object(a.mutator)(v,(function(e){Object(o.a)(e.scenarioId).searchBoxHasFocus=!1}));var O=Object(a.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",(function(e,t){return{searchTextForSuggestion:e,scenarioId:t}})),_=(Object(a.mutator)(O,(function(e){Object(o.a)(e.scenarioId).searchTextForSuggestion=e.searchTextForSuggestion})),Object(a.mutatorAction)("setLatestRenderedQFTraceId",(function(e,t){Object(o.a)(t).latestRenderedQFTraceId=e}))),S=r(1235),j=r(1216),I=r(979),x=r(1292),w=(Object(a.orchestrator)(S.a,(function(e){var t=e.scenarioId;x.b.importAndExecute(Object(j.a)(t)),I.x.importAndExecute(),x.a.importAndExecute()})),r(1114));Object(a.mutator)(w.a,(function(e){var t=e.scenarioId,r=e.actionSource,n=Object(o.a)(t);n.queryActionSource=r,n.queryAlterationType=null}));Object(a.mutator)(i.a,(function(e){Object(o.a)(e.scenarioId).traceIdToLogicalIdMap.set(e.suggestionSet.TraceId,e.qfRequestId)}));var y=Object(a.action)("START_SEARCH_SESSION",(function(e,t,r){return{actionSource:e,shouldStartSearch:t,scenarioId:r}})),T=r(1162),k=(Object(a.orchestrator)(g,(function(e){var t=e.scenarioId,r=Object(o.a)(t),n=r.searchSessionGuid,a=r.searchText,i=r.searchTextForSuggestion;if(Object(f.a)(!0,t),n){if(a&&a===i)return;O(a,t),Object(T.a)(t)}else y("SearchBox",!1,t)})),r(1353)),E=Object(a.action)("ON_ENTER_PRESSED_SEARCH_INPUT",(function(e,t){return{selectedSuggestionIndex:e,scenarioId:t}})),P=r(1096),C=r(1354);Object(a.orchestrator)(E,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r,n;return Object(c.__generator)(this,(function(a){return t=e.scenarioId,r=e.selectedSuggestionIndex,n=Object(o.a)(t),r!==Object(s.a)().selectedSuggestionIndex?(Object(C.a)(n.currentSuggestions.Suggestions[r],"keyboard",t,n.currentSuggestions.TraceId,r),n.searchText||(Object(P.a)("",t),O("",t))):Object(k.a)(t)||Object(w.a)("Keyboard",t,!0),Object(f.a)(!1,t),[2]}))}))})),Object(a.orchestrator)(P.a,(function(e){return Object(c.__awaiter)(void 0,void 0,void 0,(function(){var t,r;return Object(c.__generator)(this,(function(n){return t=e.scenarioId,r=e.searchText,Object(b.a)(r,t),[2]}))}))}));var A=r(1780),D=Object(a.mutatorAction)("setSearchSessionGuid",(function(e,t){Object(o.a)(t).searchSessionGuid=e})),N=r(428),B=r(1206),R=r(76),F=r(1021);function L(e){if(e!==F.a.Mail)return null;var t=[];return(Object(R.h)("sea-trySuggestions")||Object(R.h)("sea-trySuggestionsC")||Object(R.h)("sea-trySuggestions-always")||Object(R.h)("sea-naturalLanguage")||Object(R.h)("sea-naturalLanguageR"))&&t.push("ENABLENLWITHB2QAS_T"),Object(R.h)("sea-naturalLanguageCT")&&t.push("ENABLENLWITHB2QAS_CT"),Object(R.h)("sea-naturalLanguageC")&&t.push("ENABLENLWITHB2QAS_C"),Object(R.h)("sea-files-mru")&&t.push("ZQFileSuggestionsOwa"),t.length>0?t.join(","):null}var M=r(255),q=(Object(a.orchestrator)(y,(function(e){var t=e.actionSource,r=e.shouldStartSearch,n=e.scenarioId,a=Object(o.a)(n);if(a.searchSessionGuid)throw new Error("searchSessionGuid should not be set when starting a search session.");var i=Object(N.a)();D(i,n),Object(A.a)(Object(N.a)(),n),a.isUsing3S&&I.D.import().then((function(e){e(a.nextSearchQueryId,Object(j.a)(n),L(n),1)})),Object(B.a)(t,r,n),Be.import(),Re.import(),tt.import(),Ge.import(),Qe.import(),Object(M.o)("Search_SessionStarted",[F.b[n],t])})),Object(a.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",(function(e,t){return{scenarioId:e,callback:t}}))),G=r(2054);Object(a.orchestrator)(q,(function(e){Object(G.b)(e.scenarioId,e.callback)}));var H=r(1370);Object(a.orchestrator)(H.a,(function(e){var t=e.scenarioId,r=e.suggestionPill;r&&(function(e,t){var r=Object(o.a)(t);switch(e.kind){case I.b.People:return Object(c.__spread)(r.suggestionPills.values()).filter((function(t){var r,n,o,a;if(t.kind!==I.b.People)return!1;try{for(var i=Object(c.__values)(e.EmailAddresses),u=i.next();!u.done;u=i.next()){var s=u.value;try{for(var l=(o=void 0,Object(c.__values)(t.EmailAddresses)),d=l.next();!d.done;d=l.next()){if(s===d.value)return!0}}catch(e){o={error:e}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return!1})).length>0;case I.b.Category:return r.suggestionPillIds.indexOf(e.ReferenceId)>-1;default:return!1}}(r,t)||h(r,t),e.suggestionSelected&&(Object(P.a)("",t),O("",t)))})),Object(a.mutator)(S.a,(function(e){var t=Object(o.a)(e.scenarioId),r=Object(s.a)();t.latestQFRequestId=r.latestQFRequestId,t.searchTextForSuggestion=r.searchTextForSuggestion,t.currentSuggestions=r.currentSuggestions,t.selectedSuggestionIndex=r.selectedSuggestionIndex}));function U(e){var t=Object(o.a)(F.b.Mail).suggestionPills,r=e.SearchTerms;return t.forEach((function(e){switch(e.kind){case I.b.People:var t=e,n=t.DisplayName.toLowerCase().split(" ");V(r,n),V(r,t.EmailAddresses);break;case I.b.Category:var o=e.Name.toLowerCase().split(" ");V(r,o)}})),r}function V(e,t){t.forEach((function(t){!function(e,t){for(var r=-1,n=0;n<e.length;n++)0==e[n].localeCompare(t,"en",{sensitivity:"base",ignorePunctuation:!0})&&(r=n);r>-1&&e.splice(r,1)}(e,t)}))}var z=String.fromCharCode(57345),Q=String.fromCharCode(57344),X=(r(1581),r(1344)),Y=r(1617),J=(Object(a.action)("EXECUTE_COMMAND",(function(e){return{scenarioId:e}})),r(1361)),W=r(1618),Z=r(1619),K=r(1620),$=Object(a.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",(function(e,t,r,n,o,a){return{suggestion:e,suggestionIndex:t,actionSource:r,scenarioId:n,suggestionSetTraceId:o,entityActionTakenType:a}})),ee=r(1582),te=r(1621),re=r(1362),ne=r(23),oe=r(554),ae=r(579),ie=r(432),ce=r(306),ue=r(252),se=r(78),le=r(990),de=r(397),fe=r(9),be=r(1605),he=r(1),pe=r(1125),me=r(2027),ge=r(2055);function ve(e,t){return e?pe.c:t||pe.b}var Oe=r(2084),_e=r(42),Se=r(567),je=r(2028),Ie=r(2029),xe=r(2030),we=r(479),ye=r(2085),Te=Object(_e.a)((function(e,t){var r=this,n=he.useRef(),a=Object(Se.a)((function(){return Object(o.a)(e.scenarioId).searchText})),i=Object(Se.a)((function(){var t=e.isSuggestionsCalloutVisible,r=e.scenarioId,n=Object(o.a)(r).selectedSuggestionIndex;return t&&n>=0?""+pe.q+n:""}));he.useImperativeHandle(t,(function(){return{setFocus:function(){n.current&&n.current.focus()}}}),[]);var u=function(){return n.current?n.current.selectionStart!==n.current.selectionEnd?-1:n.current.selectionStart:-1},s=function(){var e=n.current.value.length;n.current.setSelectionRange(e,e)},l=e.scenarioId,d=e.searchPlaceHolderText,b=e.isDisabled,h=e.isSuggestionsCalloutVisible,p=!!Object(o.a)(e.scenarioId).searchSessionGuid,m=we(ye.searchBoxInput,b&&ye.isDisabled,p?ye.inSearchinputPlaceholder:ye.inputPlaceholder),v=Object(je.a)(l,d),_=v.ariaLabel,S=v.placeholder;return he.createElement("div",{className:ye.searchBoxInputContainer},he.createElement("input",{"aria-activedescendant":i.get(),"aria-autocomplete":"list","aria-label":_,"aria-owns":h?pe.p:"",autoComplete:"off",className:m,disabled:b,onChange:function(){var t=e.scenarioId,r=n.current.value;Object(P.a)(r,t),O(r,t),Object(T.a)(t),Object(o.a)(t).isSuggestionsDropdownVisible||Object(f.a)(!0,t)},onClick:function(t){t.stopPropagation(),Object(f.a)(!0,e.scenarioId)},onFocus:function(t){var r=t.relatedTarget;r||(r=document.activeElement),r.id.indexOf(pe.q)>-1||(Object(f.a)(!0,e.scenarioId),g(e.scenarioId))},onKeyDown:function(t){return Object(c.__awaiter)(r,void 0,void 0,(function(){var r,n,a;return Object(c.__generator)(this,(function(i){switch(i.label){case 0:switch(t.stopPropagation(),r=t.keyCode,n=e.scenarioId,a=Object(o.a)(n).selectedSuggestionIndex,Object(xe.a)(r,e.scenarioId),r){case 13:return[3,1];case 8:return[3,2];case 38:return[3,4];case 40:return[3,6];case 37:return[3,8];case 27:return[3,10]}return[3,11];case 1:return s(),E(a,n),[3,12];case 2:return[4,Le.import()];case 3:return i.sent()(u(),n),[3,12];case 4:return t.preventDefault(),[4,qe.import()];case 5:return i.sent()(n),[3,12];case 6:return[4,Fe.import()];case 7:return i.sent()(n),[3,12];case 8:return[4,Me.import()];case 9:return i.sent()(u(),n),[3,12];case 10:return t.preventDefault(),Object(Ie.a)(n),[3,12];case 11:return[3,12];case 12:return[2]}}))}))},placeholder:S,ref:function(e){return n.current=e},value:a.get(),spellCheck:!1,autoCorrect:"off"}))}),{forwardRef:!0}),ke=r(479),Ee=r(2087),Pe="LPCPseudoTabbableElement",Ce=function(e){function t(t){var r=e.call(this,t)||this;r.onExitClick=function(){r.onExit("SearchBoxBackArrow")},r.isInActiveSearchSession=function(){return!!Object(o.a)(r.props.scenarioId).searchSessionGuid},r.onCompactSearchButtonClick=function(){y("SearchCollapsedButton",!1,r.props.scenarioId)},r.onSearchScopeSelected=function(e){return Object(c.__awaiter)(r,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return this.searchInput?[4,tt.import()]:[3,2];case 1:t.sent()(e)&&this.searchInput.setFocus(),t.label=2;case 2:return[2]}}))}))},r.focusSearchInput=function(){Object(o.a)(r.props.scenarioId).showSearchBoxInCompactMode&&!r.isInActiveSearchSession()?y("Keyboard",!1,r.props.scenarioId):r.searchInput.setFocus()},r.onSearchBoxClick=function(e){e.stopPropagation(),r.focusSearchInput()},r.onExit=function(e){Object(J.a)(e,r.props.scenarioId,Object(R.h)("sea-nextSearchBoxInteractions"))},r.onSearchBoxBlur=function(e){var t=e.relatedTarget;t||(t=document.activeElement),Object(ue.a)(r.searchBoxContainer,t)||t.id==Pe||t.id===pe.j||t.id===pe.k||t.firstElementChild&&t.firstElementChild.id===pe.i||(Object(f.a)(!1,r.props.scenarioId),v(r.props.scenarioId))},r.onRemovePill=function(e){return Object(c.__awaiter)(r,void 0,void 0,(function(){return Object(c.__generator)(this,(function(t){switch(t.label){case 0:return[4,Ge.import()];case 1:return t.sent()(e,this.props.scenarioId,"Click"),[2]}}))}))},r.onClearSearchBoxClicked=function(e){var t=r.props.scenarioId;e.stopPropagation(),Object(X.a)(t),r.focusSearchInput(),Object(M.o)("Search_ClearSearchBoxButtonClicked",[F.a[t]])},r.onClearSearchBoxClickedKeyDown=function(e){e.keyCode!==se.a.enter&&e.keyCode!==se.a.space||r.onClearSearchBoxClicked(e)};var n=t.isUsing3S,a=void 0===n||n;return l(t.scenarioId,a),r}return Object(c.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this.isInActiveSearchSession();this.props.showCompactSearchBox!=e.showCompactSearchBox||!t||this.previousSearchActiveValue||this.props.disableAutoFocusWhenActivated||this.focusSearchInput(),this.previousSearchActiveValue=t},Object.defineProperty(t.prototype,"isSuggestionsCalloutVisible",{get:function(){var e=Object(o.a)(this.props.scenarioId),t=e.isSuggestionsDropdownVisible,r=e.currentSuggestions;return!this.props.isSuggestCalloutDisabled&&r&&r.Suggestions&&r.Suggestions.length>0&&t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"searchBoxButtonProps",{get:function(){var e=this;return Object(o.a)(this.props.scenarioId).searchBoxHasFocus?{ariaLabel:Object(fe.b)(be.a),iconProps:{iconName:"Forward"},onClick:this.onSearchButtonClicked(),title:Object(fe.b)(be.a)}:{ariaLabel:Object(fe.b)(Oe.b),iconProps:{iconName:"Clear"},onClick:function(){return e.onExit("SearchBoxXButton")},title:Object(fe.b)(Oe.b)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"searchGlyphClasses",{get:function(){return Object(R.h)("sea-nextSearchBoxInteractions")?ke(Object(o.a)(this.props.scenarioId).searchSessionGuid?Ee.searchIconFocused:Ee.searchIconRest,this.props.isDisabled&&Ee.isDisabled):ke(Ee.searchIcon,this.props.isDisabled&&Ee.isDisabled)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isClearSearchBoxButtonVisible",{get:function(){return!!Object(R.h)("sea-searchBoxInteractionsClear")&&!Object(k.a)(this.props.scenarioId)},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,r=t.isDisabled,n=t.scenarioId,a=Object(o.a)(n).showSearchBoxInCompactMode,i=this.isInActiveSearchSession(),u={maxWidth:ve(i,this.props.customCollapsedMaxWidth)+"px",width:"100%"},s=ke(Ee.searchBoxCommonContainer,a&&Ee.isInCompactMode,i&&Ee.searchBoxContainerInSearch),l=ke(Ee.searchBoxContainer,i&&Ee.searchBoxContainerNoBorderRadius,i&&Ee.searchBoxContainerInSearch,a&&Ee.isInCompactMode);if(a&&!i)return he.createElement("div",{role:"search",className:l,ref:function(t){return e.searchBoxContainer=t}},he.createElement(We,{onClick:this.onCompactSearchButtonClick}));var d=ke(Ee.searchBox,r&&Ee.isDisabled),f=this.searchGlyphClasses,b=this.isSuggestionsCalloutVisible?he.createElement(Je,{scenarioId:n,focusSearchInput:this.focusSearchInput}):null,h={role:le.a.button,label:Object(fe.b)(Oe.a)},p=ke(Ee.searchBoxColumnContainer,a&&Ee.isInCompactMode);return he.createElement("div",{style:u,className:s},he.createElement("div",{className:p},he.createElement("div",{role:"search",tabIndex:-1,className:l,ref:function(t){return e.searchBoxContainer=t},"aria-expanded":this.isSuggestionsCalloutVisible,onBlur:this.onSearchBoxBlur},he.createElement("div",{id:Object(ge.a)(n),className:d},he.createElement(de.a,{type:de.b.None},b),i&&!Object(R.h)("sea-nextSearchBoxInteractions")?he.createElement(ae.a,{className:ke(Ee.backButton,"flipForRtl"),iconProps:{iconName:"Back"},onClick:this.onExitClick,ariaLabel:Object(fe.b)(Oe.b)}):he.createElement("div",{"aria-hidden":!0,className:f,onClick:this.onSearchBoxClick},he.createElement(ce.a,{iconName:"Search"})),he.createElement("div",{className:Ee.searchQueryContainer,onClick:this.onSearchBoxClick},Object(me.a)(this.props.scenarioId)&&he.createElement(Ye,{focusSearchInput:this.focusSearchInput,onRemovePill:this.onRemovePill,scenarioId:this.props.scenarioId}),he.createElement(Te,{ref:function(t){return e.searchInput=t},searchPlaceHolderText:this.props.searchPlaceHolderText,isDisabled:this.props.isDisabled,scenarioId:this.props.scenarioId,isSuggestionsCalloutVisible:this.isSuggestionsCalloutVisible})),this.isClearSearchBoxButtonVisible&&he.createElement("div",Object(c.__assign)({className:Ee.clearBoxButton,onClick:this.onClearSearchBoxClicked,onKeyDown:this.onClearSearchBoxClickedKeyDown,tabIndex:0,title:Object(fe.b)(Oe.a)},Object(le.b)(h)),he.createElement(ce.a,{iconName:"Clear",styles:{root:{fontSize:"8px"}}})),i&&this.props.renderRefiners&&he.createElement("div",{tabIndex:-1},this.props.renderRefiners()),i&&Object(R.h)("sea-nextSearchBoxInteractions")&&he.createElement(ie.a,Object(c.__assign)({className:Ee.searchBoxButton,styles:{icon:{fontSize:"16px"}}},this.searchBoxButtonProps))),i&&!Object(R.h)("sea-nextSearchBoxInteractions")&&he.createElement(ae.a,{className:Ee.searchButton,iconProps:{iconName:"Search"},onClick:this.onSearchButtonClicked(),ariaLabel:Object(fe.b)(be.a)})),he.createElement("div",{id:pe.h})))},t.prototype.onSearchButtonClicked=function(){var e=this;return function(t){return Object(c.__awaiter)(e,void 0,void 0,(function(){var e;return Object(c.__generator)(this,(function(r){switch(r.label){case 0:return t.stopPropagation(),e=this.props.scenarioId,[4,tt.import()];case 1:return r.sent()(e)?this.focusSearchInput():(Object(f.a)(!1,this.props.scenarioId),Object(w.a)("SearchButton",e,!0)),[2]}}))}))}},Object(c.__decorate)([ne.computed],t.prototype,"isSuggestionsCalloutVisible",null),Object(c.__decorate)([ne.computed],t.prototype,"searchBoxButtonProps",null),Object(c.__decorate)([ne.computed],t.prototype,"searchGlyphClasses",null),Object(c.__decorate)([ne.computed],t.prototype,"isClearSearchBoxButtonVisible",null),t=Object(c.__decorate)([oe.observer],t)}(he.Component),Ae=r(1622);function De(e){var t=Object(o.a)(e).suggestionPills;return!(!t||0===t.size)&&Object(c.__spread)(t.values()).filter((function(e){return e.kind===I.b.People})).length>0}r.d(t,"w",(function(){return Be})),r.d(t,"x",(function(){return Re})),r.d(t,"D",(function(){return Fe})),r.d(t,"C",(function(){return Le})),r.d(t,"E",(function(){return Me})),r.d(t,"F",(function(){return qe})),r.d(t,"G",(function(){return Ge})),r.d(t,"I",(function(){return He})),r.d(t,"H",(function(){return Ue})),r.d(t,"L",(function(){return Ve})),r.d(t,"J",(function(){return ze})),r.d(t,"K",(function(){return Qe})),r.d(t,"e",(function(){return Xe})),r.d(t,"f",(function(){return Ye})),r.d(t,"i",(function(){return Je})),r.d(t,"a",(function(){return We})),r.d(t,"h",(function(){return Ze})),r.d(t,"y",(function(){return Ke})),r.d(t,"z",(function(){return $e})),r.d(t,"A",(function(){return et})),r.d(t,"B",(function(){return tt})),r.d(t,"W",(function(){return _})),r.d(t,"p",(function(){return U})),r.d(t,"q",(function(){return o.a})),r.d(t,"c",(function(){return Q})),r.d(t,"b",(function(){return z})),r.d(t,"g",(function(){return F.b})),r.d(t,"j",(function(){return H.a})),r.d(t,"k",(function(){return X.a})),r.d(t,"l",(function(){return Y.a})),r.d(t,"o",(function(){return J.a})),r.d(t,"t",(function(){return T.a})),r.d(t,"Q",(function(){return d})),r.d(t,"R",(function(){return v})),r.d(t,"S",(function(){return W.a})),r.d(t,"T",(function(){return B.a})),r.d(t,"U",(function(){return i.a})),r.d(t,"V",(function(){return Z.a})),r.d(t,"Z",(function(){return K.a})),r.d(t,"ab",(function(){return w.a})),r.d(t,"X",(function(){return p})),r.d(t,"db",(function(){return C.a})),r.d(t,"cb",(function(){return $})),r.d(t,"N",(function(){return P.a})),r.d(t,"bb",(function(){return y})),r.d(t,"n",(function(){return ee.a})),r.d(t,"P",(function(){return q})),r.d(t,"Y",(function(){return O})),r.d(t,"m",(function(){return S.a})),r.d(t,"M",(function(){return te.a})),r.d(t,"s",(function(){return j.a})),r.d(t,"u",(function(){return L})),r.d(t,"v",(function(){return re.a})),r.d(t,"d",(function(){return Ce})),r.d(t,"r",(function(){return Ae.a})),r.d(t,"O",(function(){return De}));var Ne=new n.c((function(){return Promise.all([r.e(7),r.e(10),r.e(12),r.e(719),r.e(521)]).then(r.bind(null,14555))})),Be=new n.b(Ne,(function(e){return e.clearSearchBox})),Re=new n.b(Ne,(function(e){return e.endSearchSession})),Fe=new n.b(Ne,(function(e){return e.onDownArrowPressedSearchInput})),Le=new n.b(Ne,(function(e){return e.onBackspacePressedSearchInput})),Me=new n.b(Ne,(function(e){return e.onLeftArrowPressedSearchInput})),qe=(new n.b(Ne,(function(e){return e.onRightArrowPressedSearchInput})),new n.b(Ne,(function(e){return e.onUpArrowPressedSearchInput}))),Ge=new n.b(Ne,(function(e){return e.removeSuggestionPillFromSearchBox})),He=new n.b(Ne,(function(e){return e.setLatestQFRequestId})),Ue=new n.b(Ne,(function(e){return e.setIsSuggestionsDropdownVisible})),Ve=new n.b(Ne,(function(e){return e.updateIsSuggestionSetComplete})),ze=new n.b(Ne,(function(e){return e.setShowSearchBoxInCompactMode})),Qe=new n.a(Ne,(function(e){return e.setSpellerData})),Xe=(Object(n.d)(Ne,(function(e){return e.PersonaPill})),Object(n.d)(Ne,(function(e){return e.PrivateDistributionListPill})),Object(n.d)(Ne,(function(e){return e.SearchBoxDropdown}))),Ye=Object(n.d)(Ne,(function(e){return e.SearchBoxPillWell})),Je=Object(n.d)(Ne,(function(e){return e.SuggestionsCallout})),We=Object(n.d)(Ne,(function(e){return e.CompactSearchBox})),Ze=Object(n.d)(Ne,(function(e){return e.SearchScopePicker})),Ke=new n.b(Ne,(function(e){return e.getSuggestionAtIndex})),$e=new n.b(Ne,(function(e){return e.isInSearchMode})),et=new n.b(Ne,(function(e){return e.isQFRequestIdEqualToLatest})),tt=new n.b(Ne,(function(e){return e.isSearchBoxEmpty}))},1011:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(26),o=r(283);function a(e){return!!(e&Object(n.a)().ViewStateConfiguration.ListViewBitFlags)}var i=Object(o.action)("setBit")((function(e,t){a(t)!==e&&(e?Object(n.a)().ViewStateConfiguration.ListViewBitFlags|=t:Object(n.a)().ViewStateConfiguration.ListViewBitFlags&=~t)}))},1012:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(23),o=r(4),a=function(){return{alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new n.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,traceIdToLogicalIdMap:new n.ObservableMap,tableViewId:null,isScopePickerVisible:!1}},i={scenarioStores:new n.ObservableMap},c=Object(o.createStore)("commonSearchStore",i);t.b=c},1021:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.Spaces=5]="Spaces",e[e.FileSuggestions=6]="FileSuggestions"}(n||(n={})),t.b=n},1031:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"IndexedPageView:#Exchange"},e)}},1042:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(988);function o(e,t){var r=Object(n.a)(t),o=r&&r.get(e);return null==o?void 0:o.rootFolder}},1077:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(n||(n={}))},1096:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("ON_SEARCH_TEXT_CHANGED",(function(e,t){return{searchText:e,scenarioId:t}}))},1114:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("START_SEARCH",(function(e,t,r,n,o,a){return void 0===r&&(r=!1),void 0===n&&(n=[]),void 0===a&&(a="All"),{actionSource:e,scenarioId:t,explicitSearch:r,connectedAccountInfo:n,searchProvider:o,filter:a}}))},1124:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",(function(e,t){return{isSuggestionsDropdownVisible:e,scenarioId:t}}))},1125:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return c})),r.d(t,"g",(function(){return u})),r.d(t,"m",(function(){return s})),r.d(t,"n",(function(){return l})),r.d(t,"o",(function(){return d})),r.d(t,"p",(function(){return f})),r.d(t,"q",(function(){return b})),r.d(t,"l",(function(){return h})),r.d(t,"f",(function(){return p})),r.d(t,"i",(function(){return m})),r.d(t,"h",(function(){return g})),r.d(t,"j",(function(){return v})),r.d(t,"k",(function(){return O}));var n="Click",o=356,a=928,i=String.fromCharCode(57345),c=new RegExp(i,"g"),u=String.fromCharCode(160),s=/\s/g,l=String.fromCharCode(57344),d=new RegExp(l,"g"),f="searchSuggestionsCallout",b="searchSuggestion-",h=38,p=52,m="searchBoxId",g="searchBoxAnchorId",v="searchScopeButtonId",O="searchScopeWrapperId"},1147:function(e,t,r){"use strict";var n="POST",o=r(0),a=r(255),i=r(1257),c=r(280),u=r(1286),s=r(1595),l=r(79);function d(e,t,r,n,c){return Object(o.__awaiter)(this,void 0,void 0,(function(){var u;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Object(i.d)(e,!1,r)];case 1:return u=o.sent(),[3,3];case 2:return o.sent(),[3,3];case 3:return u&&u.split(i.a)[1]?(Object(a.o)("fetchServiceViaDataProvider",[e]),l.g.info("fetchServiceViaDataProvider"),[4,f(t,u,n,c)]):[3,5];case 4:return[2,o.sent()];case 5:Object(a.o)("fetchServiceFailedToGetToken",[e]),o.label=6;case 6:return 0!==e?[3,8]:(Object(a.o)("fetchServiceViaOWAServer"),l.g.info("fetchServiceViaOWAServer"),[4,b(e,t,n,c)]);case 7:return[2,o.sent()];case 8:throw new Error("Fetch service has failed to retrieve client token.")}}))}))}function f(e,t,r,n){return Object(o.__awaiter)(this,void 0,void 0,(function(){var i,u,s;return Object(o.__generator)(this,(function(o){return i=r.datapointNamePrefix+"DataProvider",u=new a.a(i),s={Authorization:t,"Content-Type":"application/json",Accept:"application/json"},n&&Object.keys(n).forEach((function(e){s[e]=n[e]})),[2,fetch(e,{method:r.method,mode:r.mode,headers:s,body:r.body}).then((function(e){if(Object(c.a)(e.status))return u.end(),e.json();var t=new Error(i+" : Response status = "+e.status+", body = "+e.body);u.endWithError("ServerError",t);var r={datapointName:i,responseStatus:e.status,responseBody:e.body};throw JSON.stringify(r)})).then((function(e){return JSON.stringify(e)}))]}))}))}function b(e,t,r,i){return Object(o.__awaiter)(this,void 0,void 0,(function(){var l,d,f,b,h,p;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return l=r.datapointNamePrefix+"OWA",d=new a.a(l),f=Object(u.a)({ProviderType:e,Url:t,Method:r.method,Body:r.body?r.body:JSON.stringify({}),Headers:JSON.stringify(i),IsJsonPost:r.method===n}),[4,Object(s.a)(f)];case 1:if(b=o.sent(),Object(c.a)(b.Status))return d.end(),[2,b.Body];throw h=new Error(l+" : Response status = "+b.Status+", ServerTraceLog = "+b.ServerTraceLog),d.endWithError("ServerError",h),p={datapointName:l,responseStatus:b.Status,responseServerTraceLog:b.ServerTraceLog},JSON.stringify(p)}}))}))}function h(e){var t;try{t=btoa(e)}catch(r){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}r.d(t,"d",(function(){return n})),r.d(t,"a",(function(){return"cors"})),r.d(t,"b",(function(){return"GET"})),r.d(t,"e",(function(){return"PUT"})),r.d(t,"c",(function(){return"PATCH"})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return h}))},1162:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(4),o=r(123),a=Object(n.action)("GET_SUGGESTIONS",(function(e){return Object(o.c)({name:"Search_SuggestionsE2E"},{scenarioId:e})}))},1194:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1042),o=r(954);function a(e){return Object(n.a)(o.i,e)}},1195:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1042),o=r(954);function a(e){return Object(n.a)(o.d,e)}},1196:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1042);function o(e){return Object(n.a)(e)}},1206:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SEARCH_SESSION_STARTED",(function(e,t,r){return{actionSource:e,shouldStartSearch:t,scenarioId:r}}))},1216:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1021),o=r(979);function a(e){switch(e){case n.b.Mail:return o.a.Mail;case n.b.Calendar:return o.a.Calendar;case n.b.FilesHub:return o.a.FilesHub;case n.b.Spaces:case n.b.FileSuggestions:return o.a.Mail;default:throw Error("No corresponding SubstrateSearchScenario for given SearchScenarioId ("+e+").")}}},1235:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("END_SEARCH_CONVERSATION",(function(e){return{scenarioId:e}}))},12392:function(e){e.exports=JSON.parse('{"a":"Qga"}')},12393:function(e){e.exports=JSON.parse('{"a":"Rga"}')},12394:function(e){e.exports=JSON.parse('{"b":"Sga","a":"Tga"}')},12395:function(e){e.exports=JSON.parse('{"a":"aha"}')},12396:function(e){e.exports=JSON.parse('{"a":"eha"}')},1240:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SET_CURRENT_SUGGESTIONS",(function(e,t,r){return void 0===r&&(r=null),{suggestionSet:e,scenarioId:t,qfRequestId:r}}))},1257:function(e,t,r){"use strict";var n=r(0),o=r(1736),a=r.n(o),i=r(9),c=r(295),u=r(699),s=r(288),l=r(24);function d(e){return Object(n.__assign)({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}function f(e,t){return void 0===e||e.__type||(e=d(e)),Object(l.a)("GetAccessTokenforDataProvider",e,t)}function b(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,a,i,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return o=d({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1}),a=r?"getAccessTokenForDataProvider_"+r:"getAccessTokenForDataProvider",(i=new Headers).append("X-OWA-ActionName",a),[4,f(o,{headers:i,datapoint:{customData:{actionSource:r},headersCustomData:function(e){return{tokenResultDetails:e.get("x-tokenresult")}},jsonCustomData:function(e){return{tokenStatus:e.TokenResultCode.toString()}}},returnFullResponseOnSuccess:!0})];case 1:return[4,(c=n.sent()).json()];case 2:return[2,{token:n.sent(),response:c}]}}))}))}var h="onedrive_implicit.access",p="Bearer ",m=r(76),g=function(e,t,r){return Object(n.__assign)({resultCode:t,isAdalException:r,_typeSpec:"TokenRetrievalError"},e)},v=function(e){return"TokenRetrievalError"===e._typeSpec},O=[],_={},S=1,j=30,I="",x="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function w(e){_[e]=null}function y(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,b(e,t,r)];case 1:return o=n.sent(),function(e,t,r){O=O.filter((function(e){return e!==t}));var n=r.token;if(0!==n.TokenResultCode||!n.AccessToken||""===n.AccessToken){var o="Access token request failed for token key "+e+" with response code "+n.TokenResultCode,a=r.response.headers.get("x-tokenresult"),i=null!=a&&a.indexOf(x)>0;throw g(new Error(o),n.TokenResultCode,i)}var c=_[e]||{};c[t]=n,_[e]=c}(e,t,o),[2,o.token]}}))}))}function T(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,a;return Object(n.__generator)(this,(function(n){return o=I,0===e&&r&&(a=Object(s.parse)(r),o=Object(i.c)("{0}//{1}/",a.protocol,a.hostname)),Object(m.h)("doc-attachment-testAuthFallback")?[2,""]:[2,E(e,o,t,null)]}))}))}function k(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,E(0,e,t,r)]}))}))}function E(e,t,r,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r||!function(e,t){var r=_[e];if(!r)return!1;var n=r[t];if(!n||!n.AccessTokenExpiry)return!1;var o=new Date(n.AccessTokenExpiry),i=a()(new Date(Date.now()),S);return null!=o&&i<o}(e,t)?[3,1]:(i=_[e],c=i[t],a()(new Date(Date.now()),j)>new Date(c.AccessTokenExpiry)&&-1===O.indexOf(t)&&(O.push(t),y(e,t,o)),[2,c.AccessToken]);case 1:return[4,y(e,t,o)];case 2:return[2,(c=n.sent()).AccessToken]}}))}))}function P(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return Object(c.a)()&&1===e?[4,Object(u.getDelegationTokenForOwa)(h)]:[3,2];case 1:return o=n.sent(),[3,4];case 2:return[4,T(e,t,r)];case 3:o=n.sent(),n.label=4;case 4:return[2,p+o]}}))}))}r.d(t,"d",(function(){return P})),r.d(t,"c",(function(){return T})),r.d(t,"e",(function(){return k})),r.d(t,"b",(function(){return w})),r.d(t,"f",(function(){return v})),r.d(t,"a",(function(){return p}))},1286:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}},1292:function(e,t,r){"use strict";r.d(t,"p",(function(){return a})),r.d(t,"f",(function(){return i})),r.d(t,"j",(function(){return c})),r.d(t,"w",(function(){return u})),r.d(t,"l",(function(){return s})),r.d(t,"g",(function(){return l})),r.d(t,"o",(function(){return d})),r.d(t,"s",(function(){return f})),r.d(t,"i",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return p})),r.d(t,"h",(function(){return m})),r.d(t,"e",(function(){return g})),r.d(t,"d",(function(){return v})),r.d(t,"k",(function(){return O})),r.d(t,"m",(function(){return _})),r.d(t,"q",(function(){return S})),r.d(t,"r",(function(){return j})),r.d(t,"n",(function(){return I})),r.d(t,"v",(function(){return x})),r.d(t,"a",(function(){return w})),r.d(t,"t",(function(){return y})),r.d(t,"u",(function(){return T}));var n=r(108),o=(r(1072),new n.c((function(){return r.e(526).then(r.bind(null,2746))}))),a=new n.a(o,(function(e){return e.logSearchDone})),i=new n.a(o,(function(e){return e.logEntityClicked})),c=new n.a(o,(function(e){return e.logResponseReceived})),u=new n.a(o,(function(e){return e.logSessionEnd})),s=new n.a(o,(function(e){return e.logResponseRendered})),l=new n.a(o,(function(e){return e.logExecuteSearchCorrelation})),d=new n.a(o,(function(e){return e.logSearchBoxStateChanged})),f=new n.a(o,(function(e){return e.logSearchResultInteraction})),b=new n.a(o,(function(e){return e.logResponseNeverRendered})),h=new n.a(o,(function(e){return e.flushNonRenderedResponseReceivedItemsFromCache})),p=new n.a(o,(function(e){return e.logCachedContentRendered})),m=new n.a(o,(function(e){return e.logFeedback})),g=new n.a(o,(function(e){return e.logClientLayout})),v=new n.a(o,(function(e){return e.logClientDataSource})),O=new n.a(o,(function(e){return e.logResponseRecievedV2})),_=new n.a(o,(function(e){return e.logResultsRendered})),S=new n.a(o,(function(e){return e.logSearchEntityActions})),j=new n.a(o,(function(e){return e.logSearchFeedbackActions})),I=new n.a(o,(function(e){return e.logSearchActions})),x=new n.a(o,(function(e){return e.logSecondaryEntityActionClicked})),w=new n.a(o,(function(e){return e.clearProcessedTraceIds})),y=new n.a(o,(function(e){return e.logSearchSuggestionsClientLayoutEvent})),T=new n.a(o,(function(e){return e.logSearchSuggestionsResultsRenderedEvent}))},1344:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("CLEAR_SEARCH_BOX",(function(e){return{scenarioId:e}}))},1353:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(949);function o(e){var t=Object(n.a)(e);return 0===t.searchText.trim().length&&0===t.suggestionPillIds.length}},1354:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SUGGESTION_SELECTED",(function(e,t,r,n,o){return{suggestion:e,actionSource:t,scenarioId:r,suggestionSetTraceId:n,index:o}}))},1361:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("EXIT_SEARCH",(function(e,t,r){return void 0===r&&(r=!1),{actionSource:e,scenarioId:t,forceExit:r}}))},1362:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(26);function o(){return Object(n.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},1370:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("ADD_SUGGESTION_PILL",(function(e,t,r){return{suggestionPill:e,suggestionSelected:t,scenarioId:r}}))},1382:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(1021);function o(e){switch(e){case n.b.Mail:return"Mail";case n.b.Calendar:return"Calendar";case n.b.FilesHub:return"FilesHub";case n.b.FilesPicker:return"FilesPicker";case n.b.Spaces:return"Spaces";case n.b.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},14619:function(e,t,r){"use strict";r.r(t);var n=r(1392),o=r(4),a=Object(o.action)("ADD",(function(e){return{providerViewState:e}})),i=Object(o.action)("LOAD",(function(e){return{providers:e}})),c=Object(o.action)("REMOVE",(function(e){return{providerType:e}})),u=Object(o.action)("ADD_TO_REMOVING",(function(e){return{providerType:e}})),s=Object(o.action)("SET_LOAD_STATE",(function(e){return{loadState:e}}));function l(e){Object(n.a)().providers.set(e.viewType.toString(),e)}Object(o.mutator)(a,(function(e){return l(e.providerViewState)})),Object(o.mutator)(u,(function(e){Object(n.a)().removalPending.set(e.providerType.toString(),"")})),Object(o.mutator)(c,(function(e){Object(n.a)().providers.delete(e.providerType.toString()),Object(n.a)().removalPending.delete(e.providerType.toString())})),Object(o.mutator)(i,(function(e){return e.providers.forEach(l)})),Object(o.mutator)(s,(function(e){Object(n.a)().loadState=e.loadState}));var d=r(0),f=r(12392),b=r(2401),h=r(9),p=r(1841),m=r(2466),g=Object(o.action)("ADD_FILE_PROVIDER",(function(e,t,r){return{providerType:e,getAddableFileProviderInfoCustom:t,updateProvider:r}})),v=Object(o.action)("LOAD_PROVIDERS",(function(e,t){return{onLoaded:e,onError:t}})),O=Object(o.action)("REMOVE_AND_ADD_FILE_PROVIDER",(function(e){return{providerType:e}})),_=Object(o.action)("REMOVE_FILE_PROVIDER",(function(e){return{providerType:e}})),S=r(991),j=r(1549);function I(e){if(j.c.indexOf(e.Type)<-1)return null;var t=e.Type;try{var r=5===t?e.Scopes.filter((function(e){return"Photos"!==e.DisplayName})):e.Scopes;return{name:e.DisplayName,providerAccountIdentifier:e.AssociatedDataProviderAccountId||"",isPrimaryProvider:!e.IsThirdPartyProvider,type:t,allowFolderSharing:e.AllowFolderSharing,model:e,scopes:r||[],viewType:t,associatedWithPrimaryProvider:!1,usesGroupsViewAtTopLevel:!1}}catch(e){return null}}var x=r(1408),w=r(255),y=r(79),T=r(2362);function k(e,t,r){return Object(d.__awaiter)(this,void 0,void 0,(function(){var n,o;return Object(d.__generator)(this,(function(i){switch(i.label){case 0:if(!Object(m.b)(e))throw new Error(m.a);i.label=1;case 1:return i.trys.push([1,3,,4]),[4,E(e,t,r)];case 2:return n=i.sent(),[3,4];case 3:return function(e,t){throw y.g.warn("Error in adding file provider "+e.toString()),function(e){Object(S.b)(Object(h.b)(b.a),Object(h.c)(Object(h.b)(f.a),e),!1,{hideCancelButton:!0})}(Object(p.a)(t)),e}(i.sent(),e),[2];case 4:return o=I(n),a(o),Object(x.a)(o),[2]}}))}))}function E(e,t,r){return Object(w.o)("FPAddDataProviderAuthWindowOpened",[e]),new Promise((function(n,o){var a,i,c,u,s,l,d=(t=t||T.b)(e).getAuthUrlInfo(),f=d.authUrl,b={info:{redirectUrl:d.redirectUrl,csrfToken:d.csrfToken,updateProvider:r},onProviderAdded:function(e){return n(e)},onErrorAddingProvider:function(e){return o(e)},getAddableFileProviderInfo:t};Object(T.a)(e),Object(T.d)(e,b),a=f,i=600,c=600,u=(window.screen.width-i)/2,s=(window.screen.height-c)/2,l="width="+i+", height="+c+", top="+s+", left="+u+", menubar=no, toolbar=no",window.open(a,"_blank",l)}))}Object(o.orchestrator)(g,(function(e){k(e.providerType,e.getAddableFileProviderInfoCustom,e.updateProvider)}));var P=r(12393),C=r(12394),A=r(3739),D=r(1358);function N(e){return Object(d.__assign)({__type:"RemoveAttachmentDataProviderRequest:#Exchange"},e)}var B=r(24);function R(e){var t,r,n=N({DataProviderId:e});return void 0===(t=n)||t.__type||(t=N(t)),Object(B.a)("RemoveAttachmentDataProvider",t,r)}function F(e){return Object(d.__awaiter)(this,void 0,void 0,(function(){var t;return Object(d.__generator)(this,(function(r){switch(r.label){case 0:return(t=Object(D.a)(e.toString()))&&Object(m.b)(e)?[4,R(t.model.Id)]:(L("Unable to remove the provider as the provider does not exist in the store or is not addable.",e),Object(w.o)("FPRemoveFileProvider",{message:"Provider does not exist in the store or is not addable.",fileProviderType:e.toString()}),[2]);case 1:return r.sent().RemovedSuccessfuly?(c(e),Object(x.b)(e),Object(A.b)(t.type),Object(w.o)("FPRemoveFileProvider",{message:"Successfully removed file provider",fileProviderType:e.toString()})):(L("Unable to remove the provider",t.type),Object(w.o)("FPRemoveFileProvider",{message:"Unable to remove the provider",fileProviderType:e.toString()})),[2]}}))}))}function L(e,t){var r;y.g.warn("Error in removing file provider "+e),r=Object(p.a)(t),Object(S.b)(Object(h.b)(C.b),Object(h.c)(Object(h.b)(C.a),r),!1,{hideCancelButton:!0})}function M(e){return Object(S.b)(Object(h.b)(b.a),Object(h.c)(Object(h.b)(P.a),e),!1)}Object(o.orchestrator)(_,(function(e){F(e.providerType)})),Object(o.orchestrator)(O,(function(e){!function(e){Object(d.__awaiter)(this,void 0,void 0,(function(){var t;return Object(d.__generator)(this,(function(r){switch(r.label){case 0:t=Object(p.a)(e),r.label=1;case 1:return r.trys.push([1,6,,7]),[4,F(e)];case 2:return r.sent(),[4,M(t)];case 3:return r.sent()!==S.a.ok?[3,5]:[4,k(e)];case 4:r.sent(),r.label=5;case 5:return[3,7];case 6:return r.sent(),[3,7];case 7:return[2]}}))}))}(e.providerType)}));var q=r(12395),G=r(1811);function H(e){return Object(d.__assign)({__type:"GetAttachmentDataProvidersRequest:#Exchange"},e)}function U(e){void 0===e&&(e=0);var t,r,n=H({ClientVersion:2,RequestOrigin:e});return void 0===(t=n)||t.__type||(t=H(t)),Object(B.a)("GetAllAttachmentDataProviders",t,r)}var V=r(1643),z=r(12396),Q=r(76);var X=r(2402),Y=r(295);function J(e){if(!e||0==e.length)return null;var t=function(e){if(!e||0==e.length)return null;for(var t=[],r=0;r<e.length;r++)if(e[r].scopes.length>0){e[r].scopes[0].DisplayName=e[r].name;var n=Object(d.__assign)(Object(d.__assign)({},e[r].scopes[0]),{fileProviderViewState:e[r]});t.push(n)}return{__type:"OutlookAttachmentDataProvider",Id:"Outlook",DisplayName:j.d,AssociatedDataProviderAccountId:null,Scopes:t,DefaultScopeIndex:0,AllowFolderSharing:!1,IsThirdPartyProvider:!1}}(e);return{name:j.d,providerAccountIdentifier:t.AssociatedDataProviderAccountId||"",isPrimaryProvider:!0,type:null,allowFolderSharing:t.AllowFolderSharing,model:t,scopes:t.Scopes,viewType:j.b.Outlook,associatedWithPrimaryProvider:!1,usesGroupsViewAtTopLevel:!1}}Object(o.orchestrator)(v,(function(e){!function(e,t){Object(d.__awaiter)(this,void 0,void 0,(function(){var r,n,o,a,c,u,l,f;return Object(d.__generator)(this,(function(p){switch(p.label){case 0:if(Object(G.a)()!==V.a.NotLoaded)return[3,5];s(V.a.Loading),r=void 0,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,U()];case 2:return r=p.sent(),[3,4];case 3:return n=p.sent(),s(V.a.NotLoaded),null==t||t(n),[2];case 4:g={__type:"MailMessage",DisplayName:Object(h.b)(z.a),AriaLabel:Object(h.b)(z.a)},o={__type:"MailMessageAttachmentDataProvider",Id:"MailMessage",Type:10,DisplayName:Object(h.b)(b.b),AssociatedDataProviderAccountId:null,Scopes:[g],DefaultScopeIndex:0,AllowFolderSharing:!1,DefaultPermissionType:6,IsSearchSupported:Object(Q.h)("doc-filePicker-mailMessageSearch"),IsThirdPartyProvider:!1},r.push(o),a=r.filter((function(e){return j.c.indexOf(e.Type)>-1&&Object(X.a)(e.Type)})),(c=function(e){return e.map(I).filter((function(e){return null!==e}))}(a))&&!Object(Y.a)()&&c.splice(0,0,(m=c[0],Object(d.__assign)(Object(d.__assign)({},m),{scopes:[{__type:"OneDriveProScope:#Exchange",Type:3,DisplayName:""}],isPrimaryProvider:!1,viewType:j.b.Groups,name:Object(h.b)(q.a),associatedWithPrimaryProvider:!0,usesGroupsViewAtTopLevel:!0}))),Object(Q.h)("doc-filePicker-newNavigationHierarchy")&&c&&(u=[4,10],0!=(l=c.filter((function(e){return-1!=u.indexOf(e.type)}))).length&&(f=J(l))&&(c.push(f),c=c.filter((function(e){return-1==l.indexOf(e)})))),i(c),s(V.a.Loaded),null==e||e(c),Object(x.c)(c),p.label=5;case 5:return[2]}var m,g}))}))}(e.onLoaded,e.onError)})),r.d(t,"removeFileProvider",(function(){return _})),r.d(t,"removeAndAddFileProvider",(function(){return O})),r.d(t,"loadProviders",(function(){return v})),r.d(t,"addFileProvider",(function(){return g}))},1581:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",(function(e,t,r){return{indexToSelect:e,suggestionToSelect:t,scenarioId:r}}))},1582:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("END_SEARCH_SESSION",(function(e,t){return{scenarioId:e,actionSource:t}}))},1595:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(24),o=r(1286);function a(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(n.a)("FetchDataProviderResource",e,t)}},1605:function(e){e.exports=JSON.parse('{"a":"gja"}')},1615:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SET_SEARCH_TEXT",(function(e,t){return{searchText:e,scenarioId:t}}))},1617:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("DOWNLOAD_FILE_SUGGESTION",(function(e,t,r){return{attachmentId:e,attachmentType:t,scenarioId:r}}))},1618:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SEARCH_SESSION_ENDED",(function(e,t,r,n){return{searchSessionGuid:e,scenarioId:t,latestTraceId:r,actionSource:n}}))},1619:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SET_DISPLAYED_QF_REQUEST_TIME",(function(e,t){return{displayedQFRequestTime:e,scenarioId:t}}))},1620:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("SHARE_FILE_SUGGESTION",(function(e,t,r){return{attachmentId:e,attachmentType:t,scenarioId:r}}))},1621:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("onSearchScopeOptionSelected",(function(e,t){return{selectedSearchScope:e,searchScenarioType:t}}))},1622:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(949);function o(e){return Object(n.a)(e).searchBoxWidth}},1780:function(e,t,r){"use strict";var n=r(949),o=r(4);t.a=Object(o.mutatorAction)("setNextSearchQueryId",(function(e,t){Object(n.a)(t).nextSearchQueryId=e}))},2027:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(949);function o(e){return!!Object(n.a)(e).suggestionPills.size}},2028:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1605),o=r(9),a=r(1353);function i(e,t){var r=t||Object(o.b)(n.a),i=r;return Object(a.a)(e)||(i=""),{ariaLabel:r,placeholder:i}}},2029:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",(function(e){return{scenarioId:e}}))},2030:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("ON_KEY_DOWN_SEARCH_INPUT",(function(e,t){return{evtKeyCode:e,scenarioId:t}}))},2054:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n={};function o(e){return n[e]}function a(e,t){n[e]=t}},2055:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1125),o=r(1382);function a(e){return n.i+"-"+Object(o.a)(e)}},2084:function(e){e.exports=JSON.parse('{"b":"aja","a":"bja"}')},2085:function(e,t,r){var n=r(2086),o=r(116);"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)o.loadStyles(n[a][1],!1);n.locals&&(e.exports=n.locals)},2086:function(e,t,r){(t=e.exports=r(115)(!1)).push([e.i,'.DqR_QI9wxI9eR6VFTBDcQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 30px;flex:1 1 30px;position:relative}html[dir] .DqR_QI9wxI9eR6VFTBDcQ{padding-bottom:2px}._1Qs0_GHrFMawJzYAmLNL2x,._1Ni7eAfyUBqk15RoZliWfC{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;font-weight:400;width:100%}html[dir] ._1Qs0_GHrFMawJzYAmLNL2x,html[dir] ._1Ni7eAfyUBqk15RoZliWfC{background:transparent;border:0}._1Qs0_GHrFMawJzYAmLNL2x::-ms-clear,._1Ni7eAfyUBqk15RoZliWfC::-ms-clear{display:none}._1dMfnPdablqcwDvVlOI1Ai::-webkit-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai::-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-ms-input-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1dMfnPdablqcwDvVlOI1Ai:-moz-placeholder{color:"[theme:headerSearchPlaceholderText, default:#004578]"}._1LtnCG5oLbhQOwtufJyBi8::-webkit-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8::-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-ms-input-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1LtnCG5oLbhQOwtufJyBi8:-moz-placeholder{color:"[theme:neutralPrimary, default:#333333]"}._1Qs0_GHrFMawJzYAmLNL2x{color:"[theme:black, default:#000000]";z-index:1}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-webkit-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0::-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-ms-input-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1Qs0_GHrFMawJzYAmLNL2x._28FTnx_o_MRIbFoSOl9_0:-moz-placeholder{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}',""]),t.locals={searchBoxInputContainer:"DqR_QI9wxI9eR6VFTBDcQ",searchBoxInput:"_1Qs0_GHrFMawJzYAmLNL2x",searchBoxInputBase:"_1Ni7eAfyUBqk15RoZliWfC",inputPlaceholder:"_1dMfnPdablqcwDvVlOI1Ai",inSearchinputPlaceholder:"_1LtnCG5oLbhQOwtufJyBi8",isDisabled:"_28FTnx_o_MRIbFoSOl9_0"}},2087:function(e,t,r){var n=r(2088),o=r(116);"string"==typeof n&&(n=[[e.i,n]]);for(var a=0;a<n.length;a++)o.loadStyles(n[a][1],!1);n.locals&&(e.exports=n.locals)},2088:function(e,t,r){(t=e.exports=r(115)(!1)).push([e.i,'._33tO85F3n_fu7qMMmS4oN3{color:inherit;font:inherit;cursor:pointer;outline:inherit;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:32px;color:"[theme:neutralDark, default:#212121]"}html[dir] ._33tO85F3n_fu7qMMmS4oN3{background:none;border:none;padding-bottom:0;padding-top:0;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._33tO85F3n_fu7qMMmS4oN3{border-top-left-radius:0;border-bottom-left-radius:0}html[dir=rtl] ._33tO85F3n_fu7qMMmS4oN3{border-top-right-radius:0;border-bottom-right-radius:0}._33tO85F3n_fu7qMMmS4oN3:hover{color:"[theme:neutralDark, default:#212121]"}html[dir] ._33tO85F3n_fu7qMMmS4oN3:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}._2s2g07d_g4rYONa6EUffoe{font-size:16px;min-width:32px!important;width:32px!important;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2s2g07d_g4rYONa6EUffoe{padding:0;border-style:none;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2s2g07d_g4rYONa6EUffoe:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._2gHlig06CLXTog_sHdBjxU{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-sizing:border-box;box-sizing:border-box;height:16px;width:16px;color:"[theme:neutralDark, default:#212121]"}html[dir] ._2gHlig06CLXTog_sHdBjxU{border-radius:50%;padding:3px;background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir=ltr] ._2gHlig06CLXTog_sHdBjxU{margin-right:16px}html[dir=rtl] ._2gHlig06CLXTog_sHdBjxU{margin-left:16px}html[dir] ._2gHlig06CLXTog_sHdBjxU:hover{background-color:"[theme:neutralLight, default:#eaeaea]"}html[dir] ._2gHlig06CLXTog_sHdBjxU:active{background-color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._12DoG-LvHF0uq_P3mCl9l1{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;width:44px;color:"[theme:neutralDark, default:#212121]"}html[dir] ._12DoG-LvHF0uq_P3mCl9l1{background-color:transparent}._12DoG-LvHF0uq_P3mCl9l1:hover{color:"[theme:neutralDark, default:#212121]"}._3WHacxy3jm55FX7LXtoTbT,._3OXD24zi--NRNzhEiiUbDf,._1pJKwDVgnVvtTYbSPBYHUf{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"[theme:headerSearchBoxIcon, default:#004578]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-size:16px;height:100%;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px}._2ItmDfaS1i9SxH_w5mCuKy._3OXD24zi--NRNzhEiiUbDf,._2ItmDfaS1i9SxH_w5mCuKy._1pJKwDVgnVvtTYbSPBYHUf,._3WHacxy3jm55FX7LXtoTbT._2ItmDfaS1i9SxH_w5mCuKy{color:"[theme:neutralTertiaryAlt, default:#c8c8c8]"}._1pJKwDVgnVvtTYbSPBYHUf{color:"[theme:themeDarker, default:#004578]"}._3OXD24zi--NRNzhEiiUbDf{color:"[theme:neutralDark, default:#212121]"}._3w0I3IfXZt11NrlI4Rtops{display:-webkit-box;display:-ms-flexbox;display:flex;height:32px;-ms-flex-item-align:center;align-self:center}html[dir=ltr] ._3w0I3IfXZt11NrlI4Rtops{margin-right:16px}html[dir=rtl] ._3w0I3IfXZt11NrlI4Rtops{margin-left:16px}._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{height:48px;position:fixed;width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;z-index:3}html[dir] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{background:"[theme:headerBackgroundSearch, default:#005A9E]"}html[dir=ltr] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH,html[dir=rtl] ._3w0I3IfXZt11NrlI4Rtops._5qNpXCd-7jY8_77B7v2Nm._39PnMB35_a5dhoEn1ZSYaH{left:0;right:0}._1IASxdr5glbGM5ZXvqT4EN{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-item-align:center;align-self:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:32px;width:100%}html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border-radius:2px}@media screen and (-ms-high-contrast:active){html[dir] ._1IASxdr5glbGM5ZXvqT4EN{border:1px solid "[theme:neutralLight, default:#eaeaea]"}}._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;height:48px}html[dir] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){border:none;border-radius:0}html[dir=ltr] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){margin-right:0}html[dir=rtl] ._1IASxdr5glbGM5ZXvqT4EN._39PnMB35_a5dhoEn1ZSYaH:not(._5qNpXCd-7jY8_77B7v2Nm){margin-left:0}html[dir] ._13fYSkaJ0_Cv0uT7sPeR3w{border-radius:0}._1B1INwx9bCktow-2kkawjV{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir] ._1B1INwx9bCktow-2kkawjV._39PnMB35_a5dhoEn1ZSYaH{margin:0 8px}html[dir] ._5qNpXCd-7jY8_77B7v2Nm ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:white, default:#ffffff]"}._3pB3B8SOyfUABGIvVa4Yof{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}html[dir] ._3pB3B8SOyfUABGIvVa4Yof{background:"[theme:headerSearchBoxBackground, default:rgba(255,255,255,.7)]"}html[dir] ._3pB3B8SOyfUABGIvVa4Yof._2ItmDfaS1i9SxH_w5mCuKy{background:"[theme:neutralLight, default:#eaeaea]"}._5j-xjOS68WJ1zbIJWTFG7{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-ms-flex-pack:distribute;justify-content:space-around}html[dir=ltr] ._5j-xjOS68WJ1zbIJWTFG7{margin-right:12px}html[dir=rtl] ._5j-xjOS68WJ1zbIJWTFG7{margin-left:12px}',""]),t.locals={searchButton:"_33tO85F3n_fu7qMMmS4oN3",searchBoxButton:"_2s2g07d_g4rYONa6EUffoe",clearBoxButton:"_2gHlig06CLXTog_sHdBjxU",backButton:"_12DoG-LvHF0uq_P3mCl9l1",searchIcon:"_3WHacxy3jm55FX7LXtoTbT",searchIconFocused:"_3OXD24zi--NRNzhEiiUbDf",searchIconRest:"_1pJKwDVgnVvtTYbSPBYHUf",isDisabled:"_2ItmDfaS1i9SxH_w5mCuKy",searchBoxCommonContainer:"_3w0I3IfXZt11NrlI4Rtops",searchBoxContainerInSearch:"_5qNpXCd-7jY8_77B7v2Nm",isInCompactMode:"_39PnMB35_a5dhoEn1ZSYaH",searchBoxContainer:"_1IASxdr5glbGM5ZXvqT4EN",searchBoxContainerNoBorderRadius:"_13fYSkaJ0_Cv0uT7sPeR3w",searchBoxColumnContainer:"_1B1INwx9bCktow-2kkawjV",searchBox:"_3pB3B8SOyfUABGIvVa4Yof",searchQueryContainer:"_5j-xjOS68WJ1zbIJWTFG7"}},2363:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(4),o=Object(n.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(function(e,t){return{jsEndToEndTime:e,jsRenderingTime:t}}))},2404:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));var n="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function o(e){var t,r;t=e+" - start",n&&(null===(r=null===performance||void 0===performance?void 0:performance.mark)||void 0===r||r.call(performance,t))}function a(e){var t,r;if(n){try{null===(t=null===performance||void 0===performance?void 0:performance.measure)||void 0===t||t.call(performance,e,e+" - start")}catch(e){return}var o=performance&&performance.getEntriesByName(e);return null===(r=null===performance||void 0===performance?void 0:performance.clearMarks)||void 0===r||r.call(performance,e+" - start"),o&&o.length>0?o.slice(-1)[0]:void 0}}},2694:function(e,t,r){"use strict";r(2404);var n=r(2363),o=r(108),a=new o.c((function(){return Promise.all([r.e(9),r.e(18),r.e(25),r.e(22),r.e(525)]).then(r.bind(null,14946))})),i=new o.b(a,(function(e){return e.addSearchRequestInstrumentation})),c=new o.b(a,(function(e){return e.addResourceTimingEntry})),u=new o.b(a,(function(e){return e.searchDiagnostics})),s=function(){var e=u.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};r(255);r.d(t,"a",(function(){return n.a})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return c}))},280:function(e,t,r){"use strict";var n=r(560);r.d(t,"a",(function(){return n.a}))},287:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return s})),r.d(t,"f",(function(){return l}));var n=r(108),o=(r(481),new n.c((function(){return Promise.all([r.e(32),r.e(4),r.e(457)]).then(r.bind(null,899))}))),a=(new n.a(o,(function(e){return e.makeOwsPrimeRequest})).importAndExecute,new n.a(o,(function(e){return e.makePostRequest})).importAndExecute),i=new n.a(o,(function(e){return e.makePatchRequest})).importAndExecute,c=new n.a(o,(function(e){return e.makePutRequest})).importAndExecute,u=new n.a(o,(function(e){return e.makeGetRequest})).importAndExecute,s=new n.a(o,(function(e){return e.makeDeleteRequest})).importAndExecute,l=new n.a(o,(function(e){return e.sendOwsPrimeRequest})).importAndExecute},3388:function(e,t,r){"use strict";var n=r(949),o=r(4);t.a=Object(o.mutatorAction)("setCurrentSearchQueryId",(function(e,t){Object(n.a)(t).currentSearchQueryId=e}))},3739:function(e,t,r){"use strict";var n=r(0);function o(e){return Object(n.__assign)({__type:"AttachmentItemsPagingDetails:#Exchange"},e)}var a=r(1031),i=r(24);function c(e){return Object(n.__assign)({__type:"SearchAttachmentDataProviderItemsRequest:#Exchange"},e)}var u=r(79);function s(e,t,r,n){return e?r(e):(u.g.warn(t.statusText),404===t.status?n(4):401===t.status||403===t.status?n(2):n(1))}var l=Object.freeze({SortColumn:2,SortOrder:1}),d="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",f="GDriveDataProviderItem:#Exchange",b="FacebookDataProviderItem:#Exchange",h="FileAttachmentDataProviderItem:#Exchange",p="FolderAttachmentDataProviderItem:#Exchange",m="OneDriveProScope:#Exchange",g="OneDriveProItemSkipTokenPagingMetadata:#Client",v=r(1489);function O(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map((function(e){return t(e)}))}}function _(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}var S="application/vnd.google-apps.folder";function j(e){return{__type:f,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===S?1:0}}function I(e){return Object(n.__assign)(Object(n.__assign)({},O(e.files,j)),{NextPageToken:e.nextPageToken})}function x(e){return Object(n.__assign)(Object(n.__assign)({},_(e)),{NextPageToken:null})}function w(e,t){return void 0===t&&(t=!1),Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(v.m)(e,t)];case 1:return r=n.sent(),o=r.errorResponse,(a=r.result)?[2,s(a,null,I,x)]:[2,s(null,o,I,x)]}}))}))}var y=r(3388),T=r(1780);function k(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function E(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:k(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}var P=function(e){return O(e,E)};function C(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(v.n)(e,t)];case 1:return r=n.sent(),o=r.errorResponse,(a=r.result)?[2,s(a,null,P,_)]:[2,s(null,o,P,_)]}}))}))}var A=r(428),D=r(245),N=r(1008),B=r(2694),R=r(979),F=r(1292),L=200;function M(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o,a,i,c,l,d,f,b,h,p,m,g;return Object(n.__generator)(this,(function(v){switch(v.label){case 0:if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");return t=Object(N.q)(N.g.FilesPicker),Object(y.a)(t.nextSearchQueryId,N.g.FilesPicker),Object(T.a)(Object(A.a)(),N.g.FilesPicker),r=Object(D.a)(),o={Cvid:Object(A.a)(),Scenario:{Name:R.a.MailEmailAttachmentPicker},TimeZone:Object(R.w)(r),TextDecorations:"Off",EntityRequests:(O=e,{Field:"Time",SortDirection:"Desc"},S=[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:O},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}],S)},a=0,i=0,c=new Date,[4,Object(R.I)(o,t.searchSessionGuid)];case 1:return(l=v.sent())&&2==l.length?(d=l[0].status,b=(f=d==L)?null:l[0].statusText,h=function(e,t,r,n,o,a,i){if(!e||2!=e.length)return null;var c=Object(R.d)(e[0],t,r,"SubstrateSearch",n,new Date,o.currentSearchQueryId,new Headers(e[1]),0,R.a.MailEmailAttachmentPicker);return c.ClientJSPreRequestTime=a,c.ClientJSRequestThreadTime=i,Object(N.X)(c.SearchTraceID,N.g.FilesPicker,!1),B.d.import().then((function(e){return e(c)})),F.j.importAndExecute(c.SearchTraceID,c.ClientNetworkTime,c.ClientHttpStatus,new Date),c}(l,e,b,c,t,a,i),f?[4,l[0].json()]:[3,3]):(u.g.warn("3S Response for search mail messages failed"),[2,s(null,g={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},P,_)]);case 2:return p=v.sent(),m=function(e,t){var r,o;if(e&&e.Results&&0!==e.Results.length){var a=[],i=e.Results;try{for(var c=Object(n.__values)(i),u=c.next();!u.done;u=c.next()){var s=u.value,l=Object(R.h)(s.Source,t);l.InstanceKey=s.ReferenceId,a.push(l)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}return a}return[]}(Object(R.t)(p),o),F.l.importAndExecute(h.SearchTraceID,new Date,R.a.MailEmailAttachmentPicker),[2,s(m,null,P,_)];case 3:return u.g.warn("3S Response for search mail messages failed with "+b),g={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:b,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},F.i.importAndExecute(h.SearchTraceID,R.a.MailEmailAttachmentPicker),[2,s(null,g,P,_)]}var O,S}))}))}function q(e,t,r,u,s,f,b){if(void 0===f&&(f=null),5===e)return function(e,t){return void 0===t&&(t=""),Object(n.__awaiter)(this,void 0,void 0,(function(){var r;return Object(n.__generator)(this,(function(n){return r=d+"&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '"+e+"'",t&&(r=r+" and '"+t+"' in parents"),[2,w(r)]}))}))}(r,s);if(10===e)return M(r);var h,p,m,g=c({AttachmentDataProviderId:t,Query:r,Paging:o({Sort:b||(h=l,Object(n.__assign)({__type:"AttachmentItemsSort:#Exchange"},h)),FolderId:u,Location:s,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:f})});return void 0===(p={request:g}).request||p.request.__type||(p.request=c(p.request)),Object(i.a)("SearchAttachmentDataProviderItems",p,m)}var G=r(9),H=r(255),U=r(76),V=r(1257);function z(e){return null!==e&&e.__type===m}function Q(e,t){return 0===e&&t&&z(t)?t.Type:null}function X(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r="FPAccessTokenUnavailable",o=[e],n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Object(V.c)(e,!1,t)];case 2:return a=n.sent(),Object(G.f)(a)?(Object(H.o)(r,o),[2,!1]):[2,!0];case 3:return n.sent(),Object(H.o)(r,o),[2,!1];case 4:return[2]}}))}))}function Y(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:switch(e){case 3:case 2:case 6:return[3,1];case 5:case 10:return[3,4];case 0:return[3,5]}return[3,7];case 1:return(o=Object(U.h)("doc-filePicker-thirdPartyProviderClientCalls"))?[4,X(e,null)]:[3,3];case 2:o=n.sent(),n.label=3;case 3:return[2,o];case 4:return[2,!0];case 5:return 0!==Q(e,r)?[2,!1]:[4,X(e,t)];case 6:return[2,n.sent()];case 7:return[2,!1]}}))}))}function J(e){return e.__type===p||1===e.Type}function W(e){var t=e.filter(J),r=e.filter((function(e){return!J(e)}));return t.concat(r)}var Z=r(314);function K(e,t,r){var o,a,i=null,c=null;switch(e){case"asc":i=(o=Object(n.__read)([t,r],2))[0],c=o[1];break;case"desc":i=(a=Object(n.__read)([r,t],2))[0],c=a[1];break;default:Object(Z.a)(e)}return i<c?-1:i>c?1:0}function $(e,t,r){switch(t){case 2:e.sort((function(e,t){var n=e.Modified,o=t.Modified,a=n?new Date(n):new Date(0),i=o?new Date(o):new Date(0);return K(0===r?"asc":"desc",a,i)}));break;case 1:e.sort((function(e,t){var n=e.Size||0,o=t.Size||0;return 0===r?n-o:o-n}));break;default:e.sort((function(e,t){var n=e.Name.toLowerCase(),o=t.Name.toLowerCase();return K(0===r?"asc":"desc",n,o)}))}}function ee(e){return{__type:Object(v.r)(e)?p:h,Id:e.id,AttachmentProviderId:null,Location:(t=e.path_collection,"/"+(t.entries||[]).map((function(e){return e.name})).join("/")+"/"+e.name),Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(v.r)(e)?1:0};var t}var te=function(e){return O(e,ee)};function re(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,a,i,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(v.h)(e)];case 1:return o=n.sent(),a=o.errorResponse,(i=o.result)?($((c=s(i,null,te,_)).Items,t,r),c.Items=W(c.Items),[2,c]):[2,s(null,a,te,_)]}}))}))}function ne(e){return{__type:Object(v.u)(e)?p:h,Id:Object(v.s)(e)?null:e.id,AttachmentProviderId:null,Location:Object(v.s)(e)?"":e.path_lower,Modified:Object(v.t)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(v.t)(e)?e.size:0,Type:Object(v.u)(e)?1:0}}var oe=function(e){return O(e,ne)};function ae(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,a,i,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(v.j)({path:e})];case 1:return o=n.sent(),a=o.errorResponse,(i=o.result)?($((c=s(i,null,oe,_)).Items,t,r),c.Items=W(c.Items),[2,c]):[2,s(null,a,oe,_)]}}))}))}function ie(e){return Object(n.__assign)({__type:"AttachmentThumbnailInfo:#Exchange"},e)}var ce=150,ue=200;function se(e){var t,r=(t=e.images,Object(n.__read)(Object(n.__spread)(t).reverse().filter((function(e){return e.width>=ue&&e.height>=ce})),1)[0]||t[0]);return ie({Url:r.source,Height:r.height,Width:r.width})}function le(e){var t=se(e),r=e.images[0],n=ie({Url:r.source,Height:r.height,Width:r.width});return{__type:b,Id:e.id,Name:"Photo "+e.id+".jpg",AttachmentProviderId:null,ProviderType:6,Location:r.source,DownloadUrl:r.source+"&dl=1",Thumbnail:t,Preview:n,From:e.from?e.from.name:null,PlaceName:e.place?e.place.name:null,AlbumName:e.album?e.album.name:null,CreatedTime:e.created_time||null,PostUrl:e.link,Type:0}}var de=function(e){return O(e,le)};function fe(e){return e?function(e){switch(e){case 1:return v.c.Uploaded;case 0:return v.c.Tagged;default:return Object(Z.a)(e)}}(e.Type):v.c.Tagged}function be(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=fe(e),[4,Object(v.k)(t)];case 1:return r=n.sent(),o=r.errorResponse,(a=r.result)?[2,s(a,null,de,_)]:[2,s(null,o,de,_)]}}))}))}function he(e){return e.file?e.file.mimeType:e.package&&"oneNote"===e.package.type?"application/onenote":null}var pe=r(288);function me(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function ge(e,t,r,o,a,i){var c,u=void 0;if(a)switch(o){case 0:var s=i?i.totalItemsFetched+e.length:e.length;c={skipToken:a,totalItemsFetched:s},u=Object(n.__assign)(Object(n.__assign)({},c),{__type:"OneDriveProItemSkipTokenPagingMetadata:#Client"});break;case 1:throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(Z.a)(o)}var l=e.length;return a&&u?l=u.totalItemsFetched+1:u&&(l=u.totalItemsFetched),{TotalItemCount:l,ResultCode:0,Items:e.map((function(e){return function(e,t,r,o){var a,i,c,u=Object(n.__read)(e.folder?[p,null,e.folder.childCount,1,0]:[h,he(e),0,0,e.size],5),s=u[0],l=u[1],d=u[2],f=u[3],b=u[4];return{__type:s,Id:e.id,Name:e.name,Size:b,Thumbnail:{Url:(null===(i=null===(a=e.thumbnails)||void 0===a?void 0:a[0])||void 0===i?void 0:i.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(c=e.lastModifiedBy)||void 0===c?void 0:c.user)?e.lastModifiedBy.user.displayName:null,MimeType:l,Location:e.webDavUrl,ProviderEndpointUrl:t,ChildCount:d,AttachmentProviderId:r,ProviderType:o,Type:f}}(e,t,r,o)})),PagingMetadata:u}}function ve(e,t,r,n,o,a,i){return t?s(t,null,(function(e){return ge(e,r,n,o,a,i)}),me):s(null,e,(function(e){return ge(e,r,n,o,a,i)}),me)}function Oe(e,t,r,o,a,i){return void 0===i&&(i=null),Object(n.__awaiter)(this,void 0,void 0,(function(){var c,u,s,l,d,f,b,h;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return c=Object(pe.parse)(e),u=c.protocol+"//"+c.host,s=i?{maxEntries:i.maxEntries,skipToken:i.metadata?i.metadata.skipToken:null}:null,[4,Object(v.o)(u,0,r,o,a,void 0,s)];case 1:return l=n.sent(),d=l.errorResponse,f=l.result,b=f.items,h=f.skipToken,[2,ve(d,b,e,t,0,h,i?i.metadata:null)]}}))}))}var _e="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";function Se(e,t){var r="modifiedTime";t&&0===t.SortColumn?r="name":t&&1===t.SortColumn&&(r="quotaBytesUsed");var n=t&&0===t.SortOrder?"asc":"desc";return _e+"&orderBy=folder,"+r+" "+n+'&q=mimeType!="application/octet-stream" and trashed=false and "'+(e||"root")+'" in parents'}function je(e,t){var r;return void 0===e.request||e.request.__type||(e.request=(r=e.request,Object(n.__assign)({__type:"GetAttachmentDataProviderItemsRequest:#Exchange"},r))),Object(i.a)("GetAttachmentDataProviderItems",e,t)}var Ie,xe=(Ie={Type:0,DisplayName:"Files",AriaLabel:"Files"},Object(n.__assign)({__type:"OneDriveProScope:#Exchange"},Ie));function we(e,t,r,n,i,c,u,s,d){return je({request:{AttachmentDataProviderId:e,Paging:o({Sort:d||l,FolderId:n||"",Location:c||"",ItemsEndpointUrl:i||"",FilterBy:r,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100}),PagingMetadata:s}),Scope:null==u?xe:u}})}function ye(e,t,r,o,a,i,c,s,d,f,b){return void 0===a&&(a=null),void 0===i&&(i=null),void 0===d&&(d=null),void 0===b&&(b=null),Object(n.__awaiter)(this,void 0,void 0,(function(){var h,p,m,v,O,_;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,26,,27]),[4,Y(e,i,a)];case 1:return h=n.sent(),p=void 0,m=!1,h?5!==e?[3,3]:(m=!0,[4,w(Se(s,f))]):[3,20];case 2:return p=n.sent(),[3,20];case 3:if(2!==e)return[3,8];v=f?f.SortColumn:l.SortColumn,O=f?f.SortOrder:l.SortOrder,m=!0,n.label=4;case 4:return n.trys.push([4,6,,7]),[4,ae(s,v,O)];case 5:return p=n.sent(),[3,7];case 6:return n.sent(),[3,7];case 7:return[3,20];case 8:if(3!==e)return[3,13];v=f?f.SortColumn:l.SortColumn,O=f?f.SortOrder:l.SortOrder,m=!0,n.label=9;case 9:return n.trys.push([9,11,,12]),[4,re(c,v,O)];case 10:return p=n.sent(),[3,12];case 11:return n.sent(),[3,12];case 12:return[3,20];case 13:if(6!==e)return[3,18];m=!0,n.label=14;case 14:return n.trys.push([14,16,,17]),[4,be(a)];case 15:return p=n.sent(),[3,17];case 16:return n.sent(),[3,17];case 17:return[3,20];case 18:return 10!==e?[3,20]:(m=!0,[4,C(c,r)]);case 19:p=n.sent(),n.label=20;case 20:if(!h&&!Object(U.h)("doc-filePicker-getOneDriveItemsViaFetch")||0!==Q(e,a))return[3,24];if(d&&!function(e){return e&&e.__type===g}(d))throw new Error("The paging metadata is not of type OneDriveProItemsSkipTokenPagingMetadata");m=h,n.label=21;case 21:return n.trys.push([21,23,,24]),[4,Oe(i,t,f?f.SortColumn:l.SortColumn,f?f.SortOrder:l.SortOrder,c,{metadata:d,maxEntries:100})];case 22:return p=n.sent(),[3,24];case 23:return n.sent(),[3,24];case 24:return p&&0===p.ResultCode?(Object(H.o)("FPgetItemsClientCall",[!0,e]),[2,p]):(m&&Object(H.o)("FPgetItemsClientCall",[!1,e]),[4,we(t,r,o,c,b,s,a,d,f)]);case 25:return[2,n.sent()];case 26:throw _=n.sent(),u.g.warn("FilePicker: getFileProviderItems got error: "+_.message),_;case 27:return[2]}}))}))}r.d(t,"g",(function(){return q})),r.d(t,"c",(function(){return ye})),r.d(t,"a",(function(){return Y})),r.d(t,"b",(function(){return V.b})),r.d(t,"f",(function(){return V.f})),r.d(t,"e",(function(){return z})),r.d(t,"d",(function(){return he}))},431:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"FolderId:#Exchange"},e)}},481:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o}));var n="owsserver",o="owsapi"},484:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"ItemResponseShape:#Exchange"},e)}},560:function(e,t,r){"use strict";function n(e){return e>=200&&e<300}r.d(t,"a",(function(){return n}))},567:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(23),o=r(1);function a(e){return{get:e}}function i(e,t){return Object(o.useMemo)((function(){return Object(n.computed)(e)}),t).get()}},598:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"FindItemJsonRequest:#Exchange"},e)}},626:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(24),o=r(598);function a(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(n.a)("FindItem",e,t)}},627:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"FindItemRequest:#Exchange"},e)}},949:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(1382),o=r(1012);function a(e){return Object(o.b)().scenarioStores.get(Object(n.a)(e))||Object(o.a)()}},950:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(48);function o(e){if(!e)throw new Error("Input parameter to folderNameToId must not be null.");return n.a.defaultFolderNameToIdMap.get(e)}},954:function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"i",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"f",(function(){return i})),r.d(t,"b",(function(){return c})),r.d(t,"g",(function(){return u})),r.d(t,"k",(function(){return s})),r.d(t,"j",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"c",(function(){return f})),r.d(t,"e",(function(){return b}));var n="archivemsgfolderroot",o="msgfolderroot",a="archivedeleteditems",i="deleteditems",c="archiverecoverableitemsdeletions",u="recoverableitemsdeletions",s="msgfolderroot",l="sharedFolderTree",d="primaryFolderTree",f="archiveFolderTree",b="favorites"},964:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(0);function o(e){return Object(n.__assign)({__type:"PropertyUri:#Exchange"},e)}},973:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(48);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return n.a.defaultFolderIdToNameMap.get(e)||"none"}},974:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"c",(function(){return h})),r.d(t,"g",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"d",(function(){return g})),r.d(t,"f",(function(){return v})),r.d(t,"e",(function(){return O}));var n=r(26),o=r(950),a=r(973),i=r(975),c=r(1194),u=r(986),s=r(1195),l=r(76),d=r(1196),f=r(295),b=["journal","outbox","syncissues"];function h(){var e=Object(f.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(l.h)("notes-folder-view")&&e.push("notes"),e}function p(e){if(!function(e){return e&&"Folder:#Exchange"==e.__type}(e))return!1;if(e.isHidden||b.indexOf(Object(a.a)(e.FolderId.Id))>=0)return!1;var t=Object(n.a)();return"notes"==Object(a.a)(e.FolderId.Id)?t.SegmentationSettings.StickyNotes&&Object(l.h)("cal-stickyNotesFolder"):!("junkemail"==Object(a.a)(e.FolderId.Id)&&!t.SegmentationSettings.JunkEMail)}function m(e){var t=Object(u.a)(),r=Object(o.a)(e);return t.get(r)}function g(e,t){if("sharedFolder"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");var r,n=[];switch(e){case"archive":r=Object(s.a)();break;case"sharedFolder":r=Object(d.a)(t);break;default:r=Object(c.a)()}var o=h();"primary"==e&&r.DistinguishedFolderId==Object(c.a)().DistinguishedFolderId&&o.forEach((function(e){var t=m(e);t&&p(t)&&t.ParentFolderId.Id===r.FolderId.Id&&n.push(t.FolderId.Id)}));for(var u=function(e){var t=[];(null==e?void 0:e.childFolderIds)&&e.childFolderIds.map((function(e){var r=i.b.folderTable.get(e);r&&p(r)&&t.push(r.FolderId.Id)}));return t}(r),l=0;l<u.length;l++)-1==o.indexOf(Object(a.a)(u[l]))&&n.push(u[l]);return n}function v(e,t){var r=Object(u.a)().get(e);return!(!r||r.treeType!==t)}function O(e,t){var r=null,n=t.folderTable.get(e);return n&&(r=n.treeType),r}},975:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(4),o=r(23),a=Object(n.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),i=a();t.a=a},986:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(975);function o(){return Object(n.a)().folderTable}},988:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(975),o=r(103);function a(e){return i(e).folderTreeTable}function i(e){return e||(e=Object(o.c)()),Object(n.a)().mailboxFolderTreeData.get(e)}},990:function(e,t,r){"use strict";var n={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},o=0;function a(e){return void 0===e&&(e="id"),""+e+o++}function i(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;for(var t={},r=Object.keys(e),n=0;n<r.length;n++){switch(r[n]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=i(e.controls);break;case"describedBy":t["aria-describedby"]=i(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=i(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=i(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=i(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=i(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=i(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return c}))},991:function(e,t,r){"use strict";r.d(t,"b",(function(){return c}));var n=r(108),o=r(1077);r.d(t,"a",(function(){return o.a}));var a=new n.c((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(211)]).then(r.bind(null,1812))})),i=new n.b(a,(function(e){return e.confirmAction}));function c(e,t,r,n){return i.import().then((function(o){return o(e,t,r,n)}))}}}]);
//# sourceMappingURL=owa.FileProviderStore.js.map
self.scriptsLoaded['owa.FileProviderStore.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FileProviderStore.js'] = (new Date()).getTime();