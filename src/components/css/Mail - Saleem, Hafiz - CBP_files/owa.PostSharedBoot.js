self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.PostSharedBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[475],{2020:function(e,t,n){"use strict";var r=n(108),a=n(0),o=n(4),c=function(e,t,n){var r=null;return{init:function(c){var i;if(null!==r)throw new Error("Diagnostics store "+e+" was initialized multiple times");return r=Object(o.createStore)(e,t),n(r()),Object(a.__assign)(Object(a.__assign)({},c),((i={})[e]=r,i))},getIfInitialized:function(){return r?r():null}}};n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return c}));var i=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(232)]).then(n.bind(null,14609))})),s=Object(r.d)(i,(function(e){return e.DiagnosticsPanel})),u=new r.a(i,(function(e){return e.registerDiagnostics})),l=(new r.b(i,(function(e){return e.setSelectedPivot})),new r.b(i,(function(e){return e.getDiagnosticsLogState}))),d=new r.b(i,(function(e){return e.initializeDefaultDiagnostics})),f=Object(r.d)(i,(function(e){return e.DiagnosticsHost})),h=Object(r.d)(i,(function(e){return e.DiagnosticsInspector})),p=Object(r.d)(i,(function(e){return e.TwoColumnInspector}))},3445:function(e,t,n){"use strict";n.r(t);var r=n(76),a=n(0),o=n(2);function c(){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:e=Object(o.t)()+"scripts/ThirdPartyNotices.txt",r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(e,{credentials:"same-origin"})];case 2:return[4,r.sent().text()];case 3:return t=r.sent(),n=document.createComment("\nTHIRD-PARTY SOFTWARE NOTICES\nThis file is based on or incorporates material from the projects listed below (Third Party Code). The original copyright notice and the license under which Microsoft received such Third Party Code, are set forth below. Such licenses and notices are provided for informational purposes only. Microsoft licenses the Third Party Code to you under the licensing terms for the Microsoft product. Microsoft reserves all other rights not expressly granted under this agreement, whether by implication, estoppel or otherwise.\n\nYou may find a copy of the Corresponding Source code, if and as required under the Third Party Code License, either bundled with the Microsoft product or at http://3rdpartysource.microsoft.com. If not bundled with the product, you may also obtain a copy of the source code for a period of one year after our last shipment of this product.\n\n=============\n\n"+t),document.head.appendChild(n),[3,5];case 4:return r.sent(),[3,5];case 5:return[2]}}))}))}var i=n(108),s=new i.c((function(){return Promise.all([n.e(686),n.e(230)]).then(n.bind(null,14864))})),u=new i.a(s,(function(e){return e.setupDevTools})),l=n(57),d=n(3),f=n(556),h=["bO","bR","sessionId"];var p=n(2020),b=n(1777),v=n(255),m=n(482);var O=n(120),g=n(8176),C={concurrency:3,delay:1,pulse:1},j="ttiConcurrency",w="ttiDelay",k="ttiPulse",y="ttiMonkey",I=45e3,T=6e4,R=-1,E=null,S=null,U=null,N=0,P=!1,M=R,_=R;function D(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,n,o,c,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:t=0,a.label=1;case 1:return t<e.length?(n=e[t],o="function"==typeof n?n:n.task,c="function"==typeof n||!("condition"in n)||n.condition,i="function"!=typeof n&&n.idle,c?Object(r.h)("fwk-tti-governor")?[3,2]:(o(),[3,4]):[3,4]):[3,5];case 2:return N++,[4,x(i)];case 3:a.sent().add(o),a.label=4;case 4:return++t,[3,1];case 5:return[2]}}))}))}function W(){P=!0,Object(r.h)("fwk-tti-governor-monkey")&&(_=F(y,Math.floor(Math.random()*N)))}function x(e){return e?(S||(S=A(Promise.race([g.a.importAndExecute(),Object(O.a)(I)]))),S):(E||(E=A()),E)}function A(e){var t=function(){U||(U={concurrency:F(j,C.concurrency),pulse:F(k,C.pulse),delay:F(w,C.delay)});return U}();return(e||Object(O.a)(t.delay)).then((function(){return e=t.concurrency,n=L,r=t.pulse,new m.a(e,n,r);var e,n,r}))}function F(e,t){var n=t;return Object(r.h)("fwk-devTools")&&(n=parseInt(Object(d.a)(e))||t),n}function L(e){return++M==_?setTimeout(e,T):e(),P&&M==N-1&&(Object(v.o)("ttiGovernEnd",Object(a.__assign)(Object(a.__assign)({},U),{monkey:_})),P=!1),Promise.resolve()}function V(e,t){return["branch","ring","version"].some((function(n){return!!Object(d.d)(n,e.location)&&(t.push(n+"="+Object(d.a)(n,e.location)),!0)})),t.join("&")}var H,z=n(79);!function(e){e[e.Normal=0]="Normal",e[e.CacheCorrupt=1]="CacheCorrupt",e[e.TooManyInstallError=2]="TooManyInstallError"}(H||(H={}));var B,q=H;!function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall"}(B||(B={}));var G,Y=B;!function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error"}(G||(G={}));var $,J=G;!function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded"}($||($={}));var K,Q,X=$,Z=((K={})[X.Error]="ER",K[X.Cached]="C",K[X.NoUpdate]="NU",K[X.Obsolete]="OB",K[X.UpdateReady]="UR",K);!function(e){e[e.CacheInstalled=0]="CacheInstalled",e[e.CacheFailed=1]="CacheFailed",e[e.CacheCleared=2]="CacheCleared"}(Q||(Q={}));var ee=Q,te=n(8);function ne(e,t){return e+"_"+t}var re="SWCacheErrorCount";function ae(e,t,n){var r=ne(t.appName,re);0==n?Object(te.c)(e,r):Object(te.d)(e,r,""+n)}function oe(e,t){var n=parseInt(Object(te.a)(e,ne(t.appName,re)));return isNaN(n)?0:n}var ce="CacheVersion",ie="AttemptedCacheVersion";function se(e,t,n){if(n.cacheMessage&&(n.targetClient==t.appName||"global"==n.targetClient)){var r=n.cacheMessage;z.g.info("[SW Client] Cache Event: "+r.cacheEvent);var a=null;switch(r.cacheEvent){case X.Progress:t.resourcesCached++;break;case X.Error:a=ee.CacheFailed;break;case X.Cached:case X.NoUpdate:case X.UpdateReady:a=ee.CacheInstalled;break;case X.Obsolete:a=ee.CacheCleared;break;case X.CleanupError:t.cacheCleanupStatus=1;break;case X.CleanupSuceeded:t.cacheCleanupStatus=2,t.numberOfCachesCleaned=r.cachesCleaned?r.cachesCleaned.length:0}var o=r.cacheEvent==X.Obsolete;null!=a&&(function(e,t,n,r){switch(n){case ee.CacheInstalled:Object(te.d)(e,ne(t.appName,ce),r),ae(e,t,0);break;case ee.CacheFailed:Object(te.d)(e,ne(t.appName,ie),r),ae(e,t,oe(e,t)+1);break;case ee.CacheCleared:Object(te.d)(e,ne(t.appName,ce),null),Object(te.d)(e,ne(t.appName,ie),null),ae(e,t,0)}}(e,t,a,o?null:r.cacheVersion),function(e,t){Object(v.o)("SWCache",{ev:Z[t.cacheEvent],cv:t.cacheVersion,e:t.error,r:t.resource,st:t.status,stk:t.stack,rc:e.resourcesCached,ccs:e.cacheCleanupStatus,ncc:e.numberOfCachesCleaned,ch:e.cacheHealth,app:e.appName}),e.resourcesCached=0,e.cacheCleanupStatus=0,e.numberOfCachesCleaned=0}(t,r)),o&&t.cacheHealth>q.Normal&&(t.cacheHealth=q.Normal,pe())}}var ue=n(67),le=n(440),de=15,fe=null,he=null;function pe(){var e=Object(le.a)("/"+Object(ue.a)())+"/",t=""+e+fe.appName+"cache.manifest?"+V(window,["manifestVersion=2"]),n=Y.Install;fe.cacheHealth>q.Normal&&(n=Y.UnInstall);var a={source:fe.appName,action:n,bootResourcesOnly:!0,language:fe.userLanguage,darkMode:void 0!==fe.darkMode&&fe.darkMode,manifestUrl:t,proxyFetchAlways:Object(r.h)("fwk-sw-proxyFetchAlways"),rootUrl:e};fe.serviceWorkerRegistration.active.postMessage(a)}function be(e){if(e.data){var t=e.data;t.messageType==J.CacheProgress?se(he,fe,t):t.messageType==J.Error&&function(e){null!=e.error&&z.d("[SW Client] ServiceWorker Unhandled Exception",e.error)}(t)}}var ve=n(49),me=n(26),Oe="activated",ge=null,Ce=null,je=null,we=null;function ke(e,t,n){Ce=(je=e).navigator.serviceWorker,we=t;var a,o,c,i="/mail/sw.js",s=[];Object(r.h)("fwk-sw-proxyFetchAlways")&&(a=Object(ve.a)(),o=a.browser,c=a.browserVersion,("Chrome"==o||"Edge Anaheim"==o)&&c&&c.length>0)&&s.push("fa=1");var u=V(e,s);return u&&(i+="?"+u),n.addCustomData({url:i}),Ce.register(i,{scope:"/"}).then((function(){return Ce.ready.then(ye)}))}function ye(e){return z.g.info("[SW Client] ready fired, state: "+e.active.state),(ge=e).active?Ie():new Promise((function(e){Ce.oncontrollerchange=function(){Ie(),e()}}))}function Ie(){return ge.active.state==Oe?Te():new Promise((function(e){ge.active.onstatechange=function(){ge.active.state==Oe&&(ge.active.onstatechange=null,Te(),e())}}))}function Te(){var e,t,n=Object(me.a)();return e={serviceWorkerContainer:Ce,serviceWorkerRegistration:ge,appName:we,userLanguage:n.SessionSettings.UserLanguage,darkMode:n.UserOptions.IsDarkModeTheme},t=je,fe||((fe=e).serviceWorkerContainer.onmessage=be,oe(window,fe)>de&&(fe.cacheHealth=q.TooManyInstallError)),he=t,pe(),Promise.resolve()}function Re(e,t){var n;return Object(a.__awaiter)(this,void 0,void 0,(function(){var o,c,i,s,u;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:if(o=new v.a("RegisterServiceWorker"),!(c=null===(n=e.navigator)||void 0===n?void 0:n.serviceWorker))return[3,7];if(i=function(){var e,t=Object(ve.a)().browser;Object(r.h)("fwk-prefetch-code-off")?e="Error_PrefetchDisabled":"Chrome"==t||"Edge Anaheim"==t?Object(r.h)("fwk-prefetch-code-off-chromium")&&!Object(ve.m)([77])&&(e="Error_ChromeMinVersion"):"Edge"==t?Object(r.h)("auth-ServiceWorkerEdge")?Object(ve.m)([17,17134])||(e="EdgeMinVersion"):e="EdgeFlightOff":"Safari"==t?Object(r.h)("auth-ServiceWorkerSafari")?Object(ve.m)([11,1])||(e="SafariMinVersion"):e="SafariFlightOff":"Firefox"!=t&&(e="UnsupportedBrowser:"+t);return e}())return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,ke(e,t,o)];case 2:return a.sent(),[3,4];case 3:return u=a.sent(),s=u,[3,4];case 4:return[3,6];case 5:c.getRegistrations&&c.getRegistrations().then((function(e){for(var t=0;t<e.length;++t)e[t].unregister()})),a.label=6;case 6:return[3,8];case 7:i="SWNotAvailable",a.label=8;case 8:return o.addCustomData([i||"success"]),s?o.endWithError("ClientError",s):i?o.endWithError("ServerError"):o.end(),[2]}}))}))}function Ee(e,t,n){D({condition:!!((null===window||void 0===window?void 0:window.location)&&window.history),task:function(){return function(e,t){for(var n=Object(d.b)(e),r=!1,a=0;a<h.length;a++){var o=h[a];n[o]&&(delete n[o],r=!0)}if(r){var c=Object(l.stringify)(n);c&&(c="?"+c);var i=""+Object(f.m)()+e.pathname+c+e.hash;t.replaceState(null,null,i)}}(window.location,window.history)}},b.a,(function(){return v.i.importAndExecute(e)}),{condition:Object(r.h)("fwk-devTools"),task:function(){u.importAndExecute(),p.h.import().then((function(e){e()}))}},{task:function(){return Re(window,t)},idle:!0,condition:t&&(!n||Object(r.h)(n))},{idle:!0,task:c})}n.d(t,"setupSharedPostBoot",(function(){return Ee})),n.d(t,"govern",(function(){return D})),n.d(t,"enableGovernReport",(function(){return W}))},418:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(21),a=n(18),o=n(98);function c(e){var t=Object(r.a)(),n=Object(o.a)()+Object(a.a)("/owa")+"/",c=t.search&&t.search.length>0;n+=c?t.search:"?";for(var i=Object.keys(e),s=c,u=0;u<i.length;u++)s?n+="&":s=!0,n+=i[u]+"="+e[i[u]];return n}},440:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(62);function a(e){return Object(r.a)(e,[r.c])}},482:function(e,t,n){"use strict";var r=function(){function e(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return e.prototype.add=function(e){this.taskList.unshift(e),this.scheduleTask()},e.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},e.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},e.prototype.scheduleTask=function(){var e=this;this.canRunMoreTasks()&&setTimeout((function(){e.tryRunTask()}),this.taskDelay)},e.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},e.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},e.prototype.runTask=function(){var e=this,t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then((function(){e.onTaskComplete()})).catch((function(){e.onTaskComplete()})),this.scheduleTask()},e}();n.d(t,"a",(function(){return r}))},556:function(e,t,n){"use strict";var r=n(440),a=(n(582),n(18)),o=n(62);function c(e){return Object(o.a)(e,[o.b])}var i=n(25),s=n(67);function u(e){return Object(i.b)(Object(i.c)(Object(i.a)(Object(s.a)()||"",e)))}var l,d,f,h=n(418);function p(e,t){var n=-1!==e.indexOf("?");return(e+=n?"&":"?")+Object.keys(t).map((function(e,n){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&")}function b(){return l||(l=Object(a.a)("/calendar")+"/"),l}function v(){return d||(d=Object(a.a)("/mail")+"/"),d}function m(){return f||(f=Object(a.a)("/files")+"/"),f}var O,g,C,j=n(596);function w(e){return O&&g===e||(g=e,O=e?Object(a.a)("/people/group/owner")+"/":Object(a.a)("/people/group/member")+"/"),O}function k(){return C||(C=Object(a.a)("/people/group/deleted")+"/"),C}var y=n(26);function I(){var e=Object(y.a)().UserOptions;return(null==e?void 0:e.ReactOptinSettings)&&e.ReactOptinSettings.CalendarEnabled||!1}function T(e){if(I())return b()+"deeplink/compose/"+encodeURIComponent(e);var t={viewmodel:"IComposeCalendarItemViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(h.a)(t)}function R(e){return window.location.origin+b()+"showPeek/item/"+encodeURIComponent(e)}function E(e){if(I())return b()+"item/"+encodeURIComponent(e);var t={viewmodel:"ICalendarItemDetailsViewModelFactory",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(h.a)(t)}var S=n(0),U=n(288),N=n(577),P=n(21),M=n(57),_=Object(N.a)().split("/").slice(1).join("/")+"deeplink/",D=["hostApp","isanonymous","cspoff","frameName","opxInstanceId"];function W(e,t,n,r){var a=Object(P.a)().search;if(n&&((r=r||{}).minus=""),r){var o=Object(M.parse)((a||"").substr(1));Object.keys(o).forEach((function(e){D.includes(e)&&delete o[e]})),Object.keys(r).forEach((function(e){return o[e]=r[e]})),a="?"+function(e){return Object.entries(e).map((function(e){var t=Object(S.__read)(e,2),n=t[0],r=t[1];return r?encodeURIComponent(n)+"="+encodeURIComponent(r):encodeURIComponent(n)})).join("&")}(o)}var c={pathname:"/"+e+"/"+_+t,search:a};return U.format(c)}var x,A=n(146),F="https://to-do.microsoft.com";function L(){var e,t,n=Object(y.a)(),r=n.UserOptions,a=null===(e=n.SessionSettings)||void 0===e?void 0:e.UserPrincipalName,o=F;return(null===(t=null==r?void 0:r.ReactOptinSettings)||void 0===t?void 0:t.TasksRedirectUrl)&&(o=r.ReactOptinSettings.TasksRedirectUrl,a&&(o=p(r.ReactOptinSettings.TasksRedirectUrl,{auth_upn:a}))),o}function V(){return x||(x=Object(a.a)("/spaces")+"/"),x}var H=n(98);n.d(t,"j",(function(){return r.a})),n.d(t,"s",(function(){return a.a})),n.d(t,"f",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"w",(function(){return i.a})),n.d(t,"a",(function(){return i.b})),n.d(t,"o",(function(){return h.a})),n.d(t,"u",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"g",(function(){return m})),n.d(t,"p",(function(){return j.a})),n.d(t,"i",(function(){return w})),n.d(t,"h",(function(){return k})),n.d(t,"b",(function(){return T})),n.d(t,"c",(function(){return R})),n.d(t,"d",(function(){return E})),n.d(t,"q",(function(){return W})),n.d(t,"v",(function(){return A.a})),n.d(t,"t",(function(){return L})),n.d(t,"n",(function(){return V})),n.d(t,"m",(function(){return H.a})),n.d(t,"r",(function(){return s.a}))},582:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(21),a=n(67);function o(){var e,t=null===(e=Object(r.a)())||void 0===e?void 0:e.pathname;if(t){var n=t.split("/"+Object(a.a)()+"/")[1];if(n){var o=n.split("/")[0];if(o&&!isNaN(parseInt(o)))return!0}}return!1}},596:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,a=n(18);function o(){return r||(r=Object(a.a)("/people")+"/"),r}},8176:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(108),a=new r.c((function(){return n.e(590).then(n.bind(null,9936))})),o=new r.a(a,(function(e){return e.tti}))}}]);
//# sourceMappingURL=owa.PostSharedBoot.js.map
self.scriptsLoaded['owa.PostSharedBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.PostSharedBoot.js'] = (new Date()).getTime();